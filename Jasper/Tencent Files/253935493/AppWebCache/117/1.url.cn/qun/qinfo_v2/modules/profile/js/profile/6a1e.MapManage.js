(function(){(function(d,c){typeof define==="function"&&define.amd?define("mapManage",["simple","catCtrl"],c):d.MapManage=c(d.Simple,d.CatCtrl)})(this,function(d,c){function e(){var a=c.getCatNamePath(l()).join("");return a.indexOf("\u540c\u4e8b\u670b\u53cb")>-1?a:a.split("-")[0]}function i(a,b){return a?b?c.getItemIdByPathStr(10013,a+"-"+b):c.getItemIdByPathStr(10013,a):0}var j={},k,f,g={},l=function(){},n=function(a){return a},o={"\u540c\u4e8b\u670b\u53cb-\u540c\u4e8b":"ly","\u540c\u4e8b\u670b\u53cb-\u4eb2\u53cb":"ly",
"\u884c\u4e1a\u4ea4\u6d41":"ly","\u5b66\u4e60\u8003\u8bd5":"ly","\u7f6e\u4e1a\u5b89\u5bb6":"ly","\u7c89\u4e1d":"ly","\u6e38\u620f":"ly","\u540c\u4e8b\u670b\u53cb-\u540c\u5b66":"ggfw","\u5174\u8da3\u7231\u597d":"sh","\u751f\u6d3b\u4f11\u95f2":"sh","\u54c1\u724c\u4ea7\u54c1":"sh"};return window.MapManage=j={init:function(a){a=a||{};if("getCatFn"in a&&typeof a.getCatFn==="function")l=a.getCatFn;if("encodeFn"in a&&typeof a.encodeFn==="function")n=a.encodeFn},convertToId:i,convertToName:function(a){return c.getCatNamePath(a).slice(2).join("-")},
loadMap:function(a,b,i){var h,m,j;h=c.getCatNamePath(l()).join("-");for(m in o)h.indexOf(m)===0&&(j=o[m]);b={edit:b,category:j||""};if(h=g[e()])b.lng=h.lng,b.lat=h.lat,b.name=h.name||a||"";i?(f=i,f.style.display="block"):(k?k.style.display="block":(k=d.dom.getNode("div",{"class":"map-container"}),document.body.appendChild(k)),f=k);f.innerHTML='<iframe src="/qinfo_v2/modules/profile/map.html#'+n(b)+'" width="100%" scrolling="no" height="100%" frameborder="no" border="0"></iframe>';return f},close:function(a){a&&
a.name&&(g[e()]=a,d.oop.notifyObservers(j,"setMap",a));f.style.display="none";window.postMessage('{"from":"MapManager","event":"afterClose"}',"http://qinfo.clt.qq.com")},getVal:function(){var a=g[e()];return a&&[i(a.province,a.city),a.lng,a.lat,a.name].join("|")},getName:function(){var a=g[e()];return a?a.name:""},setVal:function(a){a=a.split("|");if(a.length===4){var b=c.getCatNamePath(a[0]).slice(2);g[e()]={province:b[0],city:b[1],lng:a[1],lat:a[2],name:a[3]}}},clearVal:function(){g[e()]=""}}})})();
