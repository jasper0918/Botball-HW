define("jquery,modules/setting/js/common/client,modules/setting/js/common/cgi,modules/setting/js/common/str,modules/common/js/db,modules/setting/js/common/cookie,modules/common/js/tdw_report,modules/common/js/reportPatchJquery".split(","),function(b,x,y,z,p){function q(a){a=eval("("+a.data+")");switch(a.event||a.fn){case "OnAdminChange":c.adminChanged=true,console.log("Setting adminSelector got Event OnAdminChange")}}var d=null,f,e,l,m,g,i,c,h=[],r=function(a){if(!d){var c=a.containerId||"body",a=
a.classname||"";b("body").append('<div id="adminBox" class="'+a+'">                <button id="editorCloser" class="boxCloser" ></button>                <h3><span>\u9009\u62e9\u7ba1\u7406\u5458</span></h3>                <div id="'+c+'_content" class="content" >                </div>                <div class="btnBox">                    <input type="button" id="selectorOK" value="\u786e\u5b9a"/>                </div>            </div>');d=b("#adminBox");f=b("#"+c+"_content");b("#selectorOK").click(n).bind("keydown",
function(a){switch(a.keyCode){case 13:n()}});d.find(".boxCloser").click(j).bind("keydown",function(a){switch(a.keyCode){case 13:j()}});d.change(function(a){h.push(a.target.checked?"manager_check":"manager_cancel");a=b(a.originalEvent.srcElement).attr("id");g[a]=!g[a]})}},s=function(){function a(){e=c.admins;if(f&&!(!f.length>0||!e||!e.length>0)){var a="";b.each(e,function(c,b){var d=b.uin;a+='<li class="admin">                    <label class="icon'+(b.owner?" owner":"")+'">                        <input type="checkbox" '+
(b.notReceive?'checked="checked"':"")+" id="+d+" > "+(b.owner?'<label class="nick" for="'+d+'" title="'+b.nick+'">'+b.nick+'</label><div class="owner-tip">\uff08\u63a5\u6536\u4e0d\u63d0\u793a\u6d88\u606f\uff09</div>':'<label class="nick" for="'+d+'" title="'+b.nick+'">'+b.nick+'</label><div class="uin">('+d+")</div>")+"</label></li>"});f.html("<ul>"+a+"</ul>")}}c.adminChanged?p.get_admin_auth({param:{gc:gc,auth:1},succ:function(b){if(b.result&&b.result.length>0)c.admins=[],b.result.forEach(function(a){c.admins.push({uin:a.uin,
nick:a.nick,notReceive:a.oper==0,owner:a.owner==1});a.oper==0&&notReceiveMsgAdmins.push(a.uin)});a()},err:function(){}}):a()},j=function(){h.length>0&&k(h);d.hide()},n=function(){i=false;c.blockedAdmins=[];b.each(e,function(a,b){var d=b.uin;if(g[d])b.notReceive=!b.notReceive,i=true;b.notReceive&&c.blockedAdmins.push(d)});j();(m||function(){})()},o=function(a){k("button_add");h=[];r(l);d.length&&(g={},s(),d.show());a.stopPropagation()},t=function(){},u=function(){},v=function(){},w=function(a){m=a.okClick;
b("#"+a.containerId).unbind("click",o).bind("click",o);b("#adminBox").bind("keypress",t).bind("keyup",u).bind("keydown",v)},k;return{init:function(a){l=a;c=a.status||{admins:[]};k=c.report_edu_manage||function(){};w(a);window.addEventListener("message",q)},setBlockedAdminArray:function(a){c.blockedAdmins=a||[];c.admins&&b.each(c.admins,function(a,d){d.notReceive=b.inArray(d.uin,c.blockedAdmins)>-1})},getAdminArray:function(){return c.admins},hasChanged:function(){return i},getBlockedAdminArray:function(){return b.map(c.admins,
function(a){return a.notReceive?a.uin:null})}}});
