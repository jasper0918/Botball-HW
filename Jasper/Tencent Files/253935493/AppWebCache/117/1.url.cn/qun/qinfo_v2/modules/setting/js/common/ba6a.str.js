define(function(){var h={quot:'"',lt:"<",gt:">",amp:"&",nbsp:" ","#34":'"',"#60":"<","#62":">","#38":"&","#160":" "},i={'"':"#34","<":"#60",">":"#62","&":"#38"," ":"#160"};return{decodeHtml:function(a){a+="";return a.replace(/&(quot|lt|gt|amp|nbsp);/ig,function(a,b){return h[b]}).replace(/&#u([a-f\d]{4});/ig,function(a,b){return String.fromCharCode(parseInt("0x"+b))}).replace(/&#(\d+);/ig,function(a,b){return String.fromCharCode(+b)})},encodeHtml:function(a){a+="";return a.replace(/["<>& ]/g,function(a){return"&"+
i[a]+";"})},byteLen:function(a,c){var b=c||2;a+="";var d=(a.match(/[^\x00-\xff]/g)||[]).length;return a.length+(b-1)*d},getMaxlen:function(a,c){var b="",d=0,f=0,g=false,e;if(a.replace(/[^\x00-\xff]/g,"xxx").length<=c)return a;for(;!g;)e=a.charAt(f),d+=e.match(/[^\x00-\xff]/)!==null?3:1,d>c?g=true:(b+=e,f++);return b}}});
