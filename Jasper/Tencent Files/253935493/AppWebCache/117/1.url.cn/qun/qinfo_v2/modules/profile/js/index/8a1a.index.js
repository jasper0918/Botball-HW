(function(){(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/common/TRecordPatch",[],d):a.TRecord=d(a.TRecord)})(this,function(a){a=a||window.TRecord;a.getInterval=function(a,f,b){return!this[f]||!this[a]?"":"&"+b+"="+(this[f]-this[a])};return a});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/common/selectionPatch",["simple"],d):a.selectionPatch=d($)})(this,function(a){var d=function(a,c,h){for(var e=0,g=0,i=0,i=0;i<a.length;i++)if(a.charCodeAt(i)>
255?g+=2:g++,g<=c)e++;else if(g>c+h)break;return a.substring(e,i)},f=function(a,c,h){for(var e=0,g=0,i=0,i=0;i<a.length;i++)if(a.charCodeAt(i)>255?g+=3:g++,g<=c)e++;else if(g>c+h)break;return a.substring(e,i)};return function(b){var c=function(a){var b="";if(window.getSelection)b=a.value.slice(a.selectionStart,a.selectionEnd);else if(document.selection)b=document.selection.createRange().text;return b};b.addInputState=function(c,e,g){var g=g||{},i={type:"text"};if("maxlength"in g||"maxLength"in g)i.maxlength=
g.maxlength||g.maxLength;if("id"in g)i.id=g.id;g=a.dom.getNode("input",i);g.value=e;c.appendChild(g);b.limitInputLength(g,i.maxlength)};b.limitInputLength=function(b,e,g){var g=g||3,i=[8,9,20,33,34,35,36,37,38,39,40,46,16,17],l;b.onpaste=function(i){var p=i.clipboardData?i.clipboardData.getData("Text"):"";if(p){c(b);var l=b.value,p=l.slice(0,b.selectionStart)+p+l.slice(b.selectionEnd);if(a.str.byteLen(p,g)>e)b.selectionEnd==l.length?(b.value=g==3?f(p,0,e):d(p,0,e),a.e.trigger(b,"input"),b.selectionStart=
b.selectionEnd):i.preventDefault()}};a.e.add(b,"keydown",function(n){!n.ctrlKey&&i.indexOf(n.keyCode)==-1&&a.str.byteLen(b.value,g)>=e&&c(b).length==0&&n.preventDefault();clearTimeout(l);l=setTimeout(function(){if(a.str.byteLen(b.value,g)>e)b.value=g==3?f(b.value,0,e):d(b.value,0,e),a.e.trigger(b,"input")},0)})}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/common/tmplPatch",[],d):a.tmplPatch=d()})(this,function(){return function(a){var d={};a.tmpl=function b(a,
h){var e=!/[^a-zA-Z0-9_-]/.test(a)?d[a]=d[a]||b(document.getElementById(a).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return h?e(h):e}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/common/util",
["./selectionPatch","./tmplPatch"],d):a.Util=d(a.selectionPatch,a.tmplPatch)})(this,function(a,d){var f={func:{throttle:function(a,c,h){var c=c||3E3,e=0,g,i,d=function(){i=arguments.length>0?arguments:i;var f=(new Date).getTime(),p=f-e;p>=c?(a.apply(h,i),e=f):(clearTimeout(g),g=setTimeout(function(){d.apply(h,i)},c-p))};return d}},getBkn:function(){var a=$.cookie.get("skey"),c="";if(a){for(var c=5381,h=0,e=a.length;h<e;++h)c+=(c<<5)+a.charAt(h).charCodeAt();c&=2147483647}return c},urlencode:function(a){var c=
[],h;for(h in a)c.push(h+"="+encodeURIComponent(a[h]));return c.join("&")},genRandomArray:function(a){for(var c=0,h=[],e=a.length,g=0,i=[];c<e;c++)i.push(a[c]);for(c=0;c<e;c++)g=Math.floor(Math.random()*(e-c)),h.push(i[g]),i.splice(g,1);return h}};a(f);d(f);return f});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/common/client",[],d):a.Client=d()})(this,function(){(function(){var a;return function(){if(!a&&(a=((window.Simple||{}).browser||{}).info,!a)){a={type:""};
var c=navigator.userAgent.toLowerCase();/webkit/.test(c)?a={type:"webkit",version:/webkit[\/ ]([\w.]+)/}:/opera/.test(c)?a={type:"opera",version:/version/.test(c)?/version[\/ ]([\w.]+)/:/opera[\/ ]([\w.]+)/}:/msie/.test(c)?a={type:"msie",version:/msie ([\w.]+)/}:/mozilla/.test(c)&&!/compatible/.test(c)&&(a={type:"ff",version:/rv:([\w.]+)/});a.version=(a.version&&a.version.exec(c)||[0,"0"])[1]}return a}})();var a={getHash:function(a){a=window.location.hash.match(RegExp("(#|&)"+a+"=([^&]*)(&|$)"));
return!a?"":decodeURIComponent(a[2])},query:function(a){a=window.location.search.match(RegExp("(\\?|&)"+a+"=([^&]*)(&|$)"));return!a?"":decodeURIComponent(a[2])}},d=function(a,c,h){var e=null,g=top;console.info("callClientAPI:name["+a+"],params["+c+"],msgType["+h+"],typeof params="+typeof c);try{switch(a){case "OnSave":"OnSave"in g.external&&(e=g.external.OnSave(c));break;case "OnShowTips":"OnShowTips"in g.external?e=g.external.OnShowTips(c,h):alert(c);break;case "IsSelfOnline":"Hummer_Contact_IsOnline"in
g.external?(console.info("before run client:Hummer_Contact_IsOnline"),e=g.external.Hummer_Contact_IsOnline()):"IsSelfOnline"in g.external?(console.info("before run client:IsSelfOnline"),e=g.external.IsSelfOnline()):window.DEBUG&&(e=true);break;case "OnModifyRemark":"OnModifyRemark"in g.external&&(e=g.external.OnModifyRemark());break;case "OpenModifyHeadWnd":"OpenModifyHeadWnd"in g.external&&(c+="",g.external.OpenModifyHeadWnd(c));break;case "ModifyRemark":"ModifyRemark"in g.external&&g.external.ModifyRemark(c);
break;case "OpenUpgradeFrame":"OpenUpgradeFrame"in g.external&&g.external.OpenUpgradeFrame()}}catch(i){}return e},f=-1;return{getClientVersion:function(){if(f===-1){var b=-1,c=top,h=a.query("clientversion")||a.getHash("clientversion");h&&(b=h);b===-1&&"external"in c&&("CallHummerApi"in c.external?b=c.external.CallHummerApi("IM.GetVersion"):"Hummer_IM_GetVersion"in c.external&&(b=c.external.Hummer_IM_GetVersion()));f=b===-1?0:b}return f},callClientAPI:d,hasClientAPI:function(a){var c=top;return"external"in
c&&a in c.external},showTips:function(a,c){a&&(c===void 0&&(c=1),d("OnShowTips",a,c))},confirm:function(a,c,h){var e={};try{e=top.external.CallHummerApi("Window.Confirm",JSON.stringify({iconType:a,title:c,text:h})),e=JSON.parse(e)}catch(g){e={}}return e}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/User",["simple"],d):a.User=d(a.$)})(this,function(a){var d={},f="visitor",b={visitor:[],member:["addTag"],admin:["addTag","editCat","delTag"],owner:["addTag",
"editCat","delTag"]};d.hasPermission=function(a){return b[f].indexOf(a)!==-1};d.setRole=function(a){f=a===1?"member":a===2?"admin":a===3?"owner":"visitor"};d.getRoleType=function(){return f};d.bSetDetail=true;d.uin=a.cookie.uin();d.qunCatArr=[];return d});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/MapManage",["simple","catCtrl"],d):a.MapManage=d(a.Simple,a.CatCtrl)})(this,function(a,d){function f(){var a=d.getCatNamePath(i()).join("");return a.indexOf("\u540c\u4e8b\u670b\u53cb")>
-1?a:a.split("-")[0]}function b(a,b){return a?b?d.getItemIdByPathStr(10013,a+"-"+b):d.getItemIdByPathStr(10013,a):0}var c={},h,e,g={},i=function(){},l=function(a){return a},n={"\u540c\u4e8b\u670b\u53cb-\u540c\u4e8b":"ly","\u540c\u4e8b\u670b\u53cb-\u4eb2\u53cb":"ly","\u884c\u4e1a\u4ea4\u6d41":"ly","\u5b66\u4e60\u8003\u8bd5":"ly","\u7f6e\u4e1a\u5b89\u5bb6":"ly","\u7c89\u4e1d":"ly","\u6e38\u620f":"ly","\u540c\u4e8b\u670b\u53cb-\u540c\u5b66":"ggfw","\u5174\u8da3\u7231\u597d":"sh","\u751f\u6d3b\u4f11\u95f2":"sh",
"\u54c1\u724c\u4ea7\u54c1":"sh"};return window.MapManage=c={init:function(a){a=a||{};if("getCatFn"in a&&typeof a.getCatFn==="function")i=a.getCatFn;if("encodeFn"in a&&typeof a.encodeFn==="function")l=a.encodeFn},convertToId:b,convertToName:function(a){return d.getCatNamePath(a).slice(2).join("-")},loadMap:function(b,c,w){var z,A,F;z=d.getCatNamePath(i()).join("-");for(A in n)z.indexOf(A)===0&&(F=n[A]);c={edit:c,category:F||""};if(z=g[f()])c.lng=z.lng,c.lat=z.lat,c.name=z.name||b||"";w?(e=w,e.style.display=
"block"):(h?h.style.display="block":(h=a.dom.getNode("div",{"class":"map-container"}),document.body.appendChild(h)),e=h);e.innerHTML='<iframe src="/qinfo_v2/modules/profile/map.html#'+l(c)+'" width="100%" scrolling="no" height="100%" frameborder="no" border="0"></iframe>';return e},close:function(b){b&&b.name&&(g[f()]=b,a.oop.notifyObservers(c,"setMap",b));e.style.display="none";window.postMessage('{"from":"MapManager","event":"afterClose"}',"http://qinfo.clt.qq.com")},getVal:function(){var a=g[f()];
return a&&[b(a.province,a.city),a.lng,a.lat,a.name].join("|")},getName:function(){var a=g[f()];return a?a.name:""},setVal:function(a){a=a.split("|");if(a.length===4){var b=d.getCatNamePath(a[0]).slice(2);g[f()]={province:b[0],city:b[1],lng:a[1],lat:a[2],name:a[3]}}},clearVal:function(){g[f()]=""}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/LBS",["simple","../common/client","./MapManage"],d):a.LBS=d(a.$,a.Client,a.MapManage)})(this,function(a,d,f){var b=
{useCityName:false,setPseudoAddr:function(a,h,e){var g;if(a&&h){switch(a){case "\u540c\u5b66":(a=h.split(/[-\|]/))&&a.length>=2&&(g=a[1]);break;case "\u4e1a\u4e3b":g=h}if(g)this.seCityName=false}if(!g&&e&&(a=e.split("|"),e=a[0],a=a[3],e&&!a))g=f.convertToName(e),this.useCityName=true;if(g)b.pseudoAddr=g},set_lbs_html:function(a,b){var b=b||{},e=b.canedit,g=typeof b.str==="string"?b.str:"",g=g?e?'<em class="lbs"></em>'+g+'<a class="check" aria-label="\u4fee\u6539\u7fa4\u5730\u70b9" title="\u4fee\u6539\u7fa4\u5730\u70b9" href="javascript:void(0)" tabIndex="-1" data-action="mod">\u4fee\u6539</a></span><a href="javascript:void(0)" class="del" aria-label="\u5220\u9664\u7fa4\u5730\u70b9" title="\u5220\u9664\u7fa4\u5730\u70b9" tabIndex="-1" data-action="del">\u6e05\u9664</a>':
'<em class="lbs"></em>'+g+(this.useCityName?"":'<a class="check" aria-label="\u5728\u5730\u56fe\u4e0a\u67e5\u770b\u7fa4\u5730\u70b9" title="\u5728\u5730\u56fe\u4e0a\u67e5\u770b\u7fa4\u5730\u70b9" href="javascript:void(0)" tabIndex="-1" data-action="view">\u67e5\u770b</a>'):e?'<em class="nolbs"></em><span class="gray new-ui-pos-hint">\u6dfb\u52a0\u5730\u7406\u4f4d\u7f6e\uff0c\u8ba9\u9644\u8fd1\u7684\u597d\u53cb\u80fd\u770b\u5230\u4f60\u7684\u7fa4\u3002</span><a class="check" aria-label="\u6dfb\u52a0\u7fa4\u5730\u70b9" href="javascript:void(0);" tabIndex="-1" data-action="add">\u6dfb\u52a0</a>':
"-";a.innerHTML=g},get_lbs_str:function(a){var h=b.pseudoAddr||"";a||(a=f.getVal());a&&(a=a.split("|"),a.length===4&&a[3]&&(h=a[3]));return h}};b.LBSTip=function(){var c,h;return{init:function(e){typeof c==="undefined"&&(c=parseInt(a.cookie.get("lbs_tip"),10));if(!c&&!b.get_lbs_str()){a.cookie.set("lbs_tip","1",null,"/qinfo_v2/modules/profile",17520);c=true;h=document.createElement("div");h.className="lbs-tip";h.innerHTML='            <h3>\u8ba9\u66f4\u591a\u9644\u8fd1\u7684\u4eba\u770b\u5230\u4f60\u7684\u7fa4\uff01</h3>            <p>\u6dfb\u52a0\u5730\u70b9\u540e\u4f60\u7684\u7fa4\u5c06\u4f1a\u5c55\u793a\u5728\u624b\u673aQQ<br>\u201c\u9644\u8fd1\u7684\u7fa4\u201d\u5217\u8868<a class="btn" href="javascript:void(0)">\u7acb\u5373\u6dfb\u52a0</a></p>            <a class="cls" href="javascript:void(0)"></a>';
e.appendChild(h);this.show();var g=this,e=a.dom.queryClass("cls","a",h);a.e.add(e,"click",function(){g.hide()});e=a.dom.queryClass("btn","a",h);a.e.add(e,"click",function(){var b=a("qun-loc-value");a.e.trigger(a.dom.queryClass("check","a",b),"click");g.hide()});a.oop.addObserver(b,"addLBS",function(){g.hide()})}},show:function(){a.css.show(h)},hide:function(){a.css.hide(h)}}}();return b});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/ActionBar",["simple",
"commonapi"],d):a.ActionBar=d(a.$)})(this,function(a,d){var f={},b=function(){var b=0,c;return{request:function(e){b++;c=function(a,h){b===h&&(e(a),c=void 0)};a.oop.notifyObservers(f,"modifyCheckerRequest",b)},registry:function(){a.oop.addObserver(f,"modifyCheckerResponse",function(a){typeof c==="function"&&c(a.isModify,a.seq)})},unregistry:function(){a.oop.removeObserver(f,"modifyCheckerResponse")}}}(),c=function(){f.startEditing();a.oop.notifyObservers(f,"editBtnClick")},h=function(){a.oop.notifyObservers(f,
"closeBtnClick");f.tryToLeave()},e=function(){b.request(function(b){b?a.oop.notifyObservers(f,"confirmSave"):f.stopEditing()});a.oop.notifyObservers(f,"saveBtnClick")};f.init=function(){b.registry();a.e.add(a("action-edit"),"click",c);a.e.add(a("action-close"),"click",h);a.e.add(a("action-save"),"click",e)};f.tryToLeave=function(){b.request(function(b){b?(b=d.confirm(1,"\u7fa4\u8d44\u6599\u5361","\u60a8\u5df2\u5bf9\u8d44\u6599\u505a\u4e86\u4fee\u6539\uff0c\u662f\u5426\u4fdd\u5b58\uff1f"))&&b.ret?
a.oop.notifyObservers(f,"confirmSave"):f.stopEditing():f.stopEditing()})};f.startEditing=function(){a.css.updateClass(document.body,"editing","reading");a.oop.notifyObservers(f,"editingStatusChange",{isEditing:true})};f.disableSaveBtn=function(){a("action-save").setAttribute("disabled","disabled")};f.enableSaveBtn=function(){a("action-save").removeAttribute("disabled")};f.stopEditing=function(){a.oop.notifyObservers(f,"editingStatusChange",{isEditing:false})};f.destroy=function(){b.unregistry();a.e.remove(a("action-edit"),
"click",c);a.e.remove(a("action-close"),"click",h);a.e.remove(a("action-save"),"click",e)};return f});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/db_app",["modules/common/js/db"],d):a.DB=d(a.DB)})(this,function(a){a.genSampleAPI("search_string","qun_info/search_string");a.genSampleAPI("set_group_info","qun_info/set_group_info_new");a.genSampleAPI("set_group_more_info","qun_info/set_group_more_info");a.genSampleAPI("set_group_setting","qun_info/set_group_setting");
a.genSampleAPI("get_group_setting","qun_info/get_group_setting");return a});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/searchSuggestions",["simple","../common/util","./db_app"],d):a.searchSuggestions=d(a.$,a.Util,a.DB)})(this,function(a,d,f){var b={},c={};c.fn=d.func.throttle(function(c,e,g){var i={sid:c,s:e,n:10};if(c===3){var d=b.provinceIpt.value,n=b.cityIpt.value;if(/\u5e02$/.test(d))i.k=d.slice(0,-1);else if(/\u5e02$/.test(n))i.k=n.slice(0,-1)}else if(c===
4)if(b.school&&b.lastSchoolIDCache)i.k=b.lastSchoolIDCache[b.school];else return;b.search_key=e;f.search_string({param:i,succ:function(i){if(b.search_key===e){var d=i.s||[];if(d.length>0){if(i.k&&(c===2||c===5||c===7)){var f={},l="";a.array.forEach(d,function(b,c){l=a.str.decodeHtml(b);f[l]=i.k[c];d[c]=l});b.lastSchoolIDCache=f;f=null}else a.array.forEach(d,function(b,c){d[c]=a.str.decodeHtml(b)});d.sort(function(a,b){var c=a.indexOf(e),g=b.indexOf(e);return c===g?a.length-b.length:c-g});g.refreshData(d);
a.css.addClass(g.$ul.children[0],"on");g.keySel=0;g.show()}else g.hide()}}})},500);c.setValue=function(a,c){b[a]=c};return c});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/InputSuggestion",["simple","../common/util","./User","catCtrl","./searchSuggestions"],d):a.InputSuggestion=d(a.$,a.Util,a.User,a.CatCtrl,a.searchSuggestions)})(this,function(a,d,f,b,c){var h=function(){var b={pinyin:{path:"http://1.url.cn/qun/qinfo_v2/modules/profile/js/external/eb83.pinyin.js",
url:"http://1.url.cn/qun/qinfo_v2/modules/profile/js/external/eb83.pinyin.js",expose:"$pinyin"}},c=typeof define==="function"&&define.amd?function(a){require([b[a].path],function(c){b[a].m=c})}:function(c){a.http.loadScript(b[c].url,function(){b[c].m=window[b[c].expose]})};return function(a){if(a){var e=b[a];e&&!("m"in e)&&c(a);return b[a]}else{for(e in b)"m"in b[e]||c(e);return b}}}(),e=function(b,i,d){if(!e.instances)e.instances=[];e.instances.push(this);this.$ipt=b;this.type=i;this.name=b.name;
this.$div=document.createElement("div");this.$div.className="select"+(d?" "+d:"");this.$ul=document.createElement("ul");this.$div.appendChild(this.$ul);this.$ipt.parentNode.appendChild(this.$div);this.visible=false;if(i==="select")this.refreshData(),this.$ipt.setAttribute("role","combobox"),this.$ipt.setAttribute("aria-autocomplete","none"),this.$ipt.setAttribute("aria-readonly","true"),this.$ipt.setAttribute("aria-owns",this.$ipt.id+"-ul"),this.$ipt.setAttribute("aria-label","\u8bf7\u6309\u4e0a\u4e0b\u952e\u9009\u62e9,enter\u952e\u786e\u8ba4"),
this.$ipt.setAttribute("readonly","true"),this.$ipt.setAttribute("tabIndex","1"),this.$ul.id=this.$ipt.id+"-ul",this.$ul.setAttribute("aria-expanded","false"),this.$ul.setAttribute("role","list"),this.$ul.setAttribute("tabIndex","-1"),this.keyboardHandler=function(b){var c=this,g=function(b){var g=c.keySel===void 0?-1:c.keySel,b=g+b;if(b>=0&&b<c.$ul.children.length)g>=0&&a.css.removeClass(c.$ul.children[g],"on"),a.css.addClass(c.$ul.children[b],"on"),c.keySel=b,c.$ul.children[b].setAttribute("tabIndex",
"1"),c.$ul.children[b].focus(),c.$ul.children[g]&&c.$ul.children[g].setAttribute("tabIndex","-1")};switch(b.keyCode){case 38:!c.visible&&c.show();g(-1);break;case 40:!c.visible&&c.show();g(1);break;case 13:this.keySel!==void 0&&(a.e.trigger(this.$ul.children[this.keySel].firstChild,"click"),this.$ipt.focus())}},this.blurHandler=function(){this.hide();var b=this.$ul.children[this.keySel];b&&(a.css.removeClass(b,"on"),b.removeAttribute("tabIndex"));this.keySel=void 0;e.curFocusInput=null},a.e.add(b,
"focus",a.oop.bind(function(){e.curFocusInput=this},this)),a.e.add(b,"click",a.oop.bind(function(a){this.dataSource.length!==0&&this.toggle(false);a.stopPropagation()},this)),b.name==="school"&&a.e.add(b,"blur",function(){c.setValue("school",this.value)});else if(i==="select2"){if(this.refreshData(),b.setAttribute("tabIndex","1"),!b.id&&(b.id=b.name),i=a.dom.getNode("label",{"class":"element-invisible","for":this.$ipt.getAttribute("id")}),i.innerHTML=b.getAttribute("placeholder"),b.parentNode.appendChild(i),
i=null,a.e.add(b,"blur",a.oop.bind(function(){if(this.$ipt.value!==""&&this.$ul.children.length>0&&this.searchMode)this.$ipt.value=this.$ul.firstChild.textContent,this.searchMode=false,this.name==="province"&&a.oop.notifyObservers(this,"provinceChanged"),a.oop.notifyObservers(e,"fillQunDetail")},this)),a.e.add(b,"click",a.oop.bind(function(a){this.dataSource.length!==0&&(this.toggle(true),a.stopPropagation())},this)),a.e.add(b,"keyup",a.oop.bind(this.searchSource,this)),this.name==="city"){var h=
e.instances.length-2;a.oop.addObserver(e.instances[h],"provinceChanged",function(){var a=e.instances[h+1];a.$ipt.value="";a.refreshData()})}}else if(i==="suggest")a.e.add(b,"keyup",a.oop.bind(this.getSuggestions,this)),b.setAttribute("tabIndex","1"),!b.id&&(b.id=b.name),i=a.dom.getNode("label",{"class":"element-invisible","for":this.$ipt.id}),i.innerHTML=b.getAttribute("placeholder"),b.parentNode.appendChild(i),i=null;a.e.add(this.$div,"click",a.oop.bind(function(b){b.preventDefault();b.stopPropagation();
if(b.target.nodeName.toLowerCase()==="a")if(b=b.target.firstChild.textContent,this._afterSelectArr)for(var g=0,d=this._afterSelectArr.length;g<d;g++)this._afterSelectArr[g].call(this,b);else this.$ipt.value=b,this.$ipt.blur(),this.name==="school"&&c.setValue("school",b),b=this.name,(b==="building"||b==="institute"||b==="school"||b==="highSchool"||b==="elementarySchool")&&a.oop.notifyObservers(e,"fillQunDetail");this.keySel!==void 0&&a.css.removeClass(this.$ul.children[this.keySel],"on");this.keySel!==
void 0&&this.$ul.children[this.keySel].setAttribute("tabIndex","-1");this.keySel=void 0;this.hide()},this));a.e.add(this.$div,"scroll",a.oop.bind(function(){console.info("onSrollInInputSuggestion");if(this.$div.scrollTop===0)this.$div.scrollTop=1;else if(this.$div.scrollTop===this.$div.scrollHeight-this.$div.clientHeight)this.$div.scrollTop=this.$div.scrollHeight-this.$div.clientHeight-1},this));this.$ipt.inputSuggestion=this};e.hideAll=function(){e.lastShown&&e.lastShown.hide()};e.hilightLi=function(b,
c){var e=c.$ul.children;e.length>0&&!c.visible&&c.show();var d=c.keySel===void 0?-1:c.keySel,h=d+b;if(h>=0&&h<e.length)d>=0&&a.css.removeClass(e[d],"on"),a.css.addClass(e[h],"on"),c.keySel=h,e=c.$div.clientHeight,h*=24,b===-1&&h<c.$div.scrollTop?c.$div.scrollTop-=24:b===1&&h>=e+c.$div.scrollTop&&(c.$div.scrollTop+=24)};e.prototype={registerAfterOperations:function(a){if(!this._afterSelectArr)this._afterSelectArr=[];this._afterSelectArr.push(a)},refreshData:function(c){if(!c){c=b.Config.DataSource[this.$ipt.name];
if(typeof c==="function")var d=a.array.indexOf(e.instances,this),c=c(e.instances[d-1]);else c=c||[];if(this.type==="select2"){var f=h("pinyin").m;if(f){var n=[],p=this.name==="province";a.array.forEach(c,function(a){p?(b.Config.PyCache[a]===void 0&&(b.Config.PyCache[a]=f.convertPYs(a)),n.push(b.Config.PyCache[a])):n.push(f.convertPYs(a))});this.pinyinList=n}}this.dataSource=c}for(var d=[],v=0,w=c.length;v<w;v++)d.push('<li role="option" tabIndex="-1"><a href="javascript:void(0);">'+c[v]+"</a></li>");
this.$ul.innerHTML=d.join("")},searchSource:function(b){var c=this;switch(b.keyCode){case 38:e.hilightLi(-1,c);break;case 40:e.hilightLi(1,c);break;case 13:if(this.keySel!==void 0)this.$ipt.value=this.$ul.children[this.keySel].textContent,this.hide(),this.searchMode=false,this.name==="province"&&a.oop.notifyObservers(this,"provinceChanged"),a.oop.notifyObservers(e,"fillQunDetail");break;default:delete this.keySel;var d=this.$ipt.value;if(d){this.searchMode=true;var f=[];a.array.forEach(this.dataSource,
function(a,b){(a.indexOf(d)!==-1||h("pinyin").m&&c.pinyinList&&(c.pinyinList[b][0].indexOf(d)!==-1||c.pinyinList[b][1].indexOf(d)!==-1))&&f.push(a)});f.length!==0&&(this.refreshData(f),this.show())}else this.searchMode=false,this.refreshData(),this.show()}},getSuggestions:function(d){switch(d.keyCode){case 38:e.hilightLi(-1,this);break;case 40:e.hilightLi(1,this);break;case 13:if(this.keySel!==void 0)this.$ipt.value=this.$ul.children[this.keySel].textContent,this.hide(),d=this.$ipt.getAttribute("name"),
(d==="building"||d==="institute"||d==="school"||d==="highSchool"||d==="elementarySchool")&&a.oop.notifyObservers(e,"fillQunDetail");break;default:delete this.keySel;var h=this.$ipt.value.replace(/\s/gm,""),d=this.$ipt.getAttribute("name");h&&a.str.byteLen(h,3)<=this.$ipt.getAttribute("maxLength")?c.fn(b.Config.SearchTypes[d],h,this):this.hide();(d==="building"||d==="institute"||d==="school"||d==="highSchool"||d==="elementarySchool")&&a.oop.notifyObservers(e,"fillQunDetail")}},show:function(){if(e.lastShown){if(e.lastShown!==
this)e.lastShown.hide(),e.lastShown=this}else e.lastShown=this,this.$div.style.display="block";this.visible=true;this.$div.scrollTop=0},hide:function(){this.$div.style.display="none";this.visible=false;a.css.removeClass(this.$ipt,"select-open");e.lastShown=null;delete this.keySel},toggle:function(b){if(this.visible)this.hide();else{if(b)this.searchMode=false,this.refreshData();this.show();a.css.addClass(this.$ipt,"select-open")}}};e.getDepModule=h;a.e.add(document,"keyup",function(a){var b=e.curFocusInput;
if(a.keyCode===9){var c=document.activeElement;if(c&&b&&c!==b.$ipt&&c.parentNode.id!==b.$ul.id){b.blurHandler();return}}if(b&&b.type==="select")return a.stopPropagation(),a.preventDefault(),b.keyboardHandler(a),false});return e});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/Select",["simple","../common/util"],d):a.Select=d(a.$,a.Util)})(this,function(a,d){var f=new a.oop.Class({init:function(a){this.dataSource=[];var c=document.createElement("span");c.className=
"title";c.innerHTML=a||"-";a=document.createElement("div");a.className="select";this.tmpl=d.tmpl('<ul aria-expanded="false" role="list" tabIndex="-1"><% for (var i = 0, len = obj.length; i<len; i++){ %><li role="option" tabIndex="-1"><a href="javascript:void(0)" data="<%=obj[i][0]%>"><%=obj[i][1]%></a></li><% } %></ul>');this.$title=c;this.$select=a;this.visible=false;this.$select.style.display="none"},render:function(a){this.dataSource=a;this.$select.innerHTML=this.tmpl(a);this.$select.firstChild.id=
this.$select.parentNode.id+"-ul"},set:function(b){for(var c=this.dataSource,d=0,e=c.length;d<e;d++)if(c[d][1]===b){a.e.trigger(this.$select.getElementsByTagName("a")[d],"click");break}},afterSelect:function(a){if(!this._callbacks)this._callbacks=[];this._callbacks.push(a)},arm:function(b){var c=a.dom.getNode("div",{"class":"title-wrap",tabIndex:"1",role:"combobox","aria-autocomplete":"false","aria-readonly":"true","aria-label":"\u8bf7\u6309\u4e0a\u4e0b\u952e\u9009\u62e9,enter\u952e\u786e\u8ba4",readonly:"true"});
c.appendChild(this.$title);b.appendChild(c);b.appendChild(this.$select);c.setAttribute("aria-owns",b.id+"-ul");this.keyboardHandler=function(b){var c=this,d=this.$select.firstChild.children,f=function(b){var h=c.keySel===void 0?-1:c.keySel,b=h+b;if(b>=0&&b<d.length)h>=0&&a.css.removeClass(d[h],"on"),a.css.addClass(d[b],"on"),c.keySel=b,d[b].setAttribute("tabIndex","1"),d[b].focus(),d[h]&&d[h].setAttribute("tabIndex","-1")};switch(b.keyCode){case 38:!c.visible&&c.show();f(-1);break;case 40:!c.visible&&
c.show();f(1);break;case 13:this.keySel!==void 0&&(this.onSelectItem({target:d[this.keySel].firstChild}),b.preventDefault())}b.stopPropagation()};a.e.add(c,"click",a.oop.bind(this.onTitleClick,this));a.e.add(this.$select,"click",a.oop.bind(this.onSelectItem,this));a.e.add(this.$select,"scroll",a.oop.bind(this.onSrollInSelect,this));a.e.add(c,"focus",a.oop.bind(function(){f.hideAll()},this));a.e.add(b,"keyup",a.oop.bind(this.keyboardHandler,this))},mark:function(b){a.css[b?"addClass":"removeClass"](this.$title.parentNode,
"error")},onTitleClick:function(a){this.toggle();a.stopPropagation()},onSelectItem:function(b){var b=b.target,c=parseInt(b.getAttribute("data"),10);if(this.id!==c&&(this.$title.innerHTML=b.innerHTML,this.id=c,this.$title.setAttribute("aria-label","\u60a8\u5df2\u9009\u62e9"+this.$title.innerHTML),this._callbacks)){b=0;for(c=this._callbacks.length;b<c;b++)this._callbacks[b].call(null)}this.keySel!==void 0&&(a.css.removeClass(this.$select.firstChild.children[this.keySel],"on"),this.$select.firstChild.children[this.keySel].setAttribute("tabIndex",
"-1"));this.keySel=void 0;this.$title.parentNode.focus()},onSrollInSelect:function(){console.info("onSrollInSelect");if(this.$select.scrollTop===0)this.$select.scrollTop=1;else if(this.$select.scrollTop===this.$select.scrollHeight-this.$select.clientHeight)this.$select.scrollTop=this.$select.scrollHeight-this.$select.clientHeight-1},toggle:function(){!this.visible&&this.dataSource.length!==0?this.show():this.hide()},show:function(){this.$select.style.display="block";this.visible=true;a.css.addClass(this.$title,
"select-open");f.lastShown&&f.lastShown.hide();f.lastShown=this},hide:function(){this.$select.style.display="none";this.visible=false;a.css.removeClass(this.$title,"select-open");f.lastShown=null},hideEntry:function(){a.css.hide(a("subcategory-value"));this.id=-2},selectDefault:function(){this.$title.innerHTML="-";this.id=-1;a.css.show(a("subcategory-value"))}});f.hideAll=function(){f.lastShown&&f.lastShown.hide()};return f});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/DetailTrigger",
["simple","./InputSuggestion","./Select","./User","./ActionBar"],d):a.DetailTrigger=d(a.$,a.InputSuggestion,a.Select,a.User,a.ActionBar)})(this,function(a,d,f,b,c){var h=new a.oop.Class({init:function(b,c){var h=a.dom.queryClass("detail-trigger-ctn","div",b);h&&_catSelectWrap.removeChild(h);var h=a.dom.getNode("div",{"class":"detail-trigger-ctn"}),l=a.dom.getNode("div",{"class":"detail-trigger"});h.appendChild(l);var n=a.dom.getNode("div",{"class":"detail-rich"});h.appendChild(n);b.appendChild(h);
l.setAttribute("tabIndex",c.tabIndex!==void 0?c.tabIndex:"0");this.$ctn=h;this.$title=l;this.$popView=n;this.$title.dt=this;this.visible=false;this.$popView.style.display="none";a.e.add(this.$title,"click",a.oop.bind(this.onTitleClick,this));a.e.add(this.$popView,"click",function(a){a.stopPropagation();d.hideAll();f.hideAll()})},onTitleClick:function(a){this.toggle();a.stopPropagation()},toggle:function(){this.visible?this.hide():this.show()},show:function(){this.$title.setAttribute("tabIndex","-1");
this.$popView.style.display="block";this.visible=true;a.css.addClass(this.$ctn,"trigger-open");h.lastShown&&h.lastShown.hide();h.lastShown=this},hide:function(){this.$title.setAttribute("tabIndex","1");d.hideAll();f.hideAll();this.$popView.style.display="none";a.css.removeClass(this.$ctn,"trigger-open");this.visible=false;h.lastShown=null},fillTriggerContent:function(d){this.$title.innerHTML=a.str.encodeHtml(d);b.bSetDetail||c.enableSaveBtn()}});h.hideAll=function(){h.lastShown&&h.lastShown.hide()};
return h});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/common/hintState",["simple"],d):a.StateHint=d(a.$)})(this,function(a){return function(){var d={"qun-name":false,"qun-intro":false,"qun-tag":false,"qun-cat":false,"qun-detail":false,"qun-loc":false},f={"qun-head":20,"qun-cat":20,"qun-loc":10,"qun-intro":20,"qun-tag":30},b={"qun-head":function(){},"qun-name":function(){var b=a("qun-name");a("qun-name-icon");d["qun-name"]=a.str.trim(b.value)?true:false},"qun-intro":function(){var b=
a("qun-intro");a("qun-intro-succ-icon");a("qun-intro-hint");d["qun-intro"]=a.str.byteLen(b.value,3)<60?false:true},"qun-tag":function(b){a("qun-tag-hint");a("qun-tag-succ-icon");d["qun-tag"]=b<4?false:true},"qun-cat":function(b){var c=a("qun-cat-hint"),g=a("qun-cat-succ-icon");a.str.trim(b)?(a.css.hide(c),d["qun-cat"]=true):(a.css.hide(g),d["qun-cat"]=false)},"qun-detail":function(b){a("qun-detail-icon");d["qun-detail"]=a.str.trim(b)?true:false;c["qun-detail"]&&c["qun-detail"]()},"qun-loc":function(b){a("qun-loc-succ-icon");
d["qun-loc"]=a.str.trim(b)?true:false}},c={};return{toggle:function(a){b[a].apply(this,Array.prototype.slice.call(arguments,1))},allPass:function(){var a=true,b;for(b in d)if(!d[b]){a=false;break}return a},getPercent:function(a){return f[a]||0},listen:function(a,b){c[a]=b}}}()});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/Panel","simple,../common/client,./User,../common/util,./ActionBar,catCtrl,./InputSuggestion,./searchSuggestions,./DetailTrigger,../common/hintState".split(","),
d):a.Panel=d(a.$,a.Client,a.User,a.Util,a.ActionBar,a.CatCtrl,a.InputSuggestion,a.searchSuggestions,a.DetailTrigger,a.HintState)})(this,function(a,d,f,b,c,h,e,g,i,l){function n(b,c,d){b=new e(b,c,d);F||(F=true,a.oop.addObserver(e,"fillQunDetail",function(){p()}));return b}function p(){var b=a("qun-detail"),d=b.querySelector(".detail-trigger");if(d){var e;e=a("college-ipt");var h=[],b=b.querySelectorAll("input"),g=b.length;e&&a.css.hasClass(e.parentNode,"no-college-wrap")&&g--;var i="";for(e=0;e<g;e++)(i=
a.str.trim(b[e].value))&&h.push(i);d.innerHTML=a.str.encodeHtml(h.join("-"));l.toggle("qun-detail",h.join());f.bSetDetail||c.enableSaveBtn()}}function v(b,c){var d=n(b,"select2",c);d.registerAfterOperations(function(b){this.searchMode=false;this.$ipt.value=b;this.name==="province"&&a.oop.notifyObservers(this,"provinceChanged");p()});return d}function w(){if(typeof f.jCat=="undefined")return false;var b=f.jCat.id!==f.crtCatId||f.jSubcat.id!==f.crtSubcatId;if(!b)if(f.crtCatId===void 0||f.crtSubcatId===
-1)b=false;else{var b=a("qun-detail").querySelectorAll("input"),c,d=b.length;c=a("college-ipt");var e=[];c&&a.css.hasClass(c.parentNode,"no-college-wrap")&&d--;for(c=0;c<d;c++)e.push(a.str.trim(b[c].value));b=e.join("-")!==f.fakeDesc}return b}function z(b,c,d){if(arguments.length>0)f.crtCatId=b,f.crtSubcatId=c,f.fakeDesc=d;else{f.crtCatId=f.jCat.id;f.crtSubcatId=f.jSubcat.id;var e=a("qun-detail").querySelectorAll("input"),h,g=e.length;h=a("college-ipt");var i=[];h&&a.css.hasClass(h.parentNode,"no-college-wrap")&&
g--;for(h=0;h<g;h++)i.push(a.str.trim(e[h].value));f.fakeDesc=i.join("-")}}function A(){H=true;var b=a("qun-detail");a.css.addClass(b.lastChild,"detail-trigger-disabled")}var F=false,H=false,t=function(){console.error("Error: [Panel]: unexpect internal call: getInfoFn!")};return{init:function(a){if(a&&"getInfoFn"in a)t=a.getInfoFn},changeDetailState:function(){H=false;var d=f.jCat.id,e=f.jSubcat.id,u=a("qun-detail");u.removeChild(u.lastChild);var q="desc",j=null,o=null,j="",B=t("desc");if(e===-2){d===
25?(q="games",j="LOL\u3001\u9b54\u517d\u3001QQ\u6e38\u620f\uff1f\u4f60\u4eec\u4e00\u8d77\u73a9\u7684\u6e38\u620f\u662f\uff1f"):d===26?(q="products",j="\u82f9\u679c\u3001\u5c3c\u5eb7\u3001\u5b9d\u9a6c\u3001\u9999\u5948\u5c14\uff1f\u4f60\u4eec\u70ed\u8877\u7684\u54c1\u724c\u662f\uff1f"):d===27&&(q="celebrity",j="\u9648\u5955\u8fc5\u3001\u97e9\u5bd2\u3001\u674e\u5f00\u590d\u3001\u6797\u4e66\u8c6a\uff1f\u4f60\u4eec\u662f\u8c01\u7684\u7c89\u4e1d\uff1f");j=a.dom.getNode("input",{name:q,type:"text",maxLength:"40",
placeholder:j,tabIndex:"1"});b.limitInputLength(j,40,2);o=a.dom.getNode("div",{"class":"detail-trigger-ctn trigger-ctn-single"});o.appendChild(j);u.appendChild(o);n(j,"suggest");if(f.bSetDetail)j.value=B;l.toggle("qun-detail",j.value);j.oninput=function(){c.enableSaveBtn();l.toggle("qun-detail",this.value)}}else if(j=h.getSubIdArr(e),d=null,j.length===0)if(e===10012){j=a.dom.getNode("input",{name:q,type:"text",maxLength:"40",placeholder:"\u4f60\u4eec\u540c\u5728\u54ea\u5bb6\u516c\u53f8\u5de5\u4f5c\uff1f"});
b.limitInputLength(j,40,2);o=a.dom.getNode("div",{"class":"detail-trigger-ctn trigger-ctn-single"});o.appendChild(j);u.appendChild(o);n(j,"suggest");if(f.bSetDetail)j.value=B;l.toggle("qun-detail",B);j.oninput=function(){c.enableSaveBtn();l.toggle("qun-detail",this.value)}}else if(e===10011){d=new i(u,{tabIndex:"1"});d.$popView.innerHTML='<div class="schtype-wrap input-wrap"><input id="schtype-ipt" class="select-ipt" type="text" name="schooltype" placeholder="\u5728\u8bfb\u7c7b\u578b" maxlength="10"></div><div class="schname-wrap input-wrap"><input id="schname-ipt" type="text" name="school" placeholder="\u4f60\u4eec\u540c\u5728\u54ea\u6240\u5b66\u6821\uff1f" maxlength="40" tabIndex="1"/></div>                                                   <div class="second-detail no-college-wrap input-wrap"><input id="college-ipt" type="text" name="institute" placeholder="\u4f60\u4eec\u6240\u5728\u7684\u5b66\u9662\u662f\uff1f" maxlength="40" tabIndex="1"></div>';
var L=a("schtype-ipt"),G=a("college-ipt"),C=a("schname-ipt");b.limitInputLength(G,40,2);b.limitInputLength(C,40,2);n(L,"select");a("schtype-ipt").inputSuggestion.registerAfterOperations(function(b){a("schtype-ipt").setAttribute("aria-label","\u60a8\u5df2\u9009\u62e9"+b);b==="\u535a\u58eb"||b==="\u7855\u58eb"||b==="\u672c\u79d1"||b==="\u5927\u4e13"?(C.setAttribute("name","school"),a.css.removeClass(G.parentNode,"no-college-wrap")):(G.value="",a.css.addClass(G.parentNode,"no-college-wrap"),b==="\u9ad8\u4e2d"||
b==="\u4e2d\u4e13"||b==="\u521d\u4e2d"?C.setAttribute("name","highSchool"):b==="\u5c0f\u5b66"&&C.setAttribute("name","elementarySchool"));this.$ipt.value=b;p()});n(C,"suggest");n(G,"suggest");if(f.bSetDetail){e=t("desc").split(/\||-/);u=e[0]||"";L.value=u;C.value=e[1]||"";if(e[2])G.value=e[2];["\u9ad8\u4e2d","\u4e2d\u4e13","\u521d\u4e2d"].indexOf(u)!==-1?C.setAttribute("name","highSchool"):["\u535a\u58eb","\u7855\u58eb","\u672c\u79d1","\u5927\u4e13"].indexOf(u)!==-1?a.css.removeClass(G.parentNode,
"no-college-wrap"):e[0]==="\u5c0f\u5b66"&&C.setAttribute("name","elementarySchool");p()}}else(h.getItemById(e)||{}).n==="\u5176\u4ed6"?(o=a.dom.getNode("div",{"class":"detail-trigger-ctn trigger-ctn-single"}),j=a.dom.getNode("input",{name:"desc",type:"text",maxLength:"40"}),b.limitInputLength(j,40,2),j.value=f.bSetDetail?B:"",o.appendChild(j),u.appendChild(o),j.oninput=function(){c.enableSaveBtn();l.toggle("qun-detail",this.value)},l.toggle("qun-detail",j.value)):(o=a.dom.getNode("div",{"class":"detail-trigger-ctn"}),
u.appendChild(o),A(),l.toggle("qun-detail",""));else if(j.length>1){B=q=null;j="";o=null;d=new i(u,{tabIndex:"1"});if(e===10013||e===10014||e===10017)j="\u751f\u6d3b\u4f11\u95f2-\u540c\u57ce",e===10014?j="\u751f\u6d3b\u4f11\u95f2-\u540c\u4e61":e===10017&&(j="\u7f6e\u4e1a\u5b89\u5bb6-\u88c5\u4fee"),o=a.dom.getNode("div",{"class":"input-wrap"}),q=a.dom.getNode("input",{"class":"select-ipt",name:"province",data:j,maxLength:"40",type:"text",placeholder:"\u7701/\u76f4\u8f96\u5e02"}),b.limitInputLength(q,
40,2),o.appendChild(q),d.$popView.appendChild(o),v(q),o=a.dom.getNode("div",{"class":"input-wrap"}),B=a.dom.getNode("input",{"class":"select-ipt",name:"city",maxLength:"40",type:"text",placeholder:"\u5e02/\u533a"}),b.limitInputLength(B,40,2),o.appendChild(B),d.$popView.appendChild(o),L=v(B);else if(e===10015&&(j="\u7f6e\u4e1a\u5b89\u5bb6-\u4e1a\u4e3b",o=a.dom.getNode("div",{"class":"input-wrap"}),q=a.dom.getNode("input",{"class":"select-ipt",name:"province",data:j,maxLength:"40",type:"text",placeholder:"\u7701/\u76f4\u8f96\u5e02"}),
b.limitInputLength(q,40,2),o.appendChild(q),d.$popView.appendChild(o),v(q),o=a.dom.getNode("div",{"class":"input-wrap"}),B=a.dom.getNode("input",{"class":"select-ipt",name:"city",maxLength:"40",type:"text",placeholder:"\u5e02/\u533a"}),b.limitInputLength(B,40,2),o.appendChild(B),d.$popView.appendChild(o),L=v(B),g.setValue("provinceIpt",q),g.setValue("cityIpt",B),e=a.dom.getNode("div",{"class":"second-detail input-wrap"}),u=a.dom.getNode("input",{id:"building-ipt",type:"text",maxLength:"40",name:"building",
placeholder:"\u8fdc\u4eb2\u4e0d\u5982\u8fd1\u90bb\uff0c\u4f60\u4eec\u4f4f\u5728\u54ea\u4e2a\u5c0f\u533a\uff1f"}),b.limitInputLength(u,40,2),e.appendChild(u),n(u,"suggest"),d.$popView.appendChild(e),f.bSetDetail))u.value=t("desc");if(f.bSetDetail)e=h.getCatNamePath(t("catId")),q.value=e[2]||"",B.value=e[3]||"",e[2]&&L.refreshData(),p()}if(f.bSetDetail)z(),f.bSetDetail=false},getCatAndDetail:function(){var a=h.getCatNamePath(t("catId")),b={strCat:"",strDetail:""};if(a[0]!==void 0){var c=[];if(a[1]===
void 0){if(h.getSubIdArr(t("catId")).length===0)b.strDetail=t("desc");b.strCat=a[0]}else{var d=h.getSubcatId(t("catId")),c=h.getSubIdArr(d);if(c.length===0){if(d===10011||d===10012||(h.getItemById(d)||{}).n==="\u5176\u4ed6")d=t("desc").split(/[-\|]/),d=d.filter(function(a){if(a)return true}),b.strDetail=d.join("-")}else c=a[2]||"",a[3]&&(c=c+"-"+a[3]),d===10015&&t("desc")&&(c=c+"-"+t("desc")),b.strDetail=c;b.strCat=a[0]+"-"+a[1]}}return b},getModifyField:function(b){var c={};if(w()||b){var b=0,d=
"",d=f&&f.jSubcat&&f.jSubcat.id||0,e=a("qun-detail").querySelectorAll("input");if(d>0){var g=[];h.getSubIdArr(d).length===0?(b=d,d===10011?(g.push(e[0].value),g.push(e[1].value),a.css.hasClass(a("college-ipt").parentNode,"no-college-wrap")||g.push(e[2].value)):(d===10012||(h.getItemById(d)||{}).n==="\u5176\u4ed6")&&g.push(e[0].value)):(b=a.str.trim(e[0].value)+"-"+a.str.trim(e[1].value),b=h.getItemIdByPathStr(d,b),d===10015&&g.push(e[2].value));for(;g.length>0;)if(g.slice(-1)[0])break;else g.pop();
d=g.join("|")}else b=f.jCat.id,d=e[0]?a.str.trim(e[0].value):"";c.classID=b;c["class"]=d}H&&(c["class"]=null);return c},checkModify:w,checkValidation:function(){var a=true;f.jSubcat.id===-1?(f.jSubcat.mark(true),d.showTips("\u8bf7\u586b\u5199\u5b8c\u6574\u7684\u7fa4\u5206\u7c7b"),setTimeout(function(){f.catTrg.show()},0),a=false):f.jSubcat.mark(false);return a},storeDetail:z,disableDetail:A,getDetail:function(){var b="";if(H)b=null;else var b=a.dom.queryClass("detail-trigger","div",a("qun-detail")),
c=a("qun-detail").getElementsByTagName("input"),b=b?b.innerHTML:c.length&&c[0]?c[0].value:"";return b}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/TabIndexSwitcher",["simple"],d):a.TabIndexSwitcher=d()})(this,function(){return{init:function(a){this.arr=a;this.curIndex=-1},change:function(a){if(this.arr[a])this.curIndex!==-1&&this._forEach(this.arr[this.curIndex],function(a){a&&a.removeAttribute("tabIndex")}),this._forEach(this.arr[a],function(a,f){a&&
a.setAttribute("tabIndex",f)}),this.curIndex=a},_forEach:function(a,d){var f,b,c;for(f=0;f<a.length;f++)if(c=eval("("+a[f][0]+")"),this._isType("NodeList")(c)||this._isType("Array")(c))for(b=0;b<c.length;b++)d(c[b],a[f][1]);else d(c,a[f][1])},_isType:function(a){return function(d){return Object.prototype.toString.call(d)==="[object "+a+"]"}}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/common/js/util",[],d):a.Util=d(a.Str)})(this,function(){return function(){var a="",d=
"",f={debugOn:true,isd:function(a){setTimeout(function(){var c=new Image,d="http://isdspeed.qq.com/cgi-bin/r.cgi?flag1=7809&flag2=1&flag3=56&",e;for(e in a||{})d+=e+"="+a[e];c.src=d},2E3)},debug:function(a){if(this.debugOn){var c=document.createElement("p");c.innerHTML="debug: "+a;document.body.insertBefore(c,document.body.childNodes[0])}},hash:{get:function(a){a=top.location.hash.match(RegExp("(#|&)"+a+"=([^&]*)(&|$)"));return!a?"":decodeURIComponent(a[2])},set:function(a){location.hash="#"+a}},
encryptSkey:function(){for(var a=this.cookie.get("skey"),c=5381,d=0,e=a.length;d<e;++d)c+=(c<<5)+a.charAt(d).charCodeAt();return c&2147483647},node:{html:function(a,c){if(c)a.innerHTML=c;else return a.innerHTML}},cookie:{get:function(a){a=document.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)"));return!a?"":decodeURIComponent(a[2])},uin:function(){var a=this.get("uin");return!a?null:parseInt(a.substring(1,a.length),10)}},http:{ajax:function(a,c,d,e,g){var f=new XMLHttpRequest;f.open(e,a,true);f.onreadystatechange=
function(){f.readyState==4&&(f.status>=200&&f.status<300||f.status===304||f.status===1223||f.status===0?typeof g=="undefined"&&f.responseText?d(eval("("+f.responseText+")")):d(f.responseText):d({ec:f.status}),f=null)};f.send(c)},post:function(a,c,d,e){var g="",f;for(f in c)g+="&"+f+"="+c[f];return this.ajax(a,g,d,"POST",e)},get:function(a,c,d,e){var g=[],f;for(f in c)g.push(f+"="+c[f]);a.indexOf("?")==-1&&(a+="?");a+=g.join("&");return this.ajax(a,null,d,"GET",e)}},init:function(){a=this.hash.get("groupuin");
d=this.hash.get("role");return this},getAvatars:function(a,c){var a=true,d=this.hash.get("groupuin");info=null;head_type=2;level=-1;ret=[];key="";r=Math.random();try{info=JSON.parse(top.external.GetGroupBasicInfo(d+""))}catch(e){info={}}info==null&&(info={},Badjs("window.external.GetGroupBasicInfo("+d+")==null, from:Util.js",window.location,0,356050,2));head_type=info.head_type;head_type==2?(ret=["http://p.qlogo.cn/gh/"+d+"/"+d+"/100","http://p.qlogo.cn/gh/"+d+"/"+d+"/40"],this.addRandom(ret,a),c&&
c(ret)):(ret=["http://p.qlogo.cn/gh/"+d+"/"+d+"/100","http://p.qlogo.cn/gh/"+d+"/"+d+"/40"],this.addRandom(ret,a),this.getFace(function(a){a&&ret.unshift(a);c&&c(ret)}));return ret},addRandom:function(a,c){var d=Math.random(),e=false,e=localStorage.getItem("group_avatar_random");c?(localStorage.setItem("group_avatar_random",d),e=true):e?(d=e,e=true):e=false;if(e)for(e=0;e<a.length;e++)a[e]=a[e]+"?r="+d;return a},tryAvatar:function(a,c){var d=this,e=null,f=Array.prototype.slice.call(arguments,1);if(f.length){if(!a.nodeType)e=
a.onload||null,a=a.img;var i={};if(typeof f[0]==="string")i.url=f[0];var l=new Image,n=new Date-0;l.onerror=function(){this.onerror=null;i.onerror&&i.onerror();d.tryAvatar.apply(d,[a].concat(f.slice(1)));LOG({type:"error",msg:"\u7fa4\u5934\u50cf\u52a0\u8f7d\u5931\u8d25\uff01 ",url:location.href,mid:372032})};l.onload=function(){var c=new Date-0-n;c>1E3&&LOG({type:"error",msg:"\u7fa4\u5934\u50cf\u52a0\u8f7d\u8d85\u8fc71s\uff01t= "+c,url:location.href,mid:372033});d.isd({17:c});this.onload=null;i.onload&&
i.onload();a.src=i.url;e&&e(this.width,this.height)};l.src=i.url}},updateAvatar:function(a,c){var d=this;setTimeout(function(){d.getAvatars(c,function(c){c.unshift(a);d.tryAvatar.apply(d,c)})},50)},wrapClientBasicInfoToCGIFormate:function(a){a.gName=Str.encodeHtml(a.name||"");a.gMemNum=a.cur_mem_num||"";a.gMaxMem=a.mem_max||"";var c=(a["class"]||"").split("-")[0]||"",c=c.split(".").join("");a.classInfo=Str.encodeHtml(c||"");return a},isNotGroupMember:function(){return d!=1&&d!=2&&d!=3},getPerfTimeStamp:function(){var a=
{};try{a=JSON.parse(external.CallHummerApi("Default.GetPerfTimeStamp"))}catch(c){a={}}return a},createScript:function(a){var c=document.createElement("script"),d="",e=function(){},f=function(){};typeof a!=="string"?(d=a.src,e=a.onload||e,f=a.onerror||f):d=a;c.async=false;c.src=d;c.onload=e;c.onerror=f;document.head.appendChild(c)},createScripts:function(a){var c=this;a.forEach(function(a){c.createScript(a)})},seq:9999,hasUpdatedFaceCallback:false,updateFaceCallback:function(a){var c=this;if(!this.hasUpdatedFaceCallback){var d=
window.callback;window.callback=function(e){d&&d(e);e.seq==c.seq&&a&&a(e)};this.hasUpdatedFaceCallback=true}},getFace:function(b){var c=new Date-0,d=this;this.updateFaceCallback(function(e){d.isd({18:new Date-0-c});var f="";if(e.ec==0)f=e.grp[a].u;b&&b(f)});this.createScript("http://face.imweb.qq.com/cgi-bin/face?app=group_info&redir=0&seq="+this.seq+"&grp=100|"+a)},getShutTime:function(a){a-=30;return a<3540?Math.ceil(a/60)+"\u5206\u949f":a<82800?Math.ceil(a/3600)+"\u5c0f\u65f6":Math.ceil(a/86400)+
"\u5929"},adjust:function(a,c,d){var e=a.width,f=a.height;e/f>c/d?(a.height=d,a.width=e*(d/f),a.style.marginLeft=-(a.width-c)/2+"px"):(a.width=c,a.height=f*(c/e),a.style.marginTop=-(a.height-d)/2+"px")}};window.CommonUtil=f.init();return f}()});(function(a,d){typeof define==="function"&&define.amd?define("modules/common/js/reportPatchSimple",["simple","bower_components/imweb/report_core","./proj_cfg"],d):a.$=d(a.$,a.report_core,a.proj_cfg)})(this,function(a,d,f){d.config(f.reportCfg);var f=function(c,
b){a.report(c,typeof b!=="undefined"?b:1)},b=new Image,c={appid:1000211,releaseversion:"@RELEASE_VERSION",frequency:1},h=function(){var c=a.cookie.get("uin");return!c?null:parseInt(c.substring(1,c.length),10)},e=function(a,d,e){var f,g=[];if(!c.touin)c.touin=h();c.commandid=a;c.resultcode=d;c.tmcost=e;if(d==0){if(c.frequency=20,Math.floor(Math.random()*100+1)>5)return}else c.frequency=1;for(var w in c)c.hasOwnProperty(w)&&g.push(w+"="+encodeURIComponent(c[w]));f="http://wspeed.qq.com/w.cgi?"+g.join("&");
f=f+"&t="+(new Date).getTime();setTimeout(function(){b.src=f},500)},g=!a,a=a||{};a.report=d;a.monitor=f;a.mmreport=e;if(g)g=this||window,g.IM_report=d,g.IM_monitor=f,g.IM_mmreport=e;return a});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/tags/db_app",["modules/common/js/db"],d):a.DB=d(a.DB)})(this,function(a){a.genSampleAPI("get_group_more_info","qun_info/get_group_more_info");a.genSampleAPI("nicks","qun_info/nicks");return a});(function(a,d){typeof define==="function"&&
define.amd?define("modules/profile/js/tags/tags","../../../common/js/reportPatchSimple,./db_app,../common/util,../common/client,../common/hintState,commonapi".split(","),d):a.Tags=d(a.$,a.DB,a.Util,a.Client,a.HintState,a.CommonApi)})(this,function(a,d,f,b,c,h){var e,g,i,l,n,p,v,w,z;function A(){a("ui-tags").children.length<=0?a.css.addClass(a("marked-tags"),"qun-tags-empty"):a.css.removeClass(a("marked-tags"),"qun-tags-empty")}function F(){function c(h,i){C||(a.str.byteLen(h,3)>e?b.showTips("\u7fa4\u6807\u7b7e\u6700\u591a"+
e/3+"\u4e2a\u6c49\u5b57"):q.qunTags[h]===1?b.showTips("\u7fa4\u5df2\u7ecf\u88ab\u8d34\u4e0a\u4e86\u8be5\u7fa4\u6807\u7b7e"):b.callClientAPI("IsSelfOnline")?(C=true,d.set_group_more_info({param:{gc:g,tag:h},succ:function(c){w++;C=false;var b=a.dom.getNode("a",{"class":"tag-wrap can-delete js-tag",tid:c.sTid,uin:q.uin,title:(q.nick||"\u81ea\u5df1")+"\uff08"+q.uin+"\uff09\u5f20\u8d34",href:"#",hideFocus:"true","aria-label":"del\u952e\u5220\u9664"}),d=a.dom.getNode("span",{"class":"tag"});d.innerHTML=
a.str.encodeHtml(h);var e=a.dom.getNode("em",{title:"\u5220\u9664"});b.appendChild(d);b.appendChild(e);f.appendChild(b);a.array.forEach(f.children,function(a){a.setAttribute("tabindex","-1")});b.setAttribute("tabindex","2");q.qunTags[h]=1;i?D("TAGS_ADD_HOT_TAG_SUCC"):(a("ui-ipt-addTag").value="",D("TAGS_ADD_USR_TAG_SUCC"));b=(a.dom.queryClassAll("js-tag","a",a("ui-tags"))||[]).length;a.oop.notifyObservers(u,"onTagChange",{action:"add",tagText:h,tagID:c.sTid,total:b});A();var g=document.activeElement;
g.blur();setTimeout(function(){g.focus()},100)},err:function(a){C=false;var c=1;switch(a.ec){case 14:a="\u7fa4\u6807\u7b7e\u4e2d\u5305\u542b\u654f\u611f\u8bcd";c=2;D("TAGS_SENSITIVE");break;case 15:a="\u7528\u623724\u5c0f\u65f6\u5185\u53ea\u80fd\u8d345\u6b21";D("TAGS_FREQ_24H");break;case 16:a="\u7fa4\u6807\u7b7e\u6570\u76ee\u5df2\u8fbe\u5230\u4e0a\u9650";break;case 9999:a="\u64cd\u4f5c\u8d85\u65f6\u4e86";break;default:a="\u8d34\u7fa4\u6807\u7b7e\u51fa\u9519\u4e86"}b.showTips(a,c)}})):b.showTips("\u60a8\u5df2\u7ecf\u5904\u4e8e\u79bb\u7ebf\u72b6\u6001\uff0c\u8bf7\u4e0a\u7ebf\u540e\u518d\u6b21\u5c1d\u8bd5"))}
var f=a("ui-tags"),G=i;G.length>0&&a.insertTags(f,G,l);A();f.firstElementChild&&f.firstElementChild.setAttribute("tabindex","2");var C=false;a.e.add(a("ui-addTag"),"click",p=function(){if(w>20)h.alert(1,"\u6e29\u99a8\u63d0\u793a","\u7fa4\u6807\u7b7e\u6570\u76ee\u5df2\u8d85\u8fc720\u4e2a\u4e0a\u9650\uff0c\u5efa\u8bae\u60a8\u7cbe\u7b80\u7fa4\u6807\u7b7e\uff0c\u65b9\u4fbf\u5927\u5bb6\u4e86\u89e3\u60a8\u7684\u7fa4");else if(w==20)h.alert(1,"\u6e29\u99a8\u63d0\u793a","\u7fa4\u6807\u7b7e\u6570\u76ee\u5df2\u8fbe\u4e0a\u9650");
else{var b=a.str.trim(a("ui-ipt-addTag").value);b.length>0&&c(b)}});var M=false;a.e.add(f,"click",v=function(c){var e=c.target;if(e.tagName.toLowerCase()==="em"&&!M)if(b.callClientAPI("IsSelfOnline")){var f=e.parentNode,h=f.firstChild.textContent,i=f.getAttribute("tid");M=true;d.set_group_more_info({param:{gc:g,tagID:i},succ:function(){w--;M=false;var c=a.dom.getNode("a",{href:"javascript:;","class":"temp-tag element-invisible tag-wrap","aria-label":"\u5df2\u5220\u9664",tabindex:"2"});c.innerHTML=
f.innerHTML;f.parentNode.insertBefore(c,f);c.focus();j();a.dom.remove(f);delete q.qunTags[h];c=(a.dom.queryClassAll("js-tag","a",a("ui-tags"))||[]).length;a.oop.notifyObservers(u,"onTagChange",{action:"del",tagID:i,total:c});A();D("TAGS_DELETE_SUCC")},err:function(a){M=false;switch(a.ec){case 17:a="\u60a8\u6ca1\u6709\u6743\u9650\u5220\u9664\u7fa4\u6807\u7b7e";break;case 19:a="\u8be5\u7fa4\u6807\u7b7e\u5df2\u88ab\u5220\u9664\u6216\u4e0d\u5b58\u5728";break;case 9999:a="\u64cd\u4f5c\u8d85\u65f6\u4e86";
break;default:a="\u5220\u9664\u7fa4\u6807\u7b7e\u51fa\u9519\u4e86"}b.showTips(a)}})}else b.showTips("\u60a8\u5df2\u7ecf\u5904\u4e8e\u79bb\u7ebf\u72b6\u6001\uff0c\u8bf7\u4e0a\u7ebf\u540e\u518d\u6b21\u5c1d\u8bd5");c.preventDefault()})}function H(){if(q.hasPermission("addTag"))a("editTags-panel").style.display="block",F();else{var c=i;c.length<=0?a.css.addClass(a("viewTags"),"tags-empty"):(a.insertTags(a("viewTags"),c,n),a("viewTags").firstElementChild.setAttribute("tabindex","2"));a("viewTags-panel").style.display=
"block"}c=q.getRoleType()===z;D("TAGS_INITPAGE1",{v:c?1:0});D("TAGS_INITPAGE2")}function t(a,c){d.nicks({type:"GET",param:{u:a.join("-")},succ:function(a){for(var a=a.ns||[],b={},d=0;d<a.length;d++){var e=String(a[d].u),f=a[d].n;b[e]=f;if(e===q.uin)q.nick=f}c(b)},err:function(){c()}})}var K=function(){var c=b.getClientVersion();return function(b){var d={flag1:g,ver:c};if(typeof b==="object"&&!("v"in b)&&"aId"in b)b=a.bom.getHash("from"),d.v=b&&b==="create"?1:0;return d}}(),D=a.report.ReportFactory({config:{TAGS_FREQ_24H:242625},
getDefaultOptFn:K}),u={};z="visitor";w=0;p=void 0;v=void 0;var q=function(){var c={},b={visitor:[],member:[],admin:["addTag","delTag"]};c.hasPermission=function(c){return a.array.indexOf(b[this.role],c)!==-1?true:false};c.setRole=function(a){c.role=a===1?"member":a>1?"admin":"visitor"};c.getRoleType=function(){return this.role};c.uin=a.cookie.uin();c.qunTags={};return c}();n=0;l=2;g=void 0;i=void 0;g=parseInt(a.bom.getHash("groupuin"),10);a.convertHSLtoRGB=function(a,c,b){a/=360;if(b===0)c=b=a=0;
else if(c===0)c=b=a=b;else{var c=b<=0.5?b*(1+c):b+c-b*c,b=2*b-c,d=[];d.push(a+1/3);d.push(a);d.push(a-1/3);a=[];a.push(0);a.push(0);a.push(0);for(var e=0;e<3;e++)d[e]<0&&(d[e]+=1),d[e]>1&&(d[e]-=1),a[e]=6*d[e]<1?b+(c-b)*d[e]*6:2*d[e]<1?c:3*d[e]<2?b+(c-b)*(2/3-d[e])*6:b;c=parseInt(a[0]*255,10).toString(16);b=parseInt(a[1]*255,10).toString(16);a=parseInt(a[2]*255,10).toString(16);c.length===1&&(c="0"+c);b.length===1&&(b="0"+b);a.length===1&&(a="0"+a)}return"#"+c+b+a};e=24;a.insertTags=function(c,b,
d){var e=[],g,h,i=0,j=b.length;if(d===1){b=f.genRandomArray(b);for(i=0;i<j;i++)e.push(a.insertTags.tmpl(d,{title:b[i]}))}else if(d===n)for(i=0;i<j;i++)g=Math.random()*360,h=a.convertHSLtoRGB(g,0.5,0.89),g=a.convertHSLtoRGB(g,0.7,0.6),e.push(a.insertTags.tmpl(d,{title:b[i],bdColor:g,bgColor:h}));else if(d===l)for(i=0;i<j;i++)e.push(a.insertTags.tmpl(d,b[i]));c.innerHTML=e.join("")};a.insertTags.tmpl=function(a,c){if(a===n)return f.tmpl('<span class="tag tag-wrap" style="background-color:<%=bgColor%>;border:1px solid <%=bdColor%>;" tabindex="-1"><%=title%></span>',
c);else if(a===1)return f.tmpl('<a class="tag-wrap js-tag" href="javascript:void(0)" tabindex="-1"><span class="tag"><%=title%></span></a>',c);else if(a===l){var b="",d="";q.hasPermission("delTag")?(b=" can-delete",d=' aria-label="del\u952e\u5220\u9664"'):(b="<%=uin==$.cookie.uin()?' can-delete':''%>",d="<%=uin==$.cookie.uin()?' aria-label=\"del\u952e\u5220\u9664\"':''%>");return f.tmpl('<a hideFocus="true" class="tag-wrap js-tag'+b+'" tid="<%=tid%>" title="<%=nick%>\uff08<%=uin%>\uff09\u5f20\u8d34" uin="<%=uin%>" href="javascript:void(0)"'+
d+' tabindex="-1"><span class="tag"><%=tname%></span><em title="\u5220\u9664"></em></a>',c)}};var j=function(){var c=null;return function(){var b=document.activeElement;if(c!==b){if(c&&(c&&a.css.removeClass(c,"hover"),a.css.hasClass(c,"temp-tag"))){var d=c;d.nextSibling?d.nextSibling.setAttribute("tabindex","2"):d.parentNode.firstElementChild&&d.parentNode.firstElementChild.setAttribute("tabindex","2");a.dom.remove(c)}a.css.addClass(b,"hover");c=b}}}(),o={keyup:function(c){var b=document.activeElement,
d;c.keyCode===46?a.css.hasClass(b,"can-delete")&&a.e.trigger(b.lastChild,"click"):c.keyCode>=37&&c.keyCode<=40?a.css.hasClass(b,"tag-wrap")&&(d=c.keyCode===38||c.keyCode===37?"up":"down",c=b[d==="up"?"previousElementSibling":"nextElementSibling"],!c&&(c=b.parentNode[d==="up"?"lastElementChild":"firstElementChild"]),c.setAttribute("tabindex","2"),c&&c.focus(),b.setAttribute("tabindex","-1")):c.keyCode===9&&a.css.hasClass(b,"tag-wrap")&&j();j()},keydown:function(c){var b=document.activeElement;c.keyCode===
13&&(b.id==="ui-ipt-addTag"?a.e.trigger(a("ui-addTag"),"click"):a.css.hasClass(b,"tag-wrap")&&b.parentNode.id==="ui-hotTags"&&a.e.trigger(b.firstElementChild,"click"))},click:function(){j()}};u.init=function(b,d){a.e.add(document,"keyup",o.keyup);a.e.add(document,"keydown",o.keydown);a.e.add(document,"click",o.click);var e=parseInt(a.bom.getHash("groupuin"),10);if(isNaN(e))a.oop.notifyObservers(u,"getTagsFailed");else{g=e;q.setRole(d.flag);var f={};a.oop.extend(f,d.ns||{});var e=[],h=0,l=d.tags||
[],j=[],n=null;if(q.hasPermission("addTag")){for(;h<l.length;h++){var n=l[h],p=String(n.u);f[p]||e.push(p);j.push({uin:p,tname:n.tag,tid:n.sTid,nick:f[p]});q.qunTags[a.str.decodeHtml(n.tag)]=1}c.toggle("qun-tag",l.length)}else for(h=0;h<l.length;h++)j.push(l[h].tag);i=j;w=l.length;H();n=j=l=null;q.hasPermission("addTag")&&(e.push(q.uin),t(e,function(c){c&&a.oop.extend(f,c);for(var c=a.dom.queryClassAll("tag-wrap","a","ui-tags"),b=0;b<c.length;b++){var d=c[b].getAttribute("uin");c[b].setAttribute("title",
a.str.decodeHtml(f[d])+"\uff08"+d+"\uff09\u5f20\u8d34")}}))}D("TAGS_PV")};u.destroy=function(){a.e.remove(document,"keyup",o.keyup);a.e.remove(document,"keydown",o.keydown);a.e.remove(document,"click",o.click);var c=a("ui-tags");a.e.remove(a("ui-addTag"),"click",p);a.e.remove(c,"click",v)};return u});(function(a,d){typeof define==="function"&&define.amd?define("xss",d):a.XSS=d()})(this,function(){function a(a,c,b){if(h.test(c))return"";var d=(a=z[a][c])&&a.regexp,f=a&&a["default"];if(c==="href"||
c==="src"){e.lastIndex=0;if(e.test(b))return f||"#";g.lastIndex=0;if(g.test(b))return f||"#";p.lastIndex=0;if(!p.test(b))return f||"#";return d&&(d.lastIndex=0,!d.test(b))?f||"#":b}else if(a||A[c]){i.lastIndex=0;if(i.test(b))return f||"";l.lastIndex=0;if(l.test(b))return f||"";return c==="style"&&(n.lastIndex=0,n.test(b))?f||"":b}return""}var d=/</g,f=/>/g,b=/<(\/)*([a-zA-Z0-9_:\.\-]+)([^>a-zA-Z0-9_:\.\-]+[^>]*)*>/ig,c=/[^>a-zA-Z0-9_:\.\-]*([a-zA-Z0-9_:\.\-]+)=[\"\']?([^\"\'\s>]*)[\"\']?/ig,h=/[^>a-zA-Z0-9_:\.\-]/ig,
e=/\/\*|\*\//mg,g=/^[\s"'`]*((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/ig,i=/\/\*|\*\//mg,l=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/ig,n=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n/ig,p=RegExp("((news|telnet|nttp|file|http|ftp|https)://){1}(([-A-Za-z0-9]+(\\.[-A-Za-z0-9]+)*(\\.[-A-Za-z]{2,5}))|([0-9]{1,3}(\\.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_\\$\\.\\+\\!\\*\\(\\),;:@&=\\?/~\\#\\%]*)*","gi"),v=RegExp("(?:[^\\'\\\"]|^|s+)((((news|telnet|nttp|file|http|ftp|https)://)|(www\\.))(([-A-Za-z0-9]+(\\.[-A-Za-z0-9]+)*(\\.[-A-Za-z]{2,5}))|([0-9]{1,3}(\\.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_\\$\\.\\+\\!\\*\\(\\),;:@&=\\?/~\\#\\%]*)*)(?![^<]*</a>)",
"gi"),w=/^\s|\s$/ig,z={h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},hr:{},span:{},strong:{},b:{},i:{},br:{},p:{},pre:{},code:{},a:{target:{"default":"_blank"},href:true,title:true},img:{src:true,alt:true,title:true,rel:true},div:{},table:{border:true},tr:{rowspan:true},td:{colspan:true},th:{colspan:true},tbody:{},thead:{},ul:{},li:{},ol:{},dl:{},dt:{},em:{},cite:{},section:{},header:{},footer:{},blockquote:{},audio:{autoplay:true,controls:true,loop:true,preload:true,src:true},video:{autoplay:true,controls:true,
loop:true,preload:true,src:true}},A={width:true,height:true,style:true},F=function(a){if(!a)return true;for(var c in a)return false;return true};return{filter:function(e,g){var h={},i=0,l={};b.lastIndex=0;e=e.replace(b,function(b,d,e,f){var g=e||"";g=g.toLowerCase();_defaultWhiteList=z[g];if(!g||!_defaultWhiteList)return b||"";if(d)return l[g]&&l[g].length?(l[g].pop(),l[g].length||delete l[g],h[i]="</"+e+">","{%DataIndex_"+i++ +"%}"):"</"+e+">";else{d=(f||"").replace(w,"");(d==="/"||!d)&&F(_defaultWhiteList);
if(d)if(c.lastIndex=0,c.test(d)){c.lastIndex=0;var j=[];d.replace(c,function(c,b,d){c=b.toLowerCase();d=a(g,c,d);j.push(d?" "+c+'="'+d+'"':"")});d=j.join("")}else d="";if((d==="/"||!d)&&!F(_defaultWhiteList))return b||"";l[g]||(l[g]=[]);l[g].push(g);h[i]="<"+g+(d?" "+d:"")+">";return"{%DataIndex_"+i++ +"%}"}});g||(e=e.replace(d,"&lt;").replace(f,"&gt;"));var e=e.replace(/\{\%DataIndex_(\d+)\%\}/ig,function(a,c){return h[c]||""}).replace(v,function(a,c){var b="";a+="";a.length==c.length+1&&(b=a[0],
a=c);var d="",d=a.indexOf("://")==-1?"http://"+a:a;return b+'<a href="'+d+'" target="_blank">'+a+"</a>"}),n=[],j;for(j in l)if(!(j==="img"||j==="br"||j==="p"||j==="hr")){var o;if(o=l[j].length)for(var p=0;p<o;p++)n.push("</"+j+">")}n.length&&(e+=n,join(""));return e}}});(function(a,d){typeof define==="function"&&define.amd?define("emojiface",[],d):a.emojiface=d()})(this,function(){var a="0x00A9,0x00AE,0x203C,0x2049,0x2122,0x2139,0x2194,0x2195,0x2196,0x2197,0x2198,0x2199,0x21A9,0x21AA,0x231A,0x231B,0x23E9,0x23EA,0x23EB,0x23EC,0x23F0,0x23F3,0x24C2,0x25AA,0x25AB,0x25B6,0x25C0,0x25FB,0x25FC,0x25FD,0x25FE,0x2600,0x2601,0x260E,0x2611,0x2614,0x2615,0x261D,0x263A,0x2648,0x2649,0x264A,0x264B,0x264C,0x264D,0x264E,0x264F,0x2650,0x2651,0x2652,0x2653,0x2660,0x2663,0x2665,0x2666,0x2668,0x267B,0x267F,0x2693,0x26A0,0x26A1,0x26AA,0x26AB,0x26BD,0x26BE,0x26C4,0x26C5,0x26CE,0x26D4,0x26EA,0x26F2,0x26F3,0x26F5,0x26FA,0x26FD,0x2702,0x2705,0x2708,0x2709,0x270A,0x270B,0x270C,0x270F,0x2712,0x2714,0x2716,0x2728,0x2733,0x2734,0x2744,0x2747,0x274C,0x274E,0x2753,0x2754,0x2755,0x2757,0x2764,0x2795,0x2796,0x2797,0x27A1,0x27B0,0x27BF,0x2934,0x2935,0x2B05,0x2B06,0x2B07,0x2B1B,0x2B1C,0x2B50,0x2B55,0x3030,0x303D,0x3297,0x3299,0xD83C0xDC04,0xD83C0xDCCF,0xD83C0xDD70,0xD83C0xDD71,0xD83C0xDD7E,0xD83C0xDD7F,0xD83C0xDD8E,0xD83C0xDD91,0xD83C0xDD92,0xD83C0xDD93,0xD83C0xDD94,0xD83C0xDD95,0xD83C0xDD96,0xD83C0xDD97,0xD83C0xDD98,0xD83C0xDD99,0xD83C0xDD9A,0xD83C0xDE01,0xD83C0xDE02,0xD83C0xDE1A,0xD83C0xDE2F,0xD83C0xDE32,0xD83C0xDE33,0xD83C0xDE34,0xD83C0xDE35,0xD83C0xDE36,0xD83C0xDE37,0xD83C0xDE38,0xD83C0xDE39,0xD83C0xDE3A,0xD83C0xDE50,0xD83C0xDE51,0xD83C0xDF00,0xD83C0xDF01,0xD83C0xDF02,0xD83C0xDF03,0xD83C0xDF04,0xD83C0xDF05,0xD83C0xDF06,0xD83C0xDF07,0xD83C0xDF08,0xD83C0xDF09,0xD83C0xDF0A,0xD83C0xDF0B,0xD83C0xDF0C,0xD83C0xDF0D,0xD83C0xDF0E,0xD83C0xDF0F,0xD83C0xDF10,0xD83C0xDF11,0xD83C0xDF12,0xD83C0xDF13,0xD83C0xDF14,0xD83C0xDF15,0xD83C0xDF16,0xD83C0xDF17,0xD83C0xDF18,0xD83C0xDF19,0xD83C0xDF1A,0xD83C0xDF1B,0xD83C0xDF1C,0xD83C0xDF1D,0xD83C0xDF1E,0xD83C0xDF1F,0xD83C0xDF30,0xD83C0xDF31,0xD83C0xDF32,0xD83C0xDF33,0xD83C0xDF34,0xD83C0xDF35,0xD83C0xDF37,0xD83C0xDF38,0xD83C0xDF39,0xD83C0xDF3A,0xD83C0xDF3B,0xD83C0xDF3C,0xD83C0xDF3D,0xD83C0xDF3E,0xD83C0xDF3F,0xD83C0xDF40,0xD83C0xDF41,0xD83C0xDF42,0xD83C0xDF43,0xD83C0xDF44,0xD83C0xDF45,0xD83C0xDF46,0xD83C0xDF47,0xD83C0xDF48,0xD83C0xDF49,0xD83C0xDF4A,0xD83C0xDF4B,0xD83C0xDF4C,0xD83C0xDF4D,0xD83C0xDF4E,0xD83C0xDF4F,0xD83C0xDF50,0xD83C0xDF51,0xD83C0xDF52,0xD83C0xDF53,0xD83C0xDF54,0xD83C0xDF55,0xD83C0xDF56,0xD83C0xDF57,0xD83C0xDF58,0xD83C0xDF59,0xD83C0xDF5A,0xD83C0xDF5B,0xD83C0xDF5C,0xD83C0xDF5D,0xD83C0xDF5E,0xD83C0xDF5F,0xD83C0xDF60,0xD83C0xDF61,0xD83C0xDF62,0xD83C0xDF63,0xD83C0xDF64,0xD83C0xDF65,0xD83C0xDF66,0xD83C0xDF67,0xD83C0xDF68,0xD83C0xDF69,0xD83C0xDF6A,0xD83C0xDF6B,0xD83C0xDF6C,0xD83C0xDF6D,0xD83C0xDF6E,0xD83C0xDF6F,0xD83C0xDF70,0xD83C0xDF71,0xD83C0xDF72,0xD83C0xDF73,0xD83C0xDF74,0xD83C0xDF75,0xD83C0xDF76,0xD83C0xDF77,0xD83C0xDF78,0xD83C0xDF79,0xD83C0xDF7A,0xD83C0xDF7B,0xD83C0xDF7C,0xD83C0xDF80,0xD83C0xDF81,0xD83C0xDF82,0xD83C0xDF83,0xD83C0xDF84,0xD83C0xDF85,0xD83C0xDF86,0xD83C0xDF87,0xD83C0xDF88,0xD83C0xDF89,0xD83C0xDF8A,0xD83C0xDF8B,0xD83C0xDF8C,0xD83C0xDF8D,0xD83C0xDF8E,0xD83C0xDF8F,0xD83C0xDF90,0xD83C0xDF91,0xD83C0xDF92,0xD83C0xDF93,0xD83C0xDFA0,0xD83C0xDFA1,0xD83C0xDFA2,0xD83C0xDFA3,0xD83C0xDFA4,0xD83C0xDFA5,0xD83C0xDFA6,0xD83C0xDFA7,0xD83C0xDFA8,0xD83C0xDFA9,0xD83C0xDFAA,0xD83C0xDFAB,0xD83C0xDFAC,0xD83C0xDFAD,0xD83C0xDFAE,0xD83C0xDFAF,0xD83C0xDFB0,0xD83C0xDFB1,0xD83C0xDFB2,0xD83C0xDFB3,0xD83C0xDFB4,0xD83C0xDFB5,0xD83C0xDFB6,0xD83C0xDFB7,0xD83C0xDFB8,0xD83C0xDFB9,0xD83C0xDFBA,0xD83C0xDFBB,0xD83C0xDFBC,0xD83C0xDFBD,0xD83C0xDFBE,0xD83C0xDFBF,0xD83C0xDFC0,0xD83C0xDFC1,0xD83C0xDFC2,0xD83C0xDFC3,0xD83C0xDFC4,0xD83C0xDFC6,0xD83C0xDFC7,0xD83C0xDFC8,0xD83C0xDFC9,0xD83C0xDFCA,0xD83C0xDFE0,0xD83C0xDFE1,0xD83C0xDFE2,0xD83C0xDFE3,0xD83C0xDFE4,0xD83C0xDFE5,0xD83C0xDFE6,0xD83C0xDFE7,0xD83C0xDFE8,0xD83C0xDFE9,0xD83C0xDFEA,0xD83C0xDFEB,0xD83C0xDFEC,0xD83C0xDFED,0xD83C0xDFEE,0xD83C0xDFEF,0xD83C0xDFF0,0xD83D0xDC00,0xD83D0xDC01,0xD83D0xDC02,0xD83D0xDC03,0xD83D0xDC04,0xD83D0xDC05,0xD83D0xDC06,0xD83D0xDC07,0xD83D0xDC08,0xD83D0xDC09,0xD83D0xDC0A,0xD83D0xDC0B,0xD83D0xDC0C,0xD83D0xDC0D,0xD83D0xDC0E,0xD83D0xDC0F,0xD83D0xDC10,0xD83D0xDC11,0xD83D0xDC12,0xD83D0xDC13,0xD83D0xDC14,0xD83D0xDC15,0xD83D0xDC16,0xD83D0xDC17,0xD83D0xDC18,0xD83D0xDC19,0xD83D0xDC1A,0xD83D0xDC1B,0xD83D0xDC1C,0xD83D0xDC1D,0xD83D0xDC1E,0xD83D0xDC1F,0xD83D0xDC20,0xD83D0xDC21,0xD83D0xDC22,0xD83D0xDC23,0xD83D0xDC24,0xD83D0xDC25,0xD83D0xDC26,0xD83D0xDC27,0xD83D0xDC28,0xD83D0xDC29,0xD83D0xDC2A,0xD83D0xDC2B,0xD83D0xDC2C,0xD83D0xDC2D,0xD83D0xDC2E,0xD83D0xDC2F,0xD83D0xDC30,0xD83D0xDC31,0xD83D0xDC32,0xD83D0xDC33,0xD83D0xDC34,0xD83D0xDC35,0xD83D0xDC36,0xD83D0xDC37,0xD83D0xDC38,0xD83D0xDC39,0xD83D0xDC3A,0xD83D0xDC3B,0xD83D0xDC3C,0xD83D0xDC3D,0xD83D0xDC3E,0xD83D0xDC40,0xD83D0xDC42,0xD83D0xDC43,0xD83D0xDC44,0xD83D0xDC45,0xD83D0xDC46,0xD83D0xDC47,0xD83D0xDC48,0xD83D0xDC49,0xD83D0xDC4A,0xD83D0xDC4B,0xD83D0xDC4C,0xD83D0xDC4D,0xD83D0xDC4E,0xD83D0xDC4F,0xD83D0xDC50,0xD83D0xDC51,0xD83D0xDC52,0xD83D0xDC53,0xD83D0xDC54,0xD83D0xDC55,0xD83D0xDC56,0xD83D0xDC57,0xD83D0xDC58,0xD83D0xDC59,0xD83D0xDC5A,0xD83D0xDC5B,0xD83D0xDC5C,0xD83D0xDC5D,0xD83D0xDC5E,0xD83D0xDC5F,0xD83D0xDC60,0xD83D0xDC61,0xD83D0xDC62,0xD83D0xDC63,0xD83D0xDC64,0xD83D0xDC65,0xD83D0xDC66,0xD83D0xDC67,0xD83D0xDC68,0xD83D0xDC69,0xD83D0xDC6A,0xD83D0xDC6B,0xD83D0xDC6C,0xD83D0xDC6D,0xD83D0xDC6E,0xD83D0xDC6F,0xD83D0xDC70,0xD83D0xDC71,0xD83D0xDC72,0xD83D0xDC73,0xD83D0xDC74,0xD83D0xDC75,0xD83D0xDC76,0xD83D0xDC77,0xD83D0xDC78,0xD83D0xDC79,0xD83D0xDC7A,0xD83D0xDC7B,0xD83D0xDC7C,0xD83D0xDC7D,0xD83D0xDC7E,0xD83D0xDC7F,0xD83D0xDC80,0xD83D0xDC81,0xD83D0xDC82,0xD83D0xDC83,0xD83D0xDC84,0xD83D0xDC85,0xD83D0xDC86,0xD83D0xDC87,0xD83D0xDC88,0xD83D0xDC89,0xD83D0xDC8A,0xD83D0xDC8B,0xD83D0xDC8C,0xD83D0xDC8D,0xD83D0xDC8E,0xD83D0xDC8F,0xD83D0xDC90,0xD83D0xDC91,0xD83D0xDC92,0xD83D0xDC93,0xD83D0xDC94,0xD83D0xDC95,0xD83D0xDC96,0xD83D0xDC97,0xD83D0xDC98,0xD83D0xDC99,0xD83D0xDC9A,0xD83D0xDC9B,0xD83D0xDC9C,0xD83D0xDC9D,0xD83D0xDC9E,0xD83D0xDC9F,0xD83D0xDCA0,0xD83D0xDCA1,0xD83D0xDCA2,0xD83D0xDCA3,0xD83D0xDCA4,0xD83D0xDCA5,0xD83D0xDCA6,0xD83D0xDCA7,0xD83D0xDCA8,0xD83D0xDCA9,0xD83D0xDCAA,0xD83D0xDCAB,0xD83D0xDCAC,0xD83D0xDCAD,0xD83D0xDCAE,0xD83D0xDCAF,0xD83D0xDCB0,0xD83D0xDCB1,0xD83D0xDCB2,0xD83D0xDCB3,0xD83D0xDCB4,0xD83D0xDCB5,0xD83D0xDCB6,0xD83D0xDCB7,0xD83D0xDCB8,0xD83D0xDCB9,0xD83D0xDCBA,0xD83D0xDCBB,0xD83D0xDCBC,0xD83D0xDCBD,0xD83D0xDCBE,0xD83D0xDCBF,0xD83D0xDCC0,0xD83D0xDCC1,0xD83D0xDCC2,0xD83D0xDCC3,0xD83D0xDCC4,0xD83D0xDCC5,0xD83D0xDCC6,0xD83D0xDCC7,0xD83D0xDCC8,0xD83D0xDCC9,0xD83D0xDCCA,0xD83D0xDCCB,0xD83D0xDCCC,0xD83D0xDCCD,0xD83D0xDCCE,0xD83D0xDCCF,0xD83D0xDCD0,0xD83D0xDCD1,0xD83D0xDCD2,0xD83D0xDCD3,0xD83D0xDCD4,0xD83D0xDCD5,0xD83D0xDCD6,0xD83D0xDCD7,0xD83D0xDCD8,0xD83D0xDCD9,0xD83D0xDCDA,0xD83D0xDCDB,0xD83D0xDCDC,0xD83D0xDCDD,0xD83D0xDCDE,0xD83D0xDCDF,0xD83D0xDCE0,0xD83D0xDCE1,0xD83D0xDCE2,0xD83D0xDCE3,0xD83D0xDCE4,0xD83D0xDCE5,0xD83D0xDCE6,0xD83D0xDCE7,0xD83D0xDCE8,0xD83D0xDCE9,0xD83D0xDCEA,0xD83D0xDCEB,0xD83D0xDCEC,0xD83D0xDCED,0xD83D0xDCEE,0xD83D0xDCEF,0xD83D0xDCF0,0xD83D0xDCF1,0xD83D0xDCF2,0xD83D0xDCF3,0xD83D0xDCF4,0xD83D0xDCF5,0xD83D0xDCF6,0xD83D0xDCF7,0xD83D0xDCF9,0xD83D0xDCFA,0xD83D0xDCFB,0xD83D0xDCFC,0xD83D0xDD00,0xD83D0xDD01,0xD83D0xDD02,0xD83D0xDD03,0xD83D0xDD04,0xD83D0xDD05,0xD83D0xDD06,0xD83D0xDD07,0xD83D0xDD09,0xD83D0xDD0A,0xD83D0xDD0B,0xD83D0xDD0C,0xD83D0xDD0D,0xD83D0xDD0E,0xD83D0xDD0F,0xD83D0xDD10,0xD83D0xDD11,0xD83D0xDD12,0xD83D0xDD13,0xD83D0xDD14,0xD83D0xDD15,0xD83D0xDD16,0xD83D0xDD17,0xD83D0xDD18,0xD83D0xDD19,0xD83D0xDD1A,0xD83D0xDD1B,0xD83D0xDD1C,0xD83D0xDD1D,0xD83D0xDD1E,0xD83D0xDD1F,0xD83D0xDD20,0xD83D0xDD21,0xD83D0xDD22,0xD83D0xDD23,0xD83D0xDD24,0xD83D0xDD25,0xD83D0xDD26,0xD83D0xDD27,0xD83D0xDD28,0xD83D0xDD29,0xD83D0xDD2A,0xD83D0xDD2B,0xD83D0xDD2C,0xD83D0xDD2D,0xD83D0xDD2E,0xD83D0xDD2F,0xD83D0xDD30,0xD83D0xDD31,0xD83D0xDD32,0xD83D0xDD33,0xD83D0xDD34,0xD83D0xDD35,0xD83D0xDD36,0xD83D0xDD37,0xD83D0xDD38,0xD83D0xDD39,0xD83D0xDD3A,0xD83D0xDD3B,0xD83D0xDD3C,0xD83D0xDD3D,0xD83D0xDD50,0xD83D0xDD51,0xD83D0xDD52,0xD83D0xDD53,0xD83D0xDD54,0xD83D0xDD55,0xD83D0xDD56,0xD83D0xDD57,0xD83D0xDD58,0xD83D0xDD59,0xD83D0xDD5A,0xD83D0xDD5B,0xD83D0xDD5C,0xD83D0xDD5D,0xD83D0xDD5E,0xD83D0xDD5F,0xD83D0xDD60,0xD83D0xDD61,0xD83D0xDD62,0xD83D0xDD63,0xD83D0xDD64,0xD83D0xDD65,0xD83D0xDD66,0xD83D0xDD67,0xD83D0xDDFB,0xD83D0xDDFC,0xD83D0xDDFD,0xD83D0xDDFE,0xD83D0xDDFF,0xD83D0xDE00,0xD83D0xDE01,0xD83D0xDE02,0xD83D0xDE03,0xD83D0xDE04,0xD83D0xDE05,0xD83D0xDE06,0xD83D0xDE07,0xD83D0xDE08,0xD83D0xDE09,0xD83D0xDE0A,0xD83D0xDE0B,0xD83D0xDE0C,0xD83D0xDE0D,0xD83D0xDE0E,0xD83D0xDE0F,0xD83D0xDE10,0xD83D0xDE11,0xD83D0xDE12,0xD83D0xDE13,0xD83D0xDE14,0xD83D0xDE15,0xD83D0xDE16,0xD83D0xDE17,0xD83D0xDE18,0xD83D0xDE19,0xD83D0xDE1A,0xD83D0xDE1B,0xD83D0xDE1C,0xD83D0xDE1D,0xD83D0xDE1E,0xD83D0xDE1F,0xD83D0xDE20,0xD83D0xDE21,0xD83D0xDE22,0xD83D0xDE23,0xD83D0xDE24,0xD83D0xDE25,0xD83D0xDE26,0xD83D0xDE27,0xD83D0xDE28,0xD83D0xDE29,0xD83D0xDE2A,0xD83D0xDE2B,0xD83D0xDE2C,0xD83D0xDE2D,0xD83D0xDE2E,0xD83D0xDE2F,0xD83D0xDE30,0xD83D0xDE31,0xD83D0xDE32,0xD83D0xDE33,0xD83D0xDE34,0xD83D0xDE35,0xD83D0xDE36,0xD83D0xDE37,0xD83D0xDE38,0xD83D0xDE39,0xD83D0xDE3A,0xD83D0xDE3B,0xD83D0xDE3C,0xD83D0xDE3D,0xD83D0xDE3E,0xD83D0xDE3F,0xD83D0xDE40,0xD83D0xDE45,0xD83D0xDE46,0xD83D0xDE47,0xD83D0xDE48,0xD83D0xDE49,0xD83D0xDE4A,0xD83D0xDE4B,0xD83D0xDE4C,0xD83D0xDE4D,0xD83D0xDE4E,0xD83D0xDE4F,0xD83D0xDE80,0xD83D0xDE81,0xD83D0xDE82,0xD83D0xDE83,0xD83D0xDE84,0xD83D0xDE85,0xD83D0xDE86,0xD83D0xDE87,0xD83D0xDE88,0xD83D0xDE89,0xD83D0xDE8A,0xD83D0xDE8C,0xD83D0xDE8D,0xD83D0xDE8E,0xD83D0xDE8F,0xD83D0xDE90,0xD83D0xDE91,0xD83D0xDE92,0xD83D0xDE93,0xD83D0xDE94,0xD83D0xDE95,0xD83D0xDE96,0xD83D0xDE97,0xD83D0xDE98,0xD83D0xDE99,0xD83D0xDE9A,0xD83D0xDE9B,0xD83D0xDE9C,0xD83D0xDE9D,0xD83D0xDE9E,0xD83D0xDE9F,0xD83D0xDEA0,0xD83D0xDEA1,0xD83D0xDEA2,0xD83D0xDEA3,0xD83D0xDEA4,0xD83D0xDEA5,0xD83D0xDEA6,0xD83D0xDEA7,0xD83D0xDEA8,0xD83D0xDEA9,0xD83D0xDEAA,0xD83D0xDEAB,0xD83D0xDEAC,0xD83D0xDEAD,0xD83D0xDEAE,0xD83D0xDEAF,0xD83D0xDEB0,0xD83D0xDEB1,0xD83D0xDEB2,0xD83D0xDEB3,0xD83D0xDEB4,0xD83D0xDEB5,0xD83D0xDEB6,0xD83D0xDEB7,0xD83D0xDEB8,0xD83D0xDEB9,0xD83D0xDEBA,0xD83D0xDEBB,0xD83D0xDEBC,0xD83D0xDEBD,0xD83D0xDEBE,0xD83D0xDEBF,0xD83D0xDEC0,0xD83D0xDEC1,0xD83D0xDEC2,0xD83D0xDEC3,0xD83D0xDEC4,0xD83D0xDEC5,0x00230x20E3,0x00300x20E3,0x00310x20E3,0x00320x20E3,0x00330x20E3,0x00340x20E3,0x00350x20E3,0x00360x20E3,0x00370x20E3,0x00380x20E3,0x00390x20E3,0xD83C0xDDE80xD83C0xDDF3,0xD83C0xDDE90xD83C0xDDEA,0xD83C0xDDEA0xD83C0xDDF8,0xD83C0xDDEB0xD83C0xDDF7,0xD83C0xDDEC0xD83C0xDDE7,0xD83C0xDDEE0xD83C0xDDF9,0xD83C0xDDEF0xD83C0xDDF5,0xD83C0xDDF00xD83C0xDDF7,0xD83C0xDDF70xD83C0xDDFA,0xD83C0xDDFA0xD83C0xDDF8".split(",");
emojiUTF16Reg=[];imgReg=/<img.+?rel="emoji".+?name="([\w]+?)".+?\/>/gi;for(var d=0;d<a.length;d++)emojiUTF16Reg.push(RegExp(a[d].replace(/0x/g,"\\u"),"g"));var f=function(a){return a.replace(imgReg,function(a,b){for(var d=b.split("0x"),f=[],i=1;i<d.length;i++)f.push(parseInt(d[i],16));return String.fromCharCode.apply(void 0,f)})};return{code2Img:function(b){for(var c=0;c<emojiUTF16Reg.length;c++)b=b.replace(emojiUTF16Reg[c],'<img alt="@" height="24" width="24" src="http://qplus3.idqqimg.com/qun/jslib/res/ios_emoji/'+
a[c]+'.png" rel="emoji" name="'+a[c]+'" />');return b},imgs2Code:function(a){return f(a)}}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/Profile","simple,../common/TRecordPatch,../common/util,../common/client,./User,./LBS,./MapManage,./ActionBar,catCtrl,./Panel,./TabIndexSwitcher,./DetailTrigger,../../../common/js/util,../tags/tags,../../../common/js/log,./db_app,./Select,./InputSuggestion,../common/hintState,htmlEncode,face,xss,emojiface".split(","),d):
a.Profile=d(a.$,a.TRecord,a.Util,a.Client,a.User,a.LBS,a.MapManage,a.ActionBar,a.CatCtrl,a.Panel,a.TabIndexSwitcher,a.DetailTrigger,a.CommonUtil,a.Tags,a.LOG,a.DB,a.Select,a.InputSuggestion,a.HintState,a.htmlEncode,a.face,a.xss,a.emojiface)})(this,function(a,d,f,b,c,h,e,g,i,l,n,p,v,w,z,A,F,H,t,K,D,u,q){var j,o;function B(b){if(b&&"isEditing"in b)c.isEditing=b.isEditing;var d=a("qname"),J=a("intro-wrap"),b=a("qun-detail");if(!c.isEditing){c.isEditing=true;d.previousSibling.setAttribute("aria-label",
k.gName);d.title=a.str.decodeHtml(k.gName);var j=u.filter(s.decodeRichText(s.getRichText())||a.str.decodeHtml(k.gIntro));j?(P=false,a.css.removeClass(J,"no-intro"),a("intro-wrap-label").setAttribute("aria-label",j)):(P=true,J.innerHTML="-",a.css.addClass(J,"no-intro"),a("intro-wrap-label").setAttribute("aria-label","\u8fd9\u4e2a\u7fa4\u8fd8\u6ca1\u6709\u586b\u5199\u7fa4\u7b80\u4ecb"));var m=a("qun-cat-value"),o=a("qun-detail-value"),p=l.getCatAndDetail();a.oop.extend(la,p||{});p.strCat==="\u540c\u4e8b\u670b\u53cb-\u540c\u5b66"?
a.css.addClass(m,"max2lines"):a.css.removeClass(m,"max2lines");var q=p.strCat+(p.strDetail?"-"+p.strDetail:"")||"-";Y=!!q;m.setAttribute("title",q);m.innerHTML=a.str.encodeHtml(q);m.previousSibling.setAttribute("aria-label",q);t.toggle("qun-cat",q.replace(/\-/g,""));a.css.hide(b);o.title=p.strDetail;o.innerHTML=a.str.encodeHtml(p.strDetail)||"-";k.pos&&e.setVal(k.pos);if(c.hasPermission("editCat")&&!Q&&(window.DEBUG||i.getCatNamePath(k.catId)[0]!=="\u540c\u4e8b\u670b\u53cb"&&k.gMemNum>=30)&&!Q)h.LBSTip.init(a("profile-wrap")),
Q=true;o=a("qun-loc-value");m=h.get_lbs_str();h.set_lbs_html(o,{str:m,canedit:c.hasPermission("editCat")});o.parentNode.previousSibling.setAttribute("aria-label",m);if(m===h.pseudoAddr||!m)(o=a("qun-loc").getElementsByClassName("del")[0])&&a.css.hide(o);n.change(0);t.toggle("qun-loc",m);d.removeAttribute("title");k.auth?(d.title="\u8ba4\u8bc1\u7fa4\u4e0d\u80fd\u4fee\u6539\u7fa4\u540d\u79f0",d.setAttribute("disabled","true")):(f.limitInputLength(a("qun-name"),Z),a("qun-name").value=a.str.decodeHtml(k.gName),
a("qun-name").oninput=function(){t.toggle("qun-name");g.enableSaveBtn()},t.toggle("qun-name"));if(!k.isSchoolGroup)J.removeAttribute("title"),J.innerHTML="",d=a.dom.getNode("div",{style:"white-space: normal;text-align:left;font-size: 12px;font-family: '\u5fae\u8f6f\u96c5\u9ed1'","class":"editor",id:"qun-intro","aria-label":"\u7fa4\u7b80\u4ecb",placeholder:"\u8f93\u5165\u8be6\u7ec6\u7b80\u4ecb\uff0c\u8ba9\u5927\u5bb6\u4e86\u89e3\u4f60\u7684\u7fa4"}),d.innerHTML=j,J.appendChild(d),a.e.add(d,"click",
function(){a.css.addClass(J,"editing");require(["./RichEditor"],function(a){s.editor=new a({el:document.getElementById("qun-intro"),wordLimit:s.wordMaxLength});g.enableSaveBtn();s.editor.onChange=function(){setTimeout(function(){I()},200)}})}),require(["./RichEditor"],function(){}),J.appendChild(d);a.css.show(b);ma();n.change(1);k.auth||(a("qun-name").focus(),a("qun-name").select());ia()}}function L(){var c=a("js-profile-percent-board");a.e.add(c,"mouseenter",function(){console.log("enter!!!!");if(!R)a("js-profile-percent-hint").style.display=
"inline-block"});a.e.add(c,"mouseleave",function(){a("js-profile-percent-hint").style.display="none"})}function G(){a.oop.addObserver(g,"editingStatusChange",function(c){c.isEditing||a.oop.notifyObservers(y,"leaveEditing")})}function C(){b.callClientAPI("OpenModifyHeadWnd",k.gc);m("PROFILE_QHEAD_MODBTN_CLICK")}function M(){var a={};try{a=JSON.parse(top.external.GetGroupBasicInfo(k.gc+""))}catch(c){a={}}a==null&&(a={});if(aa)a.head_type=2;var b=l.getModifyField(true);return{head_type:a.head_type,classID:b.classID||
k.catId,"class":l.getDetail(),pos:e.getVal(),tags:Array(k.tagNum)}}function X(){var c=M(),b=0;head_type=c.head_type;head_type==2&&(b+=20);i.getItemById(c.classID)&&(b+=20);c.pos&&(b+=10);a.str.byteLen(s.getText(),3)>90&&(b+=20);if((c.tags||[]).length>=4)b+=30;return b}function I(){var c=M(),b=0,d={head_type:{fullfill:false,wording:"\u4e0a\u4f20\u81ea\u5b9a\u4e49\u7fa4\u5934\u50cf",percent:20},classID:{fullfill:false,wording:"\u5b8c\u5584\u5206\u7c7b",percent:20},"class":{fullfill:false,wording:"\u5b8c\u5584\u5206\u7c7b\u8be6\u60c5",
percent:20},pos:{fullfill:false,wording:"\u6dfb\u52a0\u7fa4\u5730\u70b9",percent:10},gIntro:{fullfill:false,wording:"\u7b80\u4ecb\u8d85\u8fc730\u5b57",percent:20},tags:{fullfill:false,wording:"\u6807\u7b7e\u8d85\u8fc74\u4e2a",percent:30}};head_type=c.head_type;if(head_type==2)b+=20,d.head_type.fullfill=true;if(c.classID!=0&&i.getItemById(c.classID))c["class"]===null?(b+=20,d.classID.fullfill=true,d["class"].fullfill=true):c["class"]?(b+=20,d.classID.fullfill=true,d["class"].fullfill=true):(d.classID.fullfill=
true,d["class"].fullfill=false);if(c.pos)b+=10,d.pos.fullfill=true;if(a.str.byteLen(s.getText(),3)>90)b+=20,d.gIntro.fullfill=true;if((c.tags||[]).length>=4)b+=30,d.tags.fullfill=true;a("js-profile-percent").innerHTML=b+"%";R=true;for(var e in d)if(c=d[e],!c.fullfill){R=false;a("js-profile-wording").innerHTML=c.wording;a("js-profile-next-percent").innerHTML="+"+c.percent+"%";break}}function fa(){for(var c=a.dom.queryClassAll("pair","div",a("base-info")),b=20,d=0,e=c.length;d<e;d++)c[d].style.zIndex=
--b}function ga(b){b.pos===""&&delete b.pos;k=a.oop.extend(k,b);k.gAdminsName=k.gAdminsName||{};k.auth=b.auth;k.catId=b.classID;k.desc=a.str.decodeHtml(b["class"]||"");delete k.classID;delete k["class"];if(typeof b.flag=="undefined")switch(a.bom.getHash("role")){case "1":b.flag=3;break;case "2":b.flag=2;break;case "3":b.flag=1;break;case "4":b.flag=0;break;default:b.flag=0}c.setRole(b.flag);k.isSchoolGroup=k.gSpeClass===3;var b=(b=k)||{},d=i.getCatNamePath(b.catId),e;d.length>=2&&(e=d[1]);h.setPseudoAddr(e,
b.desc,b.pos)}function ha(){var b=a("qun-loc-value");b&&(a("qun-loc").getElementsByClassName("del"),a.e.add(b,"click",j=function(d){var f=c.isEditing;a.css.hasClass(d.target,"check")&&e.loadMap(h.useCityName?"":h.pseudoAddr,c.hasPermission("editCat")?1:0,a("profile-map-container"));d=d.target.getAttribute("data-action");d==="view"?(f=c.getRoleType()==="visitor",m("PROFILE_LBS_VIEWBTN_CLICK",{v:f?1:0})):d==="mod"?(f?m("PROFILE_LBS_MODBTN_CLICK@EDIT=1"):m("PROFILE_LBS_MODBTN_CLICK@EDIT=0"),I()):d===
"add"?(a.oop.notifyObservers(h,"addLBS"),f?m("PROFILE_LBS_ADDBTN_CLICK@EDIT=1"):m("PROFILE_LBS_ADDBTN_CLICK@EDIT=0")):d==="del"&&(h.set_lbs_html(b,{canedit:c.hasPermission("editCat")}),e.clearVal(),g.enableSaveBtn(),t.toggle("qun-loc",""),I(),m("PROFILE_LBS_DELBTN_CLICK"))}),a.oop.addObserver(e,"setMap",function(b){if(c.hasPermission("editCat")){var d=a("qun-loc-value"),e=[];b.province&&e.push(b.province);b.city&&e.push(b.city);b.name&&e.push(b.name);h.set_lbs_html(d,{str:a.str.encodeHtml(e.join("-")),
canedit:c.hasPermission("editCat")});a.css.addClass(d,"non-empty");a.css.removeClass(d,"warn");g.enableSaveBtn();t.toggle("qun-loc",e.join());I()}}))}function ia(){w.init(a("tagsContainer"),k);a.oop.addObserver(w,"onTagChange",function(b){k.tagNum=b.total;a.oop.notifyObservers(y,"onTagChange",b);t.toggle("qun-tag",b.total);E&&(b.action=="add"?m("PROFILE_GUIDE_TAG_ADD",{v:c.getRoleType()=="owner"?1:0}):b.action=="del"&&m("PROFILE_GUIDE_TAG_DEL",{v:c.getRoleType()=="owner"?1:0}));b.action=="add"?m("PROFILE_TAG_ADD",
{v:x?1:0}):b.action=="del"&&m("PROFILE_TAG_DEL",{v:x?1:0});x?b.action=="add"&&m("PROFILE_CREATE_MOD_TAG",{v:x?1:0}):b.action=="add"&&m("PROFILE_PRE_CREATE_SAVE_TAG",{v:c.getRoleType()=="owner"?1:0});I()})}function ka(){a.css.addClass(S,"admin");g.init({domRoot:S,gc:k.gc,cltVer:b.getClientVersion()});a.oop.addObserver(g,"confirmSave",function(){ba()});a.oop.addObserver(g,"modifyCheckerRequest",function(b){var c=T();a.oop.notifyObservers(g,"modifyCheckerResponse",{isModify:c,seq:b})});a.oop.addObserver(g,
"editBtnClick",function(){m("PROFILE_ACTIONBAR_EDITBTN_CLICK")});a.oop.addObserver(g,"closeBtnClick",function(){m("PROFILE_ACTIONBAR_CLOSEBTN_CLICK");E?m("PROFILE_GUIDE_CANCEL_CLICK"):x?m("FROM_CREATE_CANCEL_CLICK"):m("FROM_EDIT_CANCEL_CLICK")});a.oop.addObserver(g,"saveBtnClick",function(){m("PROFILE_ACTIONBAR_SAVEBTN_CLICK");if(U){var b=a("share_photo_open").checked;if(V==b&&!E&&!x)return;A.set_group_setting({param:{gc:k.gc,photoflag:b?1:0},succ:function(a){E?b&&m("PROFILE_GUIDE_SHARE_OPEN_SUCC",
{v:c.getRoleType()=="owner"?1:0}):(x&&b&&m("PROFILE_GUIDE_CREATE_OPEN_SUCC",{v:c.getRoleType()=="owner"?1:0}),b&&m("VISITOR_SHARE_ACCESS_SUCC",{v:c.getRoleType()=="owner"?1:0}));top.postMessage(JSON.stringify({event:"OnShareFlagChanged",from:"Profile"}),"*");console.log("set_group_setting succ: "+a)},err:function(a){console.log("set_group_setting err: "+a)}});E||m("VISITOR_SHARE_ACCESS",{v:c.getRoleType()=="owner"?1:0})}E?m("PROFILE_GUIDE_SAVE_CLICK"):x?m("FROM_CREATE_SAVE_CLICK"):m("FROM_EDIT_SAVE_CLICK")})}
function ja(){a.e.add(a("share_photo_open"),"change",o=function(){if(!this.checked&&!b.confirm(1,"\u63d0\u793a","\u975e\u7fa4\u6210\u5458\u5c06\u65e0\u6cd5\u9884\u89c8\u7fa4\u5185\u76f8\u518c\u4e0e\u5171\u4eab").ret)this.checked=true})}function T(){var a=false,b=c.getRoleType();b!=="member"&&b!=="visitor"&&(a=a||N["qun-name"].isModify()||N["qun-intro"].isModify()||l.checkModify());c.hasPermission("editCat")&&(a=a||N["qun-pos"].isModify());return a?1:0}function ca(c,d,e,f){if(a.str.trim(c)===""&&f)return b.showTips(e+
"\u4e0d\u80fd\u4e3a\u7a7a"),false;else if(a.str.byteLen(c,3)>d)return b.showTips(e+"\u6700\u591a"+d/3+"\u4e2a\u6c49\u5b57"),false;return true}function na(){var d=true,e;if(c.hasPermission("editCat")){(e=a("qun-name"))&&(d=ca(e.value,Z,"\u7fa4\u540d\u79f0",true));if(!d)return d;s.isOpen?s.isOutLength()&&(b.showTips("\u7fa4\u4ecb\u7ecd\u6700\u591a"+s.wordMaxLength+"\u4e2a\u5b57"),d=false):(e=a("qun-intro"))&&(d=ca(e.value,da,"\u7fa4\u7b80\u4ecb"));if(!d)return d}return d=d&&l.checkValidation()}function oa(d){var f=
{};f.gc=k.gc;f.fRemark=0;if(c.hasPermission("editCat"))if(k.gDisable!==1){f.gName=k.auth?a.str.decodeHtml(k.gName):a("qun-name").value;if(!k.isSchoolGroup&&(f.gIntro=s.substring(D.moblieCode2Text(D.faceCode2MoblieCode(K.decode(s.getText()))),0,da),s.isOpen)){var g=s.getRichText();s.editor||(g=u.filter(s.decodeRichText(g)));f.gRIntro=q.imgs2Code(D.imgs2MoblieCode(g)).replace(/(<a.+?>)|<\/a>/gi,"").replace(/(\r\n|\n|\r)/gm,"")}f.fOthers=1;g=e.getVal();if(k.pos!==g&&(f.fPos=1,g))f.pos=g}else if(g=!k.auth&&
a("qun-name").value!==a.str.decodeHtml(k.gName),!g&&!k.isSchoolGroup&&(g=N["qun-intro"].isModify()),g){b.showTips("\u7fa4\u8d44\u6599\u6682\u65f6\u65e0\u6cd5\u4fdd\u5b58");b.callClientAPI("OnSave",1);return}f=a.oop.extend(f,l.getModifyField());f.classID&&(console.error("Warning: LBS.setPseudoAddr() unexpect call! params.classID="+f.classID),h.setPseudoAddr(f.classID,f["class"]),E&&(console.log("\u5f15\u5bfc-\u7fa4\u5206\u7c7b-\u6539\u53d8\uff01"),m("PROFILE_GUIDE_CAT_MODIFIED",{v:c.getRoleType()==
"owner"?1:0})),E&&Y&&(console.log("\u5f15\u5bfc-\u7fa4\u5206\u7c7b-\u6539\u53d8\uff01"),m("PROFILE_GUIDE_CAT_EMPTY_MODIFIED",{v:c.getRoleType()=="owner"?1:0})));var i=0,j=0;T(true)&&(i++,g=N["qun-intro"].isModify(),E&&g&&(console.log("\u7fa4\u7b80\u4ecb\u53d8\u5316\uff01"),m("PROFILE_GUIDE_INTRO_MODIFIED",{v:c.getRoleType()=="owner"?1:0})),E&&P&&g&&(console.log("\u7fa4\u7b80\u4ecb\u53d8\u5316\uff01\u4e14\u539f\u5148\u4e3a\u7a7a\uff01"),m("PROFILE_GUIDE_INTRO_EMPTY_MODIFIED",{v:c.getRoleType()=="owner"?
1:0})),E&&t.allPass()&&m("PROFILE_GUIDE_ALL_FULLFILL",{v:c.getRoleType()=="owner"?1:0}),x&&m("PROFILE_CREATE_SAVE_CLICK",{v:t.allPass()?1:0}),x||(m("PROFILE_PRE_CREATE_SAVE_SUCC_WITH_CHANGE",{v:c.getRoleType()=="owner"?1:0}),t.allPass()&&m("PROFILE_PRE_CREATE_ALL_FULLFILL",{v:c.getRoleType()=="owner"?1:0})),A.set_group_info({param:f,succ:function(e){if(e.ec===20)b.showTips(e.url[0]+"\u94fe\u63a5\u5b58\u5728\u5b89\u5168\u98ce\u9669\uff0c\u65e0\u6cd5\u4fdd\u5b58\u7b80\u4ecb\u5185\u5bb9\u3002");else{f.gName!==
k.gName&&(m("PROFILE_MODIFY_QNAME_SUCC",{v:x?1:0}),x?m("PROFILE_CREATE_MOD_NAME"):m("PROFILE_PRE_CREATE_MOD_NAME",{v:c.getRoleType()=="owner"?1:0}));if(c.hasPermission("editCat")&&k.gDisable!==1){k.gName=a.str.encodeHtml(f.gName);if(!k.isSchoolGroup&&k.gIntro!==f.gIntro)k.gIntro=f.gIntro,m("PROFILE_MODIFY_INTRO_SUCC",{v:x?1:0});if(f.classID!==void 0)x?(k.catId!=f.classID&&m("PROFILE_CREATE_MOD_CAT"),k.desc!=f["class"]&&m("PROFILE_CREATE_MOD_CAT_DETAIL",{v:k.desc==""?1:0})):(!k.catId&&k.catId!=f.classID&&
m("PROFILE_PRE_CREATE_ADD_CAT",{v:c.getRoleType()=="owner"?1:0}),k.catId&&k.catId!=f.classID&&m("PROFILE_PRE_CREATE_MOD_CAT",{v:c.getRoleType()=="owner"?1:0}),!k.desc&&k.desc!=f["class"]&&m("PROFILE_PRE_CREATE_ADD_CAT_DETAIL",{v:c.getRoleType()=="owner"?1:0}),k.desc&&k.desc!=f["class"]&&m("PROFILE_PRE_CREATE_MOD_CAT_DETAIL",{v:c.getRoleType()=="owner"?1:0})),k.desc=f["class"],k.catId=f.classID,l.storeDetail(),m("PROFILE_MODIFY_CAT&DETAIL_SUCC",{v:x?1:0})}if(f.fPos===1)f.pos?k.pos?(m("PROFILE_LBS_MODIFY_SUCC",
{v:x?1:0}),x&&m("PROFILE_CREATE_MOD_CAT_LOC",{v:0})):(m("PROFILE_LBS_ADD_SUCC",{v:x?1:0}),x&&m("PROFILE_CREATE_MOD_CAT_LOC",{v:1})):m("PROFILE_LBS_DEL_SUCC"),k.pos=f.pos,m("PROFILE_LBS_CHANGE_SUCC");--i===0&&(a.report("now"),d&&d())}},err:function(a){j++;if(!(j>1)){var c="",d=1;switch(a.ec){case 11:c="\u7fa4\u5907\u6ce8\u4fee\u6539\u5931\u8d25";break;case 12:c="\u7fa4\u540d\u79f0\u4e2d\u5305\u542b\u654f\u611f\u8bcd";d=2;break;case 13:c="\u7fa4\u4ecb\u7ecd\u4e2d\u5305\u542b\u654f\u611f\u8bcd";d=2;
break;case 14:c="\u7fa4\u4ecb\u7ecd\u4e2d\u5305\u542b\u654f\u611f\u8bcd";d=2;break;case 15:c="\u60a8\u6ca1\u6709\u4fee\u6539\u6743\u9650";break;case 18:c="\u7fa4\u5df2\u7ecf\u88ab\u5220\u9664";break;case 19:c="\u8be6\u60c5\u4e2d\u5305\u542b\u654f\u611f\u8bcd";d=2;break;case 21:c="\u7fa4\u5907\u6ce8\u5305\u542b\u654f\u611f\u8bcd";d=2;break;default:c="\u4fdd\u5b58\u51fa\u9519\u4e86"}b.showTips(c,d);b.callClientAPI("OnSave",1)}}}))}function ba(c){window.DEBUG||c||b.callClientAPI("IsSelfOnline")?na()&&
oa(function(){b.callClientAPI("OnSave",0);a.oop.notifyObservers(y,"setGrpInfoSucc");g.stopEditing()}):b.showTips("\u60a8\u5df2\u7ecf\u5904\u4e8e\u79bb\u7ebf\u72b6\u6001\uff0c\u8bf7\u4e0a\u7ebf\u540e\u518d\u6b21\u5c1d\u8bd5")}var pa=function(a){var b={updateAvatar:function(){console.warn("fake updateAvatar calling!");z({type:"error",msg:"profile\u83b7\u53d6top\u7684Util\u51fa\u9519!(profile.js)"})}};return a&&"updateAvatar"in a?a:(a=top.Util||{})&&"updateAvatar"in a?a:b}(v),v=function(){var c=b.getClientVersion();
return function(b){var d={flag1:k.gc,ver:c};if(typeof b==="object"&&!("v"in b)&&"aId"in b)b=a.bom.getHash("from"),d.v=b&&b==="create"?1:0;return d}}(),m=a.report.ReportFactory({config:{PROFILE_GUIDE_CAT_EMPTY_MODIFIED:{aId:1124},PROFILE_GUIDE_CAT_MODIFIED:{aId:1125},PROFILE_GUIDE_INTRO_MODIFIED:{aId:1126},PROFILE_GUIDE_INTRO_EMPTY_MODIFIED:{aId:1127},PROFILE_GUIDE_TAG_ADD:{aId:1128},PROFILE_GUIDE_TAG_DEL:{aId:1129},PROFILE_GUIDE_SHARE_OPEN_SUCC:{aId:1130,mId:354302},PROFILE_GUIDE_CREATE_OPEN_SUCC:{mId:357338},
PROFILE_GUIDE_ALL_FULLFILL:{aId:1131,mId:354303},PROFILE_CREATE_MOD_NAME:{aId:1139},PROFILE_CREATE_MOD_CAT:{aId:1140},PROFILE_CREATE_MOD_CAT_DETAIL:{aId:1141},PROFILE_CREATE_MOD_CAT_LOC:{aId:1142},PROFILE_CREATE_MOD_TAG:{aId:1143},PROFILE_CREATE_SAVE_CLICK:{aId:1144},PROFILE_CREATE_ENTER:{aId:1145},PROFILE_PRE_CREATE_MOD_NAME:{aId:1147},PROFILE_PRE_CREATE_ADD_CAT:{aId:1148},PROFILE_PRE_CREATE_MOD_CAT:{aId:1149},PROFILE_PRE_CREATE_ADD_CAT_DETAIL:{aId:1150},PROFILE_PRE_CREATE_MOD_CAT_DETAIL:{aId:1151},
PROFILE_PRE_CREATE_SAVE_TAG:{aId:1152},PROFILE_PRE_CREATE_SAVE_SUCC_WITH_CHANGE:{aId:1153},PROFILE_PRE_CREATE_ALL_FULLFILL:{aId:1154},PROFILE_PRE_CREATE_ENTER:{aId:1155},PROFILE_GUIDE_SAVE_CLICK:{mId:356035},PROFILE_GUIDE_CANCEL_CLICK:{mId:356036},FROM_EDIT_SAVE_CLICK:{mId:356037},FROM_EDIT_CANCEL_CLICK:{mId:356038},FROM_CREATE_SAVE_CLICK:{mId:356045},FROM_CREATE_CANCEL_CLICK:{mId:356046},VISITOR_SHARE_ACCESS:{aId:1109},VISITOR_SHARE_ACCESS_SUCC:{aId:1110},PROFILE_GET_INFO_ERR:275016,PROFILE_QHEAD_MODBTN_CLICK:{aId:1082},
PROFILE_MODIFY_QNAME_SUCC:{aId:1085},PROFILE_TAG_ADD:{aId:1089},PROFILE_TAG_DEL:{aId:1090},PROFILE_MODIFY_INTRO_SUCC:{mId:242618,aId:1088,v:0},"PROFILE_MODIFY_CAT&DETAIL_SUCC":{mId:242623,aId:1086},"PROFILE_LBS_MODBTN_CLICK@EDIT=1":{aId:1084},"PROFILE_LBS_ADDBTN_CLICK@EDIT=1":{aId:1083},PROFILE_LBS_ADD_SUCC:306908,PROFILE_LBS_MODIFY_SUCC:306910,PROFILE_LBS_DEL_SUCC:306912,PROFILE_LBS_CHANGE_SUCC:{aId:1087},PROFILE_LEAVE_WITH_HUNDRED_PERCENT:{aId:1180}},getDefaultOptFn:v}),la={},y={};j=void 0;o=void 0;
var S,Z=30,da=120,x=false,E=false,aa=false,ea=0,O=0,U=false,P=false,Y=false,V=false,k={};k.gc=parseInt(a.bom.getHash("groupuin"),10);l.init({getInfoFn:function(a){return y.getQunInfo(a)}});v=function(b,c,d){this.infoId=b;this.text=c;if(d)for(var e in d)d.hasOwnProperty(e)&&(this[e]=typeof d[e]==="function"?a.oop.bind(d[e],this):d[e])};v.prototype.getInfo=function(){return k[this.infoId]};v.prototype.getValue=function(){var b=a(this.iptId);if(b)return b.value};v.prototype.isModify=function(){var a=
false,b=this.getInfo(),c=this.getValue();typeof c!=="undefined"&&(a=b!==c);return a};var N={"qun-name":new v("gName","\u540d\u79f0",{iptId:"qun-name",getInfo:function(){return a.str.decodeHtml(k[this.infoId])}}),"qun-intro":new v("gIntro","\u7fa4\u7b80\u4ecb",{isModify:function(){if(s.editor)if(s.orgnalValue.rich){var a=s.getRichText().replace(/(<a.+?>)|<\/a>/gi,"").replace(/\n$/,""),b=s.decodeRichText(s.orgnalValue.rich);return a.length==b.length?a!=b:true}else return a=K.decode(s.orgnalValue.text).length,
b=s.getText().length,b==0?false:b!==a+1;return s.textArea?s.getTextLength()!==s.orgnalValue.text.length:false}}),"qun-pos":new v("pos","\u7fa4\u5730\u70b9",{isModify:function(){var a=e.getVal();if(h.get_lbs_str(a)!==h.pseudoAddr||!a&&k.pos)return a!==k.pos}})},s={editor:null,textArea:null,isOpen:true,wordMaxLength:300,orgnalValue:{text:null,rich:null},getText:function(){return this.editor?this.editor.getText():this.textArea?this.textArea.value:this.orgnalValue.text},getRichText:function(){return this.editor?
this.editor.getRichText():this.textArea?this.textArea.value:this.orgnalValue.rich},getTextLength:function(){return this.editor?this.editor.getTextLength():this.textArea?this.textArea.value.length:this.orgnalValue.text.length},isOutLength:function(){return parseInt(this.getTextLength())>this.wordMaxLength},strip:function(a){return!a?"":K.normalText(a).replace(/(\r\n|\n|\r)/gm," ")},decodeRichText:function(a){return q.code2Img(D.moblieCode2Img(D.code2Img(K.decode(a))))},substring:function(a,b,c){for(var d=
0,e=0,f=0,f=0;f<a.length;f++)if(a.charCodeAt(f)>255?e+=3:e++,e<=b)d++;else if(e>b+c)break;return a.substring(d,f)}},Q=false,R=false,W=function(){function b(c){var d=Array.prototype.slice.call(arguments,1);if(d.length){var e={};if(typeof d[0]==="string")e.url=d[0];var f=new Image;a.e.add(f,"error",function(){a.e.remove(f,"error");e.onerror&&e.onerror();b.apply(null,[c].concat(d.slice(1)))});a.e.add(f,"load",function(){a.e.remove(f,"load");e.onload&&e.onload();f.width<=40?(c.setAttribute("width","40"),
c.setAttribute("height","40"),a.css.setStyle(c,{marginLeft:"20px",marginTop:"20px"}),a.css.addClass(c.parentNode,"min")):c&&(c.setAttribute("width","80"),c.setAttribute("height","80"),a.css.setStyle(c,{marginLeft:"0px",marginTop:"0px"}),a.css.removeClass(c.parentNode,"min"));c.src=e.url});f.src=e.url}}return function(c){c?b(a("js-profile-qhead"),"http://3.url.cn/qun/qinfo_v2/modules/profile/img/profile_default_head.png"):pa.updateAvatar({img:a("js-profile-qhead"),onload:function(b){var c=a("profile-qhead");
b<=40?a.css.addClass(c,"min"):a.css.removeClass(c,"min")}},true)}}(),ma=function(){var b=null,d=function(d){if(c.isEditing&&document.activeElement!==b){var e=document.activeElement;if(a.css.hasClass(e,"detail-trigger")){e.dt.show();var f=null;d.shiftKey?(f=e.nextSibling.lastChild,a.css.isShow(f)?a.css.hasClass(f,"no-college-wrap")&&(f=e.nextSibling.childNodes[1]):f=e.nextSibling.firstChild):f=e.nextSibling.firstChild;f.firstChild.focus()}else!a.css.hasClass(e,"title-wrap")&&!H.curFocusInput&&!a.css.hasClass(e.parentNode,
"input-wrap")&&(p.hideAll(),H.hideAll());e.tagName==="TEXTAREA"&&e.select();b=document.activeElement}};return function(){var b=i.getCatNamePath(k.catId),e=a("qun-cat");a("qun-detail");var f=a.dom.queryClass("detail-trigger-ctn","div",e);f&&e.removeChild(f);var g=c.catTrg=new p(e,{tabIndex:"1"});g.$popView.innerHTML='<div class="kk-select" id="category-value"></div><div class="kk-select" id="subcategory-value"></div>';c.bSetDetail=true;var e=b[0],h=new F(e);c.jCat=h;h.arm(a("category-value"));h.render(i.getCatLeaf(0));
h.afterSelect(function(){g.fillTriggerContent(h.$title.innerHTML);var b=i.getCatLeaf(h.id);b.length===0?(j.hideEntry(),g.hide(),l.changeDetailState(),a.css.hasClass(a("qun-detail").lastChild,"detail-trigger-disabled")?a("qun-intro").focus():a("qun-detail").lastChild.firstChild.focus()):(j.render(b),j.selectDefault(),l.disableDetail());t.toggle("qun-cat",h.$title.innerHTML);I()});var j=new F("-");c.jSubcat=j;j.arm(a("subcategory-value"));j.afterSelect(function(){g.hide();g.fillTriggerContent(h.$title.innerHTML+
"-"+j.$title.innerHTML);l.changeDetailState();a.css.hasClass(a("qun-detail").lastChild,"detail-trigger-disabled")?a("qun-intro").focus():(a("qun-detail").lastChild.firstChild.focus(),d({shiftKey:false}));I()});b=b[1];if(e)if(h.set(e),b)j.set(b);else{if(i.getCatLeaf(h.id).length>0)l.storeDetail(h.id,-1,k.desc),c.bSetDetail=false}else c.fakeDesc=k.desc,c.bSetDetail=false,l.disableDetail();a.e.add(document,"keyup",d);a.e.add(document,"click",function(a){d(a);p.hideAll();H.hideAll()});H.getDepModule()}}();
y.init=function(b){S=b||document.body;U=false;O=O=0;(b=a.bom.getHash("from"))&&b==="create"?(x=true,m("PROFILE_CREATE_ENTER")):(x=false,m("PROFILE_PRE_CREATE_ENTER",{v:c.getRoleType()=="owner"?1:0}));E=b&&b==="guide-index"?true:false;b=parseInt(a.bom.getHash("groupuin"),10);isNaN(b)?(a.oop.notifyObservers(y,"beginJump404"),window.location.href="404.html"):(ka(),ja(),fa(),L(),n.init([[["document.getElementById('action-edit')",1],["document.querySelectorAll('.aria-block')",1]],[["document.getElementById('qun-name')",
1],["document.getElementById('qun-intro')",1],["document.getElementById('action-save')",2],["document.getElementById('action-close')",2]]]),t.listen("qun-detail",function(){I()}),e.init({getCatFn:function(){return k.catId},encodeFn:function(a){return f.urlencode(a)}}),G(),x||E?V=a("share_photo_open").checked=1:A.get_group_setting({type:"GET",param:{gc:b},succ:function(b){a("share_photo_open").checked=!!b.share;V=!!b.share},err:function(){}}),A.get_group_info({type:"GET",timeout:[3E3,function(){a.oop.notifyObservers(y,
"dataTimeout")}],param:{gc:b,t:"basic"},succ:function(b){s.orgnalValue.text=b.gIntro;s.orgnalValue.rich=K.decodeForMobile(b.gRIntro);ga(b);ha();B();a.e.trigger(a("action-edit"),"click");a.oop.notifyObservers(y,"dataLoaded");(function(){d.pageReady=(new Date).getTime();if(Math.random()>0.5)(new Image).src="http://isdspeed.qq.com/cgi-bin/r.cgi?flag1=7809&flag2=1&flag3=36"+d.getInterval("htmlStart","htmlEnd",7)+d.getInterval("htmlStart","jsloaded",8)+d.getInterval("htmlStart","pageReady",9);var a=c.getRoleType()===
"visitor";m("PROFILE_PV",{v:a?1:0})})();U=true;if((x||E)&&b.classID!=10010&&b.classID!=10012&&b.classID!=10011)a("share_photo_open").checked=1;a.css.show(a("photo-share-container"));k.tagNum=(b.tags||[]).length;setTimeout(function(){I()},10);ea=X();d.push("profile_click_edit","init_end");d.report2("flag1=7809&flag2=1&flag3=56","profile_click_edit",{init_end:"20",init_start:"19"})},err:function(b){switch(b.ec){case 1:a.oop.notifyObservers(y,"notLogin");break;default:a.oop.notifyObservers(y,"loadDataError")}m("PROFILE_GET_INFO_ERR")}}),
W(x),a.e.add(a("js-profile-changehead"),"click",C))};y.hide=function(){c.isEditing=false;O=X();ea!=100&&O==100&&m("PROFILE_LEAVE_WITH_HUNDRED_PERCENT");a.e.remove(a("js-profile-changehead"),"click",C);var b=a("qun-loc-value");b&&a.e.remove(b,"click",j);a.oop.removeObserver(e,"setMap");a.oop.removeObserver(g,"confirmSave");a.oop.removeObserver(g,"modifyCheckerRequest");a.oop.removeObserver(g,"editBtnClick");a.oop.removeObserver(g,"closeBtnClick");a.oop.removeObserver(g,"saveBtnClick");a.e.remove(a("qun-intro"),
"click");a.css.removeClass(a("intro-wrap"),"editing");s.editor&&s.editor.destroy();s.editor=null;s.textArea=null;a("qun-intro").innerHTML="";w.destroy();a.oop.removeObserver(w,"onTagChange");a.e.remove(a("share_photo_open"),"change",o);g.destroy();a.oop.removeObserver(g,"editingStatusChange")};y.getQunInfo=function(a){return k[a]};y.tryToLeave=function(){return g.tryToLeave()};y.saveProfile=ba;y.checkModify=function(){return T()};y.refreshGroupHead=W;y.changeGroupHead=function(){aa=true;W();I()};
return window.Profile=y});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/initProfileAgent",["simple","./Profile"],d):a.initProfileAgent=d(a.$,a.Profile)})(this,function(a,d){var f=false;return function(){f||(a.oop.addObserver(d,"dataLoaded",function(){window.parent.postMessage('{"from":"Profile","event":"dataLoaded"}',"http://qinfo.clt.qq.com")}),a.oop.addObserver(d,"beginJump404",function(){window.parent.postMessage('{"from":"Profile","event":"beginJump404"}',
"http://qinfo.clt.qq.com")}),a.oop.addObserver(d,"notLogin",function(){window.parent.postMessage('{"from":"Profile","event":"notLogin"}',"http://qinfo.clt.qq.com")}),a.oop.addObserver(d,"leaveEditing",function(){window.parent.postMessage('{"from":"Profile","event":"destroy"}',"http://qinfo.clt.qq.com")}),a.oop.addObserver(d,"setGrpInfoSucc",function(){window.parent.postMessage('{"from":"Profile","event":"setGrpInfoSucc"}',"http://qinfo.clt.qq.com")}),a.oop.addObserver(d,"onTagChange",function(a){window.parent.postMessage(JSON.stringify({from:"Profile",
event:"onTagChange",data:a}),"http://qinfo.clt.qq.com")}),f=true)}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/initContextMenu",["simple"],d):a.initContextMenu=d(a.$)})(this,function(a){return function(){function d(){if(b){var a=window.getSelection();a.removeAllRanges();var c=document.createRange();c.selectNodeContents(b);a.addRange(c)}}var f=a("contextmenu"),b=null,c=document.body.clientWidth,h=document.body.clientHeight,e=a("copy-it"),g=a("select-all");
a.e.add(a("profile-wrap"),"contextmenu",function(d){var g=d.target,n=a.css.hasClass(g,"copyable");if(!n&&g.parentNode&&a.css.hasClass(g.parentNode,"copyable"))g=g.parentNode,n=true;n?(b=g,g=d.x,d=d.y,g+124>c&&(g=c-124),d+50>h&&(d=h-50),f.style.left=g+"px",f.style.top=d+"px",window.getSelection().toString()?a.css.removeClass(e,"disabled"):a.css.addClass(e,"disabled"),a.css.removeClass(f,"hidden")):(b=null,a.css.addClass(f,"hidden"))});a.e.add(document,"click",function(){b=null;a.css.addClass(f,"hidden")});
f.onmousedown=function(c){var f=c.target;a.css.hasClass(f,"disabled")||(f===e?document.execCommand("copy"):f===g&&d(),b=null,c.preventDefault())};f.onclick=function(b){a.css.hasClass(b.target,"disabled")&&b.stopPropagation()};f.oncontextmenu=function(b){a.css.hasClass(b.target,"disabled")||a.css.addClass(f,"hidden");b.preventDefault()};a.e.add(document,"keydown",function(c){var e=c.target.tagName.toLowerCase();e!=="input"&&e!=="textarea"&&c.ctrlKey&&c.keyCode===65?(d(),c.preventDefault()):c.keyCode===
27&&(b=null,a.css.addClass(f,"hidden"))})}});(function(a,d){typeof define==="function"&&define.amd?define("modules/profile/js/profile/Main",["simple","modules/profile/js/common/TRecordPatch","modules/profile/js/profile/Profile","modules/profile/js/profile/initProfileAgent","modules/profile/js/profile/initContextMenu"],d):a.Main=d(a.$,a.TRecord,a.Profile,a.initProfileAgent,a.initContextMenu)})(this,function(a,d,f,b,c){return{init:function(){if(a.bom.getHash("debug")||a.bom.getHash("debug"))window.DEBUG=
1;d.jsloaded=(new Date).getTime();b();f.init();c()}}});define("profileIndex",["modules/profile/js/profile/Main"],function(a){return a})})();
