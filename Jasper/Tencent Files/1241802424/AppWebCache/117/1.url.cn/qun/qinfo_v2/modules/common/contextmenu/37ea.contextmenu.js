(function(){define("contextmenu",["jquery"],function(c){function h(){if(e){var a=window.getSelection();a.removeAllRanges();var b=document.createRange();b.selectNodeContents(e);a.addRange(b)}}var d=c("#global-contextmenu")[0],e=null,i=document.body.clientWidth,j=document.body.clientHeight,f=c("#global-copy-it")[0],k=c("global-select-all")[0];d.contextmenuHandler=function(a){for(var b=a.target,g=c(b).hasClass("copyable");!g&&b.parentNode;)b=b.parentNode,g=c(b).hasClass("copyable");g?(e=b,b=a.pageX,
a=a.pageY,b+124>i&&(b=i-124),a+50>j&&(a=j-50),d.style.left=b+"px",d.style.top=a+"px",window.getSelection().toString()?c(f).removeClass("disabled"):c(f).addClass("disabled"),c(d).removeClass("hidden")):(e=null,c(d).addClass("hidden"))};d.onmousedown=function(a){var b=a.target;c(b).hasClass("disabled")||(b==f?document.execCommand("copy"):b==k&&h(),e=null,a.preventDefault())};d.onclick=function(a){c(a.target).hasClass("disabled")&&a.stopPropagation()};d.oncontextmenu=function(a){c(a.target).hasClass("disabled")||
c(d).addClass("hidden");a.preventDefault()};c(document).on("click",function(){e=null;c(d).addClass("hidden")});c(document).on("keydown",function(a){var b=a.target.tagName.toLowerCase();b!="input"&&b!="textarea"&&a.ctrlKey&&a.keyCode==65?(h(a),a.preventDefault()):a.keyCode==27&&(e=null,c(d).addClass("hidden"))});return{add:function(a){c(a).on("contextmenu",d.contextmenuHandler)}}})})();
