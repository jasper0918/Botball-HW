(function(){define("modules/app/lecture/js/tmpl",[],function(){return function(){var a={},d=function j(b,o){var c=!/\W/.test(b)?a[b]=a[b]||j(document.getElementById(b).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+b.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return o?
c(o):c},c=function(j,b){if(!(this instanceof c))return new c(j,b);this.tmplId=j;this.tmplString="";this.tmplFunction=null;this.tmplNodes=[];typeof b==="undefined"?this.tmplFunction=a[j]:typeof b==="string"?(this.tmplFunction=d(b),a[j]=this.tmplFunction):(this.tmplString=d(j,b),this.tmplFunction=a[j])};c.fn=c.prototype;c.template=function(){};(function(j,b){for(var a in b)j[a]=b[a]})(c.fn,{init:function(){},render:function(a){this.tmplString=this.tmplFunction(a);return this},appendTo:function(a){if(!this.dfg){var b=
document.createElement("div");b.innerHTML=this.tmplString;for(var o=document.createDocumentFragment(),c=null;c=b.childNodes[0];)o.appendChild(c);this.dfg=o}a.appendChild(this.dfg);return this},prependTo:function(){var a=document.createElement("div");a.innerHTML=this.tmplString;for(var b=document.createDocumentFragment(),c=null;c=a.childNodes[0];)b.appendChild(c);(a=parentNode.firstChild)?parentNode.insertBefore(b,a):parentNode.appendChild(b);return this},update:function(a){a.innerHTML="";this.appendTo(a)},
valueOf:function(){return this.tmplString},toString:function(){return this.tmplString}});c.fn.init.prototype=c.fn;return c}()});(function(a,d){typeof define==="function"&&define.amd?define("async",[],d):a.Async=d()})(this,function(){return function(){return{parallel:function(a,d){for(var c=a.length,p=a.length,j=[],b=false,o=0;o<p;o++)(function(o){a[o](function(a,t){a?b||(b=true,d(a,j)):(c--,j[o]=t,c||d(null,j))})})(o)}}}()});define("app_lecture","jquery,modules/common/js/reportPatchJquery,modules/common/js/db,commonapi,modules/app/lecture/js/tmpl,async".split(","),
function(a,d,c,p,j){return function(){var b,c,d,s;function t(){a("#group_lecture_container .lecture-cover-img").each(function(){var c=a(this),b=c.data("src"),u=new Image;u.onload=function(){c.attr("src",b);this.onload=null};u.onerror=function(){this.onerror=null};u.src=b})}function q(a){return("00"+a).slice(-2)}function p(a,c){var b={uin:Util.cookie.uin(),opername:"edu",module:"qun_zl",action:a,obj1:d,obj2:"1.0",obj3:"obj3",ver1:s},g=[],n=[];c&&(b.ver2=c);Object.keys(b).forEach(function(a){/obj3|ts/.test(a)||
(g.push(a),n.push(b[a]))});v(function(n){var a="http://cgi.pub.qq.com/report/tdw/report?",b=[];Object.keys(n).forEach(function(a){n[a]&&b.push(a+"="+n[a])});a+=b.join("&");return a}({table:"dc00141",fields:encodeURIComponent(JSON.stringify(g)),datas:encodeURIComponent(JSON.stringify([n])),pr_ip:"obj3",pr_t:"ts",t:Date.now()}))}c=4;d=void 0;s=void 0;var w=function(){var b=Util.hash.get("data").match(/from_.*/)?1:0;return function(c,j){a.extend(c,{bId:"247",v:b,flag1:d});a.report(c,j)}}();(function(){function b(){var n=
g.durings.length;if(!n)return 2;if(g.now>=g.durings[n-1].et)return 2;for(var a=0;a<n;a++)if(g.now>=g.durings[a].st&&g.now<=g.durings[a].et)return 0;return 1}function c(){var a=g.st+"-"+g.et;switch(g.repeat){case 0:return g.sd+" "+a;case 1:return"\u6bcf\u5929 "+a;case 2:for(var b="\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,\u65e5".split(","),m=[],k=0,h=g.days.length;k<h;k++)m[k]=b[g.days[k]-1];return'\u6bcf\u5468<span class="course-rpt-day">'+m.join(",")+"</span> "+a;case 3:return'\u6bcf\u6708<span class="course-rpt-day">'+
g.days.join(",")+"</span>\u65e5 "+a;default:return""}}function j(){for(var a=g.now,b=0,c=g.durings.length;b<c;b++){var k=g.durings[b].st,h=g.durings[b].et;switch(g.state){case 0:if(a>=k&&a<=h)return k;break;case 1:if(k>a)return k;break;default:return k}}}Date.prototype.addDays=function(a){this.setDate(this.getDate()+a);return this};Date.prototype.addMonths=function(a){this.setMonth(this.getMonth()+a);return this};Date.prototype.initDate=function(a){a=a.split("-");this.setYear(a[0]);this.setMonth(parseInt(a[1],
10)-1);this.setDate(a[2]);return this};Date.prototype.initTime=function(a){a=a.split(":");this.setHours(a[0]||0);this.setMinutes(a[1]||0);return this};var g;return function(n,r,m,k,h,d,l){this.now=new Date(l?l*1E3:new Date);this.sd=n;this.ed=r;this.st=m.substring(0,5);this.et=k.substring(0,5);this.repeat=h||0;this.days=(d||"").split(",");g=this;n=[];d=g.sd;k=g.ed;m=g.st;l=g.et;h=g.repeat;r=g.days;m=(new Date).initDate(d).initTime(m)-0;k=(new Date).initDate(k).initTime(l)-0;d=(new Date).initDate(d).initTime(l)-
0;k<m&&(k+=864E5);d<m&&(d+=864E5);if(h==0)n.push({st:m,et:k});else if(h==1)for(h=new Date(m);h<=k;)l=h-m,n.push({st:l+m,et:l+d}),h.addDays(1);else if(h==2)for(h=new Date(m);h<=k;)l=(l=h.getDay())?l:7,a.inArray(l+"",r)>-1&&(l=h-m,n.push({st:l+m,et:l+d})),h.addDays(1);else if(h==3)for(h=new Date(m);h<=k;)l=h.getDate(),a.inArray(l+"",r)>-1&&(l=h-m,n.push({st:l+m,et:l+d})),h.addDays(1);this.durings=n;console.log(this.durings);this.state=b();this.stateDesc=c();this.latest=j();console.log(this.latest)}})();
b=function(){var b=a(this).attr("data-report").split(":");p(b[0],b[1])};var v=function(a){(new Image).src=[a,"r="+Math.random()].join("&")};return{initialized:false,init:function(b){if(!this.initialized){c=Util.hash.get("role");d=Util.hash.get("groupuin");this.initialized=true;w({aId:c!=1&&c!=2&&c!=3?1001:1011});try{if(b.app_user&&b.class_list)a(document.body).on("app.lecture.addGroupClicked",function(){w({aId:1002})});(function(){var a={get:function(a){a=top.location.hash.match(RegExp("(#|&)"+a+
"=([^&]*)(&|$)"));return!a?"":decodeURIComponent(a[2])},set:function(a){location.hash="#"+a}},b=a.get("data").match(/from_(.+)/),c=b?1:0,a=a.get("groupuin");c&&(TRecord.push("app_lecture","end"),TRecord.report2("flag1=7809&flag2=1&flag3=56","app_lecture",{end:"21"}),v("http://jsreport.qq.com/cgi-bin/report?id=167&rs=1191-"+c+"-390463-"+a+"-"+b[1]+"-"+(new Date-0)))})()}catch(j){}}},show:function(c){this.init(c.data||{});var d=c.data,o=d.items;s=d.agency_id;d.agency_name&&a("#lecture-title").html("\u8bfe\u7a0b\u5185\u5bb9-"+
d.agency_name);o.length?(p("exposure"),a.each(o,function(a,b){var c=[];c.push(function(){var a=new Date(b.time*1E3);return a.getMonth()+1+"\u6708"+a.getDate()+"\u53f7\u8d77"}());c.push(function(){var a=new Date(b.sub_bgtime*1E3),c=new Date(b.sub_endtime*1E3);return q(a.getHours())+":"+q(a.getMinutes())+"~"+q(c.getHours())+":"+q(c.getMinutes())}());c.push("\u5171"+b.lesson+"\u8282");b.desc=c.join("\uff0c");b.price=b.price-0?b.price/100:"\u514d\u8d39";b.name=b.name;b.person=b.apply_num?b.apply_num+
"\u4eba\u5df2\u7ecf\u62a5\u540d":(b.store_num||0)+"\u4eba\u5df2\u7ecf\u6536\u85cf"}),d=j("test",'<ul class="lecture-list">\t\t\t\t<% for(var i=0,len=items.length; i<len; i++){ %>\t\t\t\t\t<% var obj = items[i]; %>\t\t\t\t\t<% var courseUrl = "http://ke.qq.com/cgi-bin/courseDetail?from=10&course_id=" + obj.id; %>\t\t\t\t\t<li>\t\t\t\t\t\t<a data-report="pic_clk:<%= obj.id %>" href="<%= courseUrl %>" class="lecture-cover" target="_blank">\t\t\t\t\t\t\t<img class="lecture-cover-img" \t\t\t\t\t\t\t\tsrc="http://3.url.cn/qun/qinfo_v2/modules/app/lecture/img/app_cover_default.png"\t\t\t\t\t\t\t\tdata-src="<%= obj.cover_url %>" width="90px" height="52px" />\t\t\t\t\t\t</a>\t\t\t\t\t\t<h3 class="lecture-name" title="<%= obj.name %>">\t\t\t\t\t\t\t<a data-report="title_clk:<%= obj.id %>" href="<%= courseUrl %>" target="_blank"><%= obj.name %></a>\t\t\t\t\t\t</h3>\t\t\t\t\t\t<p class="lecture-desc"><%= obj.desc %></p>\t\t\t\t\t\t<p class="lecture-info">\t\t\t\t\t\t\t<strong><%= obj.price %></strong>\t\t\t\t\t\t\t<span class="lecture-apply-num"><%= obj.person %></span>\t\t\t\t\t\t</p>\t\t\t\t\t</li>\t\t\t\t<% } %>\t\t\t</ul>').render(d).toString(),
document.getElementById("group_lecture_container").innerHTML=d,t(),a("#group_lecture_container").on("click","[data-report]",b),a(c.parentNode).slideDown(500)):a(c.parentNode).slideUp(500)}}}()})})();
