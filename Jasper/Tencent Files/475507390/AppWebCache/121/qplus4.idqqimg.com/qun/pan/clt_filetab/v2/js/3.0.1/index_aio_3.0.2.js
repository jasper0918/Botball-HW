(function(){define("modules/model/list",[],function(){function j(){}function h(){return i}function f(a){i=a;c={};a.forEach(function(a){c[a.filepath]=a})}function e(a){i.unshift(a);c[a.filepath]=a;i.sort(function(a,b){b.createtime||console.warn("createtime\u6ca1\u6709\u503c");a.createtime||console.warn("createtime\u6ca1\u6709\u503c");return b.createtime-a.createtime});return i}function a(a,b){var i=c[a.filepath];if(b=="rename"&&i)i.filename=a.filename;if(b=="permanent"&&i){i.remotetype=1;i.can_forever=
false;i.style_istemp="";var d=i.filepath,e=a.fp;i.filepath=e;c[e]=i;delete c[d]}}function d(){return c}function b(a){var a=c[a],b=i.indexOf(a);i.splice(b,1);delete c[a.filepath];return i}var i=[],c={};return function(){var c={};c.init=j;c.method={};c.method.setListData=f;c.method.addListData=e;c.method.updateListData=a;c.method.removeListData=b;c.method.getListDataMap=d;c.method.getListData=h;return c}()});define("modules/model/box",[],function(){function j(a){l=a}function h(a){for(var b=0;b<a.length;b++){var c=
a[b];k[c.filepath]||(o.push(c),k[c.filepath]=c)}}function f(a){m=a;l.local.clist.set(m)}function e(a){for(var b=0;b<a.length;b++){var c=a[b];!k[c.filepath]&&!k[c.id]&&(o.push(c),c.filepath&&(k[c.filepath]=c),c.id&&(k[c.id]=c))}}function a(a){if(a=k[a])a=o.indexOf(a),a>=0&&o.splice(a,1)}function d(a){if(a){var b=k[a.id];b||((b=k[a.filepath])&&b.type.indexOf("upload")>=0&&a.type.indexOf("upload")>=0&&b.status!=a.status?k[a.id]=b:b=null);if(b){a.filepath&&(k[a.filepath]=b);for(var c in a)c==="createtime"&&
b.createtime||c==="task_starttime"&&b.task_starttime||(b[c]=a[c]);b.status.indexOf("complete")>=0&&(c=o.indexOf(b),c>=0&&(o.splice(c,1),m.unshift(b),l.local.clist.set(m),o[b.filepath]=null));return b}else{var g="\u5f53\u524d\u4efb\u52a1\u6570\u636e:\n"+JSON.stringify(a);g+="\u5f53\u524dplist\u6570\u636e\u60c5\u51b5\n";o.forEach(function(a){g+="fp["+a.fp+"]id["+a.id+"]status["+a.status+"]\n"});return i(a)}}}function b(a){for(var b=[],c=0;c<a.length;c++)b.push(d(a[c]));return b}function i(a){var b=
k[a.id];b||(b=k[a.filepath])&&(b&&b.type.indexOf("upload")>=0&&a.type.indexOf("upload")>=0&&b.status!=a.status?k[a.id]=b:b=null);if(b){k[a.id]=b;for(var c in a)b[c]=a[c];return b}else return o.unshift(a),k[a.id]=a,a.filepath&&(k[a.filepath]=a),a}function c(){return{plist:o,clist:m}}function g(){for(var a=[],b=0;b<m.length;b++)a.push(m[b]);m=[];l.local.clist.clear();return a}var l,m=[],o=[],k={};return function(){var l={};l.init=j;l.method={};l.method.setContinueTask=h;l.method.setClist=f;l.method.setPlist=
e;l.method.updatePlist=b;l.method.updatePlistItem=d;l.method.addNewTask=i;l.method.getBoxData=c;l.method.removePlistItem=a;l.method.clearClist=g;window.g_plistMap=k;window.g_plist=o;return l}()});define("modules/app.model",["./model/list","./model/box"],function(j,h){function f(d,b,i){a.info=d;a.local=b;a.client=i;j.init(a);h.init(a)}var e={},a={evt:{}};return function(){for(var d in j.method)e[d]=j.method[d];for(d in h.method)e[d]=h.method[d];e.init=f;e.evt=a.evt;return e}()});define("util/date",
[],function(){function j(a){return Math.ceil(a/86400)}function h(a){a=m(a);return a.getFullYear()!=k.getFullYear()?false:a.getMonth()!=k.getMonth()?false:a.getDate()!=k.getDate()?false:true}function f(a){var a=m(a),b=false;h(a)||(a=new Date(k.getFullYear(),k.getMonth(),k.getDate())-a,b=a>0&&a<864E5);return b}function e(a){var a=m(a),b=false;h(a)||(a=new Date(k.getFullYear(),k.getMonth(),k.getDate())-a,b=a>=0&&a<=864E5);return b?"\u6628\u5929":"\u524d\u5929"}function a(a){var a=m(a),b=false;h(a)||
(a=new Date(k.getFullYear(),k.getMonth(),k.getDate())-a,b=a>0&&a<1728E5);return b}function d(a){var a=m(a),b=i(k);return a>b?true:false}function b(a){a=m(a);return a.getYear()!=k.getYear()?false:true}function i(a){var a=m(a),b=a.getDay();b===0&&(b=7);b-=1;return new Date(a.getTime()-b*864E5)}function c(){}function g(a){var b=m(a),a=b.getFullYear(),c=b.getMonth()+1,b=b.getDate();return a+"-"+c+"-"+b}function l(a){a=m(a);a=(new Date).getTime()-a.getTime();a=parseInt(a/36E5,10);a<1?a="\u521a\u521a":
a+="\u5c0f\u65f6\u524d";return a}function m(a){var b=a;typeof a==="string"&&(b=new Date(a));typeof a==="number"&&(b=new Date(a*1E3));return b}function o(c){var g;typeof c=="number"?g=new Date(c*1E3):c instanceof Date&&(g=c);return h(g)?"\u4eca\u5929":a(g)?"\u6700\u8fd1\u4e09\u5929":d(g)?"\u4e00\u5468\u5185":b(g)?g.getFullYear()+"\u5e74"+(g.getMonth()+1)+"\u6708":g.getFullYear()+"\u5e74"}var k=new Date;k.getFullYear();return function(){var k={};k.dayStr=o;k.getDateStr=g;k.getDOY=c;k.getMOW=i;k.isToday=
h;k.isYesterday=f;k.isThisWeek=d;k.isThisYear=b;k.getHourStr=l;k.isLast3days=a;k.strYesterdayOrPre=e;k.getExpriesDayNum=j;return k}()});define("util/fileicon",[],function(){return{getFileIcon:function(j){var h="unknow",f={xls:/xls|xlsx/i,pdf:/pdf/i,ppt:/ppt|pptx/i,word:/doc|docx|wps/i,txt:/txt/i,pic:/jpg|jpeg|jpgx|gif|bmp|png/i,music:/mp3|wma|midi|aac/i,video:/mp4|rm|rmvb|mpeg|mov|avi|3gp|amv|dmv|flv|wmv|qsed|asf/i,zip:/rar|zip|tar|cab|uue|jar|iso|7z|ace|lzh|arj|gzip|bz2/i,code:/ink|torrent|url|vbs|tif|w3g|vbe|ssf|dll|mht|rcd|bat|sav|dat|cmd|ttf|xml|vob|sgs|mhw|js|html|htm|css/i,
exe:/exe|msi|apk|ipa/i},e;for(e in f)if(f[e].test(j)){h=e;break}return h}}});define("util/fileType",[],function(){return{getFileType:function(j){var h="\u5176\u4ed6",f={"\u6587\u6863":/doc|docx|ppt|pptx|xsl|xslx|xls|xlsx|pdf|txt|wps/i,"\u56fe\u7247":/jpg|jpeg|jpgx|gif|bmp|png/i,"\u97f3\u4e50":/mp3|wma|midi|aac/i,"\u89c6\u9891":/mp4|rm|rmvb|mpeg|mov|avi|3gp|amv|dmv|flv|wmv|qsed/i,"\u538b\u7f29\u5305":/rar|zip|tar|cab|uue|jar|iso|7z|ace|lzh|arj|gzip|bz2/i},e;for(e in f)if(f[e].test(j)){h=e;break}return h}}});
define("util/fileSize",[],function(){return{getFileSize:function(j){var h={fLen:3};if(typeof j!="number")return"";for(var f="B,KB,MB,GB,TB,PB".split(",");j>1024;)j/=1024,f.shift();j>=1E3&&(j/=1024,f.shift());var e=2,a=100;if(h&&h.len)e=h.len;e<0&&(e=0);a=Math.pow(10,e);j=Math.floor(j*a)/a;if(h&&h.fLen)e=j.toString().indexOf("."),j.toString().length<=h.fLen?(e=parseInt(j,10).toString().length,j=j.toFixed(h.fLen-e)):h.fLen<j.toString().length&&(j=j.toString(),j=e>0&&e<3?j.substr(0,4):j.substr(0,3));
h=j.toString().replace(/\.0+$/,"");h+=f[0];j===0&&(h=0);return h}}});define("util/fileIcon",[],function(){return{getFileIcon:function(j){var h="unknow",f={xls:/xls|xlsx/i,pdf:/pdf/i,ppt:/ppt|pptx/i,word:/doc|docx|wps/i,txt:/txt/i,pic:/jpg|jpeg|jpgx|gif|bmp|png/i,music:/mp3|wma|midi|aac/i,video:/mp4|rm|rmvb|mpeg|mov|avi|3gp|amv|dmv|flv|wmv|qsed|asf/i,zip:/rar|zip|tar|cab|uue|jar|iso|7z|ace|lzh|arj|gzip|bz2/i,code:/ink|torrent|url|vbs|tif|w3g|vbe|ssf|dll|mht|rcd|bat|sav|dat|cmd|ttf|xml|vob|sgs|mhw|js|html|htm|css/i,
exe:/exe|msi|apk|ipa/i},e;for(e in f)if(f[e].test(j)){h=e;break}return h}}});define("modules/client_hummer",[],function(){function j(){var a=top.external&&top.external.CallHummerApi;if(a){var i;try{i=a.apply(this,arguments),i=JSON.parse(i)}catch(c){return false}return i}return false}function h(a,i,c,g){if(!top||typeof top.external!=="object"||!("CallHummerApi"in top.external))return a="CallHummerApi\u63a5\u53e3\u4e0d\u5b58\u5728!",d&&d&&(a+=d),top?typeof top.external!=="object"?a+="!top.external is not object":
"CallHummerApi"in top.external||(a+="CallHummerApi not in top.external"):a+="|top is null",f({type:"error",msg:a,url:"src:",report:"ERR_CLT_HUMMERAPI_NOT_EXIST"}),top&&top.confirm?top.confirm(i):true;typeof c==="undefined"&&(c=2);typeof g==="undefined"&&(g="\u63d0\u793a");i={text:i,iconType:c,title:g};i=JSON.stringify(i);if((a=j("Window."+a,i))&&a.errorCode===0&&"ret"in a)return a.ret}var f=window.g_log,e={},a=null,d=window.external&&window.external.CallHummerApi&&window.external.CallHummerApi("IM.GetVersion");
e.IsOnline=function(){return window.G_DEBUG?true:j("Contact.IsOnline")?j("Contact.IsOnline").online:false};e.OpenContactInfoCard=function(a,i){return j("Contact.OpenContactInfoCard",'{ "uin" : "'+a+'", "tabId" : '+(i||1)+" }")};e.GetNickName=function(b){if(a)return a;var i={uin:b+""},i=JSON.stringify(i);if((i=j("Contact.GetNickName",i))&&i.errorCode===0&&i.nickName)a=i.nickName;return!a?b:a};e.getClientKey=function(){return j("IM.GetClientKey")};e.confirm=function(a,i,c){return h("Confirm",a,i,c)};
e.alert=function(a,i,c){return h("Alert",a,i,c)};e.preview=function(a){a+="&pictype=scaled&size=1024*1024";j("Misc.OpenWebPic",'{"url":"'+a+'"}')};return e});define("util/group",["../modules/client_hummer"],function(){function j(f,e,a){f.sort(a);for(var a={},d=[],b=0;b<f.length;b++){var i=f[b],c=e(i);a[c]||(a[c]=[]);a[c].push(i)}for(var g in a)d.push({title:g,data:a[g]});return d}function h(f,e,a,d){for(var b=[],i=0;i<a.length;i++)b[i]={title:a[i],data:[]};f.sort(d);for(i=0;i<f.length;i++)a=f[i],
d=e(a),b[d].data.push(a);f=[];for(i=0;i<b.length;i++)b[i].data.length>0&&f.push(b[i]);return f}return{group:function(f,e,a,d,b){f=f.map(function(a){return a});if(e==="fixed")return h(f,a,d,b);else if(e==="free")return j(f,a,b)}}});define("util/groupData",["./group"],function(j){function h(a){return j.group(a,"fixed",function(a){return a.size_type},"\u5927\u4e8e100MB,50-100MB,10-50MB,1-10MB,100KB-1MB,0-100KB".split(","),function(a,b){var g=b.filesize-a.filesize;g===0&&(g=b.createtime-a.createtime);
return g})}function f(a){return j.group(a,"free",function(a){return a.day_str},null,function(a,b){return b.createtime-a.createtime})}function e(a){return j.group(a,"fixed",function(a){a=a.type_str;return a=="\u6587\u6863"?0:a=="\u56fe\u7247"?1:a=="\u97f3\u4e50"?2:a=="\u89c6\u9891"?3:a=="\u538b\u7f29\u5305"?4:5},"\u6587\u6863,\u56fe\u7247,\u97f3\u4e50,\u89c6\u9891,\u538b\u7f29\u5305,\u5176\u4ed6".split(","),function(a,b){return b.createtime-a.createtime})}function a(a){for(var a=j.group(a,"free",function(a){return a.uploadnick+
a.uploaduin},null,function(a,b){var c=a.uploadnick.toUpperCase()+a.uploaduin,i=b.uploadnick.toUpperCase()+a.uploaduin,c=c.localeCompare(i);c===0&&(c=b.createtime-a.createtime);return c}),i=0;i<a.length;i++){var c=a[i];c.uin=c.data[0].uploaduin;c.nick=c.data[0].uploadnick;c.title=c.data[0].uploadnick;if(i>0&&a[i-1]&&a[i-1].nick==c.nick)c.title=c.nick+" ("+c.uin+")",c=a[i-1],c.title=c.nick+" ("+c.uin+")"}return a}function d(a){return j.group(a,"fixed",function(a){a=a.downloadtimes;return a<10?5:a<30?
4:a<50?3:a<100?2:a<500?1:0},"500\u6b21\u4ee5\u4e0a,100-500\u6b21,50-100\u6b21,30-50\u6b21,10-30\u6b21,10\u6b21\u4ee5\u4e0b".split(","),function(a,b){var g=b.downloadtimes-a.downloadtimes;g===0&&(g=b.createtime-a.createtime);return g})}return{groupData:function(b,i){i||(i={});var c=i.sortBy;c||(c="time");var g;c==="time"?g=f(b):c==="uploader"?g=a(b):c==="type"?g=e(b):c==="size"?g=h(b):c==="download"&&(g=d(b));return g}}});define("util/xss",[],function(){var j=function(){var h=/"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g,
f=/&\w+;|&#(\d+);/g,e={"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" ","&quot;":'"',"&copy;":""};return{encodeHtml:function(a){a=a!=void 0?a:"";return typeof a!="string"?a:a.replace(h,function(a){var a=a.charCodeAt(0),b=["&#"];b.push(a==32?160:a);b.push(";");return b.join("")})},decodeHtml:function(a){a=a!=void 0?a:"";a=typeof a!="string"?a:a.replace(f,function(a,b){var i=e[a];i==void 0&&(i=isNaN(b)?a:String.fromCharCode(b==160?32:b));return i});a=a.replace(/&#x2028;/g,"\u2028");return a=a.replace(/&#x2029;/g,
"\u2029")}}}();return{xssHtml:j.encodeHtml,xssNoEsc:j.decodeHtml}});define("util/parameter",[],function(){return{getParameter:function(j){j=location.href.match(RegExp("(\\?|#|&)"+j+"=([^&#]*)(&|#|$)"));return!j?"":j[2]}}});define("util/throttle",[],function(){return{throttle:function(j,h,f){var h=h||3E3,e=0,a,d,b=function(){d=arguments.length>0?arguments:d;var i=(new Date).getTime(),c=i-e;c>=h?(j.apply(f,d),e=i):(clearTimeout(a),a=setTimeout(function(){b.apply(f,d)},h-c))};return b}}});define("util/util",
"./date,./fileicon,./fileType,./fileSize,./fileIcon,./group,./groupData,./xss,./parameter,./throttle".split(","),function(){for(var j=arguments,h={},f=0;f<j.length;f++){var e=j[f],a;for(a in e)h[a]=e[a]}return h});define("modules/local",[],function(){function j(){if(!window.g_flag_local_enable)return null;if(!o){var a=i[g];if(a){var a=JSON.parse(a),b=a.flist;if(b){var c=b.length,l=[];k={};for(var e=0;e<c;e++){for(var d={},f=b[e],m=0;m<r;m++)d[q[m]]=f[m];if(d.ufs===-1)d.ufs=d.fs;l.push(d);k[d.fp]=
d}a.flist=l}o=a}}return o}function h(a){o=a;try{var b;if(a.flist){k={};var c={flist:[]},l=a.flist,d;for(d in a)d!="flist"&&(c[d]=a[d]);var e=l.length;for(d=0;d<e;d++){var f=[],m=l[d];k[m.fp]=m;for(var h=0;h<r;h++)q[h]=="ufs"&&m.ufs==m.fs?f.push(-1):f.push(m[q[h]]);c.flist.push(f)}b=JSON.stringify(c)}else b=void 0;i[g]=b}catch(j){console.error(j);try{i.clear(),i[g]=JSON.stringify(a)}catch(p){}}}function f(){if(!window.g_flag_local_enable)return null;if(!p){var a=i[l];p=a?JSON.parse(a):[]}return p}
function e(a){p=a;try{var b=JSON.stringify(a);i[l]=b}catch(c){console.error(c);try{i.clear(),i[l]=JSON.stringify(a)}catch(g){}}}function a(){if(!window.g_flag_local_enable)return null;if(!n){var a=i[m];n=window.g_i_ifFileExist&&a?JSON.parse(a):{}}return n}function d(a){n=a;try{var b=JSON.stringify(a);i[m]=b}catch(c){console.error(c);try{i.clear(),i[m]=JSON.stringify(a)}catch(g){}}}var b={},i=window.localStorage,c,g,l,m,o,k,p,n,q="dt,exp,fn,fp,fs,mt,t,ufs,uin,ut".split(","),r=q.length;b.init=function(d){c=
d;if(i.gs_version!=12)i.clear(),i.gs_version=12;g="cgi_12_"+c.groupid+"_"+c.uin;l="clist_12_"+c.groupid+"_"+c.uin;m="lp_12_"+c.groupid+"_"+c.uin;b.lpData=a();b.clistData=f();b.cgiData=j()};b.version=12;b.cgi={};b.cgi.get=j;b.cgi.set=h;b.cgi.update=function(a){var b=a.fp;if(k&&k[b]){var b=k[b],c;for(c in a)b[c]=a[c];h(o)}};b.cgi.remove=function(a){if(o&&o.flist&&k){var b=o.flist;if(a=k[a])a=b.indexOf(a),a>=0&&(b.splice(a,1),h(o))}};b.clist={};b.clist.get=f;b.clist.set=e;b.clist.add=function(a){p||
(p=[]);p.unshift(a);e(p)};b.clist.clear=function(){delete i[l];p=null};b.lp={};b.lp.get=a;b.lp.set=d;b.lp.add=function(a,b){n||(n={});n[a]=b;d(n)};b.lp.remove=function(a){n&&n[a]&&delete n[a];d(n)};b.clearAll=function(){for(var a in i)delete i[a]};b.key={};b.key.cgi=g;b.key.clist=l;b.key.lp=m;return b});define("modules/cleanData",["../util/util","./local"],function(j,h){function f(b,i,c){var g=h.lp.get();if(g&&g[b.fp]&&b)b._localpath=g[b.fp];g=0;if(b&&b.filename){if(b.filepath)b.filepath=b.filepath.replace(/\\\//g,
"/");if(!b.remotetype)switch(b.busid){case 102:b.remotetype=a;break;case 104:case 105:b.remotetype=d;break;default:b.remotetype=a}if(b.uploadsize<b.filesize){if(b.uploaduin===i.uin){b.type="continueupload";b.status="continue";b.is_continue_upload=true;b.task_starttime=b.createtime;b.styles="upload pause";b.completesize=b.uploadsize;b.csize_str=j.getFileSize(b.uploadsize);b.c_percent=0;if(b.uploadsize&&b.filesize)b.c_percent=100*b.uploadsize/b.filesize;b.not_complete=true;g=1}}else{g=2;b.auditflag>
0&&console.warn("auditFlag",b);var l=b.filename,e=b.filesize,f=b.createtime;if(!b.downloadtimes)b.downloadtimes=0;var k=l.lastIndexOf(".");k>=0?(b.filename_name=l.substr(0,k),b.filename_suf=l.substr(k)):(b.filename_name=l,b.filename_suf="");b.file_icon=j.getFileIcon(b.filename_suf);b.isAdmin=c||b.uploaduin===i.uin?true:false;b.filesize_str=j.getFileSize(e);b.createtime_str=j.getDateStr(f);b.day_str=j.dayStr(f);b.type_str=j.getFileType(b.filename_suf);if(b.type_str==="\u56fe\u7247"&&(g=3,!i.isVisitor))b.can_preview=
true;if(b.remotetype===d&&b.isAdmin)b.can_forever=true;if(b.day_str==="\u4eca\u5929")b.createtime_str=j.getHourStr(f);if(b.day_str==="\u6700\u8fd1\u4e09\u5929")b.createtime_str=j.strYesterdayOrPre(f);i=0;e<102400?i=5:e<1048576?i=4:e<10485760?i=3:e<52428800?i=2:e<104857600&&(i=1);c=[];if(b.isAdmin)b.can_delete=true,b.can_rename=true,c.push("can_delete=1 "),c.push("can_rename=1 ");b.can_preview&&c.push("can_preview=1 ");b.can_forever&&c.push("can_forever=1 ");b.can_do=c.join("");b.style_disable_more=
"";if(b.can_do==="")b.style_disable_more="disable_more";b.size_type=i;if(!b.style_istemp)b.style_istemp="";if(!b.style_issucc)b.style_issucc="";b.expire_str="";b.file_title=b.filename;if(b.remotetype===d)b.style_istemp="temp",b.expire_str=j.getExpriesDayNum(b.ttl)+"\u5929\u540e\u5230\u671f",b.file_title+=" (\u4e34\u65f6\u6587\u4ef6\uff1a\u5269\u4f59"+j.getExpriesDayNum(b.ttl)+"\u5929)"}return g}}function e(a,i){var c=a||{},g=c.flist,d={},e=c.name_list;e||(e=[]);e.forEach(function(a){d[a.u]=a.n});
i.uins=d;var e=c.ismanager,o=c.role,k=false,c=c.isPublic;o&&(e=0,o>=4?e=1:o===1&&c===1&&(k=true));g||(g=[]);c={isVisitor:k,listData:[],boxData:[],imgData:[]};for(o=0;o<g.length;o++){k=g[o];if(k.fn){k.filename=k.fn;k.filename_esc=j.xssNoEsc(k.filename);k.filepath="/"+k.t+k.fp;if(k.lp)k.localname=j.xssNoEsc(k.lp),k.localname=k.localname.replace(/\\|\//g,"\\\\");k.filesize=k.fs;k.uploaduin=k.uin;k.busid=k.t;k.ttl=Math.floor(new Date(k.exp*1E3)-new Date)/1E3;k.createtime=k.ut;k.updatetime=k.mt;k.downloadtimes=
k.dt;k.uploadnick=d[k.uin];k.uploadsize=k.ufs;if(k.ufs===null)k.uploadsize=k.filesize}var h=f(k,i,e);if(h==1)c.boxData.push(k);else if(h==2||h==3)c.listData.push(k),h==3&&c.imgData.push(k)}return c}var a=1,d=2;return function(){var a={};a.cleanItem=f;a.cleanArray=e;return a}()});define("modules/view/list/setThumb",[],function(){function j(a){a instanceof Array?a.forEach(function(a,b){setTimeout(function(){h(a)},parseInt(b/2,10)*300)}):h(a)}function h(a){e++;if(!(a.filesize>20971520)){var d=document.getElementById("list_"+
a.filepath),b=a.thumbUrl;if(b&&!f[b]){b+="&pictype=scaled&size=50*50";var i=new Image;i.onload=function(){if(i.complete){if(d&&a.thumbUrl){var c=d.firstChild.firstChild;c.className="thumb";c.style.backgroundImage="url("+b+")";g_report("img_thumb_load_succ")}e--}};i.onerror=function(){e--};i.src=b;g_report("img_thumb_load")}}}var f={},e=0;return function(){var a={};a.setThumb=j;return a}()});define("util/domCache",[],function(){function j(a,d){var b=f.indexOf(a);b>=0?e[b]=d:(f.push(a),e.push(d))}function h(a){a=
f.indexOf(a);return a>=0?e[a]:null}var f=[],e=[];return function(){var a={};a.add=j;a.get=h;return a}()});define("modules/view/list",["../../util/util","../cleanData","./list/setThumb","../../util/domCache"],function(j,h,f,e){function a(){m.innerHTML="";m.classList.add("empty");k.innerHTML="\u6682\u65e0\u6587\u4ef6"}function d(a,c){m.scrollTop=0;for(var g=m.innerHTML="",d=0,l=false,f,k=0;k<a.length;k++){var h=a[k],j=h.title,p=h.uin||k,n=h.data;d>20&&(l=true);var q=document.createElement("div");c.target&&
c.target==h.uin&&(f=k);q.innerHTML=l||c.target&&h.uin&&c.target!=h.uin?"<div class='group_title collapse' data-action='group_toggle' id='group_"+k+"' name='group_"+p+"'><i></i>"+j+"</div>":"<div class='group_title' data-action='group_toggle' id='group_"+k+"' name='group_"+p+"'><i></i>"+j+"</div>";p=document.createElement("div");p.innerHTML=l||c.target&&h.uin&&c.target!=h.uin?"<div class='group collapse'></div>":"<div class='group open'></div>";p=p.childNodes[0];m.appendChild(q.childNodes[0]);m.appendChild(p);
for(q=0;q<n.length;q++){var r=n[q],x=e.get("list_"+r.filepath);x?(p.appendChild(x),b(x,r)):(x=document.createElement("div"),x.innerHTML=i(r),p.appendChild(x.childNodes[0]))}n="";k===0&&(n="shown");g+=l||c.target&&h.uin&&c.target!=h.uin?"<div class='group_title_top collapse "+n+"' data-action='link_to' tid='group_"+k+"' id='tgroup_"+k+"'><i></i>"+j+"</div>":"<div class='group_title_top "+n+"' data-action='link_to' tid='group_"+k+"' id='tgroup_"+k+"'><i></i>"+j+"</div>";c.target||(d+=q)}m.scrollTop=
f?26*f:0;m.classList.remove("empty");o.innerHTML=g}function b(a,b){var c=a.querySelector(".c1"),g=i(b),e=g.indexOf('<div class="c1">')+16,d=g.indexOf('<div class="c2">')-6,g=g.substr(e,d-e);c.innerHTML=g}function i(a){var b="";if(a._localpath)a.style_issucc="succ";var c=" "+a.style_issucc||"",g="img",i="",e="",d="",l='data-action="file_active"',k="",f=a.file_title;a.thumbUrl&&(i=' style="background-image:url('+a.thumbUrl+');"',g="thumb");a.can_preview&&(e=' title="\u9884\u89c8\u56fe\u7247"',d=' data-action="img_preview"',
l=' data-action="preview_filename"',k=" imgFile",f="\u9884\u89c8\u56fe\u7247 : "+a.file_title);b+='<div class="file  '+a.style_istemp+c+k+'" id="list_'+a.filepath+'"'+l+">";b+='<div class="c0 icon '+a.file_icon+'">';b+='<div class="'+g+'"'+i+e+d+"></div><i></i></div>";b+='<div class="c1">';b+='<div class="filename" title="'+f+'">';b+='<div class="name">'+a.filename_name+"</div>";b+='<div class="suffix">'+a.filename_suf+"</div>";b+='<div class="security"></div>';b+='<div class="tempicon" title="\u4e34\u65f6\u6587\u4ef6:'+
a.expire_str+'"></div>';b+="</div>";b+='<div class="file_info">';b+='<span class="file_size" title="\u6587\u4ef6\u5927\u5c0f:'+a.filesize_str+'">'+a.filesize_str+"</span>";b+='<span class="file_dot">.</span>';b+='<span  title="\u4e0b\u8f7d\u6b21\u6570:'+a.downloadtimes+'\u6b21">';b+='<span class="downloadtime">'+a.downloadtimes+"\u6b21\u4e0b\u8f7d</span>";b+="</span>";b+='<span class="uploader"  title="\u4e0a\u4f20\u8005:'+a.uploadnick+'">';b+='<i class="uploader_name" data-action="go_uploader" upload_uin="'+
a.uploaduin+'">'+a.uploadnick+"</i></span>";b+='<span class="uploadtime" title="\u4e0a\u4f20\u65f6\u95f4:'+a.createtime_str+'">';b+=a.createtime_str+"</span>";b+="</div>";b+="</div>";b+='<div class="c2">';b+='<div class="btn_group">';b+=a.style_issucc=="succ"&&window.g_i_openfolder?'<span class="btn_left chakan" data-action="open_folder3" title="\u67e5\u770b">\u67e5\u770b</span>':'<span class="btn_left download" data-action="file_download" title="\u4e0b\u8f7d">\u4e0b\u8f7d</span>';b+='<span class="file_more" data-action="file_more" menu="file_menu" title="\u66f4\u591a"></span>';
b+="</div>";b+="</div>";b+="</div>";return b}function c(b,c,g){b?q=b:b=q;g=b.length;if(!b||!b.length)a();else{b.length>0&&m.classList.remove("empty");for(var f=0;f<b.length;f++)var h=b[f];k.innerHTML="\u5171"+g+"\u4e2a\u6587\u4ef6";c?n=c.sortBy:c={sortBy:n};c.sortBy=="uploader"?m.classList.add("sortby_uploader"):m.classList.remove("sortby_uploader");g=j.groupData(b,c);if(r){for(var h=c="",B=0,A=false,u=0;u<g.length;u++){var w=g[u],y=w.title,f=w.uin||u,w=w.data;B>20&&(A=true);A?(c+="<div class='group_title collapse' data-action='group_toggle' id='group_"+
u+"' name='group_"+f+"'><i></i>"+y+"</div>",c+="<div class='group collapse'>"):(c+="<div class='group_title' data-action='group_toggle' id='group_"+u+"' name='group_"+f+"'><i></i>"+y+"</div>",c+="<div class='group open'>");for(f=0;f<w.length;f++)c+=i(w[f]);c+="</div>";B+=f;f="";u===0&&(f="shown");h+=A?"<div class='group_title_top collapse "+f+"' data-action='link_to' tid='group_"+u+"' id='tgroup_"+u+"'><i></i>"+y+"</div>":"<div class='group_title_top "+f+"' data-action='link_to' tid='group_"+u+"' id='tgroup_"+
u+"'><i></i>"+y+"</div>"}m.scrollTop=0;m.classList.remove("empty");m.innerHTML=c;o.innerHTML=h;p++;setTimeout(function(){m.scrollHeight<=m.clientHeight?o.classList.add("notfull"):o.classList.remove("notfull")},20);r=false;l.push("main","pageRender");if(!window.g_page_rendered)window.g_page_rendered=true,l.report("flag1=7809&flag2=1&flag3=57","main",{domStart:"1",cssLoad:"2",thirdLib:"3",mainStart:"4",cgiReturn:"5",pageRender:"6"});for(f=0;f<b.length;f++)h=b[f],g="list_"+h.filepath,e.add(g,document.getElementById(g))}else d(g,
c)}}function g(b,c){document.getElementById("file_num").innerHTML=c&&c.length>0?"\u5171"+c.length+"\u4e2a\u6587\u4ef6":"\u6682\u65e0\u6587\u4ef6";var g=document.getElementById("list_"+b);if(g){var i=g.parentNode;g_remove_ease(g);setTimeout(function(){var a=i.childNodes.length,b=i.querySelectorAll(".remove");a-=b.length;if(b=i.previousSibling){var c=document.getElementById("t"+b.id);if(a===0)a=i.parentNode,a.removeChild(i),a.removeChild(b),c.parentNode.removeChild(c)}},330)}(!c||c.length===0)&&a()}
var l=window.TRecord,m=document.getElementById("file_list"),o=document.getElementById("group_top"),k=document.getElementById("file_num"),p=1,n,q,r=true;return function(){var a={};a.setThumb=f.setThumb;a.renderList=c;a.updateRowDiv=b;a.removeRow=g;return a}()});define("modules/view/box",["../../util/util","../../util/domCache"],function(j,h){function f(a,b){var c=document.getElementById("box"),c=b?false:!c.classList.contains("open"),g=document.getElementById("box_num"),i=a,e="";a===0?(i="",c&&(e="hint")):
a<10?e="small":a>=10&&a<100?e="big":a>=100&&(i=99,e="big");g.innerHTML=i;g.className="box_num "+e}function e(a){var b=document.getElementById("box_list");a===0?b.classList.add("empty"):b.classList.remove("empty")}function a(a){var b=document.getElementById("box_title");a===0?b.classList.add("empty"):b.classList.remove("empty")}function d(b,c){if(b){for(var g=0;g<b.length;g++){var d=b[g];if(!d||!d.status)console.warn("updateBoxRow obj=["+d+"]");else{var l=h.get(d),j=document.getElementById("box_list");
if(l)if(d.status==="remove")g_remove_ease(l);else{j="file2 ";window.g_i_openfolder&&(j+="file2_2 ");j+=d.styles;l.className=j;var r=j=void 0,j=l.querySelector(".wording"),r=l.querySelector(".bar");j.innerHTML=d.wording;r.style.width=d.c_percent>0?d.c_percent+"%":"0%"}else d=i(d),j.childNodes.length>0?j.insertBefore(d,j.childNodes[0]):j.appendChild(d)}}d=c.plist;l=[];for(g=0;g<d.length;g++)d[g].status.indexOf("remove")<0&&l.push(d[g]);g=c.clist;f(l.length);e(d.length+g.length);a(g.length)}}function b(b,
c){var d=b.plist,j=b.clist;d||(d=[]);j||(j=[]);c&&(l=false);if(l)f(d.length);else{var n;n=j;var q=document.getElementById("box_list");if(n.length>=g){q.classList.add("overflow");for(var q=[],r=0;r<g;r++)q.push(n[r]);n=q}else q.classList.remove("overflow");n=d.concat(n);q=document.getElementById("box_list");for(r=0;r<n.length;r++){var s=n[r];if(s&&!h.get(s)){var s=i(s),t=q.firstChild;!t||s&&s.classList.contains("complete")?q.appendChild(s):q.insertBefore(s,t)}}f(d.length,true);l=true;e(d.length+j.length);
a(j.length)}}function i(a){var b=document.createElement("div");b.obj=a;h.add(a,b);var c="file2 ";window.g_i_openfolder&&(c+="file2_2 ");c+=a.styles;b.className=c;var g=c="";a.localpath_changed==true&&(g=" disable");c+='<div class="c0 icon '+a.file_icon+'"><div class="img"></div><i></i></div>';c+='<div class="c1">';c+='<div class="filename'+g+'"  data-action="task_openFolder2" >';c+='<div class="name">'+a.filename_name+" </div>";c+='<div class="suffix">'+a.filename_suf+"</div>";c+="</div>";c+='<div class="loading"><div class="bar" style="width:'+
a.c_percent+'%;"></div></div>';c+='<div class="wording">'+a.wording+"</div>";c+="</div>";c+='<div class="c2">';c+='<i class="seat"></i>';c+='<i class="pause" data-action="task_pause" title="\u6682\u505c"></i>';c+='<i class="resume" data-action="task_resume" title="\u542f\u52a8"></i>';c+='<i class="continue" data-action="task_continue" title="\u7eed\u4f20"></i>';c+='<i class="remove" data-action="task_remove" title="\u5220\u9664"></i>';c+='<i class="ok_upload"></i>';c+='<i class="ok_download"></i>';
c+='<i class="go_folder'+g+'" data-action="task_openFolder" title="\u67e5\u770b"></i>';c+="</div>";b.innerHTML=c;return b}function c(b,c){document.getElementById("box_list").classList.remove("overflow");b||(b=[]);for(var g=0;g<b.length;g++){var d=h.get(b[g]);g_remove_ease(d)}setTimeout(function(){var b=c.plist,g=c.clist;f(b.length);e(b.length+g.length);a(g.length)},350)}var g=200,l=false;return function(){var a={};a.renderBox=b;a.updateBox=d;a.renderBoxNum=f;a.clearBox=c;return a}()});define("modules/app.view",
["./view/list","./view/box"],function(j,h){var f={};f.renderList=j.renderList;f.removeListRow=j.removeRow;f.setThumb=j.setThumb;f.updateRowDiv=j.updateRowDiv;f.renderBox=h.renderBox;f.updateBox=h.updateBox;f.addBoxRow=h.addBoxRow;f.updateBoxRow=h.updateBoxRow;f.renderBoxNum=h.renderBoxNum;f.clearBox=h.clearBox;return f});define("common/db.ajax",[],function(){function j(){var a=i;if(typeof a==="undefined")return h();if(a!==-2){if(a===-1)return new XMLHttpRequest;a=b[a];if(typeof a==="string")return new ActiveXObject(a)}}
function h(a){var c;try{if(a)throw 123;c=new XMLHttpRequest;i=-1}catch(g){for(var a=b,d=a.length,e=0;e<d;e++){try{c=new ActiveXObject(a[e]),i=e}catch(f){continue}break}}finally{return c||(i=-2),c}}function f(a){c++;g["xhr_"+c]=a;return c}function e(a){a="xhr_"+a;a in g&&(g[a]=null,delete g[a])}function a(a,b,c,g,d){var n=j();try{n.open(g,a,true)}catch(q){i===-1&&(i=void 0,n=h(true),n.open(g,a,true))}var r=f(n),d=d||{},s=d.type||"json",t=d.timeout,a=d.timeout_ms,v;if(typeof t==="function"){if(!a||
a<5E3)a=5E3;v=setTimeout(function(){clearTimeout(v);n.abort();e(r);n=null;t()})}n.onreadystatechange=function(){n.readyState===4&&(v&&clearTimeout(v),n.status>=200&&n.status<300||n.status===304||n.status===1223||n.status===0?s==="json"&&n.responseText?c(eval("("+n.responseText+")")):c(n.responseText):c({ec:n.status}),e(r),n=null)};n.send(b);return r}var d={},b=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],i,c,g={};d.ajax=a;d.post=function(b,c,g,d){var i="",e;for(e in c)i+=
"&"+e+"="+encodeURIComponent(c[e]);return a(b,i,g,"POST",d)};d.get=function(b,c,g,d){var i=[],e;for(e in c)i.push(e+"="+encodeURIComponent(c[e]));b.indexOf("?")===-1&&(b+="?");b+=i.join("&");return a(b,null,g,"GET",d)};return d});define("common/db.formPost",[],function(){var j=1;return function(h,f,e){j++;var a,d;a=document.createElement("form");a.method="post";a.name="fk_form"+j;a.className="hide";a.action=h;a.target="fk_iframe"+j;d=document.createElement("iframe");d.name="fk_iframe"+j;d.style.position=
"absolute";d.style.width=0;d.style.height=0;a.style.position="absolute";a.style.width=0;a.style.height=0;document.body.appendChild(d);document.body.appendChild(a);d.callback=function(){e.apply(null,arguments);document.body.removeChild(a);document.body.removeChild(d)};for(var b in f)h=document.createElement("input"),h.name=b,h.value=decodeURIComponent(f[b]),a.appendChild(h);a.submit()}});(function(j,h){typeof define==="function"&&define.amd?define("common/login",[],h):j.Login=h()})(this,function(){var j=
function(){var e,a=top.external;if("CallHummerApi"in a){try{e=a.CallHummerApi("IM.GetClientKey"),e=JSON.parse(e)}catch(d){}if(e&&e.errorCode===0&&e.clientKey)return e.clientKey}if("Hummer_IM_GetClientKey"in a){try{e=a.Hummer_IM_GetClientKey(),e=JSON.parse(e)}catch(b){}if(e&&e.clientKey)return e.clientkey}},h=function(){var e=function(){function a(a){a=document.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)"));return!a?"":decodeURIComponent(a[2])}return{get:a,uin:function(){var d=a("uin");return!d?null:
parseInt(d.substring(1,d.length),10)}}}();return function(){var a;if(!(a=e.uin()))a:{var d;a=top.external;if("CallHummerApi"in a){try{d=a.CallHummerApi("Contact.GetSelfUin"),d=JSON.parse(d)}catch(b){}if(d&&d.errorCode===0&&d.uin){a=d.uin;break a}}a=void 0}return a}}(),f="http://"+window.location.hostname+"/clt_filetab/loginproxy.html";return{notLoginCallback:function(e){var a=j(),d=h();if(a&&d){var b=e.loginproxy||f,i=document.createElement("iframe");i.onload=function(){e&&typeof e.succ=="function"&&
e.succ();i.onload=null;document.body.removeChild(i);i=null};i.src="http://ptlogin2.qq.com/jump?clientuin="+d+"&clientkey="+a+"&u1="+encodeURIComponent(b);document.body.appendChild(i)}else console.error("clientkey && clientUin not defined! fallback with Login Box"),e&&typeof e.err=="function"&&e.err()}}});define("common/cookie",[],function(){function j(h){h=document.cookie.match(RegExp("(^| )"+h+"=([^;]*)(;|$)"));return!h?"":decodeURIComponent(h[2])}return{get:j,del:function(h,f,e){document.cookie=
h+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(e?e:"/")+"; "+(f?"domain="+f+";":"")},uin:function(){var h=j("uin");return!h?null:parseInt(h.substring(1,h.length),10)}}});define("modules/cgi",["../common/db.ajax","../common/db.formPost","../common/login","../common/cookie"],function(j,h,f,e){function a(b,c){if(!l||!l.isVisitor){r||(r=b.slice(0,10));var g=b.slice(0,10),e=b.slice(10);g.length&&(o&&clearTimeout(o),k&&clearTimeout(k),o=setTimeout(function(){a:{if(g.length==1){var a=g[0];if(q[a.filepath]){var b=
q[a.filepath];if(new Date-b.t<18E4&&a.usedtimes<3){c(g,{ec:0,address_list:[b]});break a}}}for(var a=Math.floor((new Date).getTime()/1E3),e="",b=0;b<g.length;b++){b>0&&(e+=":");var f=g[b],h=f.filepath,j=f.remotetype,k=f.filename;(f=f.fp)||(f=h.substr(4));f=(j==1?0:1)+"<"+f+"<"+escape(k);e+=f;g[b].thumbUrlLoading=true}i("http://pan.qun.qq.com/cgi-bin/thumbnail",{id:a,gc:l.groupid,fp_list:e},g_hitch(d,g,c))}},p));e&&e.length&&(k=setTimeout(function(){a(e,c)},n))}}function d(a,b,c){if(c.ec===0){if(!c.address_list)c.address_list=
[];for(var g=0;g<c.address_list.length;g++){var d=a[g],i=c.address_list[g];i.t=new Date;if(d)d.usedtimes=0,q[d.filepath]=i}b(a,c)}}function b(){for(var a=e.get("skey"),b=5381,c=0,g=a.length;c<g;++c)b+=(b<<5)+a.charCodeAt(c);return b&2147483647}function i(a,c,g){var d=0,i=setTimeout(function(){var b;a:{b={timeout_filelist:/filelist/g,timeout_permanent:/permanent/g,timeout_thumbnail:/thumbnail/g,timeout_delete:/delete/g};for(var c in b)if(b[c].test(a)){b=c;break a}b=void 0}g_log({type:"fail",msg:"CGI Timeout Error!"+
a,report:b});k({ec:600})},5E3),e=true,h,k=function(b){clearTimeout(i);b&&b.ec>=400&&b.ec<=600&&e&&(e=false,a&&a.indexOf("filelist")>0&&(b.ec>=400&&b.ec<500&&g_report("cgi_filelist_4xx"),b.ec>=500&&b.ec<600&&g_report("cgi_filelist_5xx")));b&&(b.ec==1||b.ec==4)?(h=b,d++,d>1?p(b):(f.notLoginCallback({succ:o,err:p}),g_log({type:"fail",msg:"CGI NoLogin Error! Ec :"+b.ec,report:"ERR_CGI_NOT_LOGIN"}))):g(b)},o=function(){d>1?p(h):(m=b(),c.bkn=m,l.token=m,j.post(a,c,k))},p=function(){g(h);g_log({type:"error",
msg:"\u81ea\u52a8\u7eed\u671f\u5931\u8d25! ",report:"ERR_CGI_RELOGIN_FAILED"})};c.bkn=m;j.post(a,c,k)}function c(a,c,g){var d=0,i=function(a){a&&a.code==-3E3?(d++,d>1?j(a):(f.notLoginCallback({succ:e,err:j}),g_log({type:"fail",msg:"CGI NoLogin Error! Ec :"+a.ec,report:"ERR_CGI_NOT_LOGIN"}))):g(a)},e=function(){if(d>1)j(result);else{var g=b();l.token=g;h(a+"g_tk="+g,c,i)}},j=function(a){g(a);g_log({type:"error",msg:"\u81ea\u52a8\u7eed\u671f\u5931\u8d25! ",report:"ERR_CGI_RELOGIN_FAILED"})};h(a+"g_tk="+
m,c,i)}var g={},l,m,o,k,p=60,n=300,q={},r;g.init=function(a){l=a;m=l.token};g.getList=function(a){i("http://pan.qun.qq.com/cgi-bin/filelist",{gc:l.groupid,s:0,n:250},a)};g.getAllList=function(a){i("http://pan.qun.qq.com/cgi-bin/filelist",{gc:l.groupid,s:0,n:2E4},a)};g.getThumb=a;g.deleteFile=function(a,b){var g={};g.qzreferrer=window.location.href;g.uin=l.uin;g.groupid=l.groupid;g.filepatch=a;g.filepath=a;g.r=Math.random();g.charset="utf-8";c("http://qun.qzone.qq.com/cgi-bin/group_share_delete?",
g,b)};g.permanent=function(a,b){i("http://pan.qun.qq.com/cgi-bin/permanent",{fp:a,gc:l.groupid},b)};g.renameFile=function(a,b,c){i("http://pan.qun.qq.com/cgi-bin/rename",{gc:l.groupid,fp:a.fp,fn:b,t:a.t==102?1:2},c)};return g});define("modules/client_task",[],function(){var j={},h=top.external;j.getPlist=function(){var f={};if("getTaskList"in h){var e=h.getTaskList();typeof e!=="string"&&(e="");if(e==="")f.map={},f.status="busy";else if(e==="{}")f.map={},f.status="ok",f.empty=true;else{try{f.map=
JSON.parse(e)}catch(a){console.error("\u5ba2\u6237\u7aef\u63a5\u53e3getTaskList\u8fd4\u56de\u7684\u6570\u636e\u6709\u95ee\u9898?parse\u51fa\u9519["+e+"]")}typeof f.map==="object"&&f.map!==null?f.status="ok":(f.map={},f.status="parseerror")}}else f={map:{},status:"ok",empty:true};return f};j.getClist=function(){var f={};if("getCompleteTaskList"in h){var e=h.getCompleteTaskList();typeof e!=="string"&&(e="");if(e==="")f.map={},f.status="busy";else if(e==="{}")f.map={},f.status="ok",f.empty=true;else{try{f.map=
JSON.parse(e)}catch(a){console.error("\u5ba2\u6237\u7aef\u63a5\u53e3getCompleteTaskList\u8fd4\u56de\u7684\u6570\u636e\u6709\u95ee\u9898?parse\u51fa\u9519["+e+"]")}typeof f.map==="object"&&f.map!==null?f.status="ok":(f.map={},f.status="parseerror")}return f}else return{map:{},status:"ok",empty:true}};j.addUploadTask=function(f,e){f||(f=1);window.g_flag_upload_temp&&(f=2);return"addUploadTask"in h?h.addUploadTask(f,e):-1};j.addDownloadTask=function(f,e,a,d){return"addDownloadTask"in h?(a+="",h.addDownloadTask(f,
e,a,d)):-1};j.addContinueUploadTask=function(f,e,a,d){return"addContinueUploadTask"in h?h.addContinueUploadTask(f,e,a,d):-1};j.removeTask=function(f){return"removeTask"in h?h.removeTask(f):-1};j.removeCompleteTask=function(f){return"removeCompleteTask"in h?h.removeCompleteTask(f):-1};j.pauseTask=function(f){return"pauseTask"in h?h.pauseTask(f):-1};j.resumeTask=function(f){return"resumeTask"in h?h.resumeTask(f):-1};j.getTaskInfo=function(f){return"getTaskInfo"in h?h.getTaskInfo(f):'{"completesize":1446684444,"filename":"knight\u7684\u6d4b\u8bd5\u6587\u4ef6.mkv","filepath":"/102/8d589e6e-4996-4723-a22e-daada51b6540","filesize":1446684444,"id":1,"localpath":"OSRoot:\\\\C:\\\\knight\u7684\u6d4b\u8bd5\u6587\u4ef6.mkv","remotetype":0,"securityattri":2,"speed":0,"status":"complete","type":"download"}'};
return j});define("modules/client",["./client_task","./client_hummer"],function(j,h){function f(){var a=j.getClist();if(a.map)for(var d in a.map){var b=a.map[d];b.id&&j.removeCompleteTask(b.id)===-1&&console.warn("\u79fb\u9664\u5b8c\u6210\u4efb\u52a1\u5931\u8d25\uff01")}}var e={};window.client=e;return function(){e.clearClist=f;for(var a in h)e[a]=h[a];for(a in j)e[a]=j[a];return e}()});define("modules/getInfo",["../common/cookie","./client"],function(j,h){function f(){for(var a=j.get("skey"),d=5381,
c=0,g=a.length;c<g;++c)d+=(d<<5)+a.charCodeAt(c);return d&2147483647}function e(a){a=window.location.hash.match(RegExp("(#|&)"+a+"=([^&]*)(&|$)"));return!a?"":decodeURIComponent(a[2])}function a(a){a=window.location.search.match(RegExp("(\\?|&)"+a+"=([^&]*)(&|$)"));return!a?"":decodeURIComponent(a[2])}var d;return function(){var b=j.uin(),i=e("gid")||a("guin"),c=function(){var a="refresh_"+b+"_"+i;return j.get(a)*1?(j.del(a),true):false}();/^\d+$/.test(i)||(i=parseInt(i,10),isNaN(i)&&(i="0"));var g=
(e("visitor")||a("visitor"))==="1",l={uin:b,groupid:i,isVisitor:g,nickName:h.GetNickName(b),token:f(),fromRefresh:c};Object.defineProperty(l,"nickName",{get:function(){return l.uins&&l.uins[b]?l.uins[b]:d?d:d=h.GetNickName(b)},set:function(){}});(e("debug")||a("debug"))==="1"&&(window.G_DEBUG=1);return l}});define("modules/capacity",["../util/util"],function(j){var h,f;function e(){var c=h-f,g=h,e=c*100/g;c<0&&(c=0);var m=j.getFileSize(c)==="0B"?"0":j.getFileSize(c),g=j.getFileSize(g,{len:0}),o=m.replace(/^[0-9|\.|-|+]*/g,
""),k=g.replace(/^[0-9|\.|-|+]*/g,"");o===k&&(e=m.replace(/[^0-9]*$/,"")*100/g.replace(/[^0-9]*$/,""));c>0&&e<1&&(e=1);e>1&&e<99&&(e=Math.round(e));e>99&&e<100&&(e=99);e>=100&&(e=100);c=e;e>0&&e<17&&(c=17);c>100&&(c=100);isNaN(e);e=m.replace(".","\u70b9");o=g.replace(".","\u70b9");b.setAttribute("title","\u5df2\u4f7f\u7528"+c+"%");a.setAttribute("aria-label",e+"/"+o);d.style.width=c+"%";i.innerHTML=m+"/"+g}h=void 0;f=void 0;var a=document.getElementById("capacity"),d=document.getElementById("capacity_used"),
b=document.getElementById("capacity_size_bar"),i=document.getElementById("capacity_info");return{init:function(a){a&&(h=a.capacity||a.capacitytotal,f=a.surplus_capacity||a.capacitytotal-a.capacityused||0,h||(f=h=2147483648),e())},releaseSpace:function(a){f+=a;e()},holdSpace:function(a){f-=a;e()}}});define("modules/cleanTask.parser",[],function(){function j(a){if(!a||!a.type||!a.status)return"";var g=d[a.type]+"-"+a.status;if(g in i)return g==="upload-uploadsecurityfail"&&b[a.securityattri]?b[a.securityattri]:
i[g]}var h={ifError:function(a){return d[a.type]+"-"+a.status in i&&i?true:false}};h.getErrorWording=j;h.parseTask=function(b){var g=f[b.type];e[g]||console.warn("\u8bbe\u7f6ewording \u672a\u77e5\u4efb\u52a1\u7c7b\u578b=["+b.type+"]");e[g][b.status]||console.warn("\u8bbe\u7f6ewording \u672a\u77e5\u4efb\u52a1\u72b6\u6001=["+b.status+"]");a[g][b.status]||console.warn("\u8bbe\u7f6e\u6837\u5f0f \u672a\u77e5\u4efb\u52a1\u72b6\u6001=["+b.status+"]");var d=e[g][b.status],i=a[g][b.status];i==="scan"?(b.c_percent&&
(d+=b.c_percent+"%"),b.c_percent=0,i="pre"):i==="pre"?b.c_percent=0:i==="pause"||i==="continue"?(b.csize_str&&(d+=b.csize_str),b.filesize_str&&(d+=b.filesize_str)):i==="err"?(b.c_percent=0,b.status.indexOf("securityfail")>=0?(d="<i class='warn'></i>"+j(b),b.securityattri>=1&&b.securityattri<=5&&(d+="<i class='security'></i>")):(b.errorcode==-1E3&&(d="\u8be5\u6587\u4ef6\u5df2\u88ab\u5220\u9664"),d="<i class='warn'></i>"+d)):i==="progress"?b.speed_str&&(d+=b.speed_str):i==="complete"?(b.c_percent=100,
d+=b.filesize_str):b.c_percent=0;b.wording=d;b.style_type=g;if(g==="continueupload")b.style_type="upload";b.style_status=i;b.styles=b.style_type+" "+b.style_status};var f={upload:"upload",continueupload:"continueupload",download:"download"},e={upload:{scanning:"\u626b\u63cf\u4e2d...&nbsp;&nbsp;",scanfail:"\u626b\u63cf\u5931\u8d25&nbsp;&nbsp;",scanend:"\u626b\u63cf\u5b8c\u6210...&nbsp;&nbsp;",uploadgeturl:"\u51c6\u5907\u4e0a\u4f20...&nbsp;&nbsp;",uploadgeturlend:"\u4e0a\u4f20\u4e2d...&nbsp;&nbsp;",
uploadgeturlfail:"\u7533\u8bf7\u4e0a\u4f20\u5730\u5740\u5931\u8d25",uploadsecurityfail:"\u5b89\u5168\u626b\u63cf\u5931\u8d25",cancel:"\u7a7a\u95f4\u4e0d\u8db3,\u5df2\u53d6\u6d88\u4e0a\u4f20",uploadprogress:"\u4e0a\u4f20\u4e2d:&nbsp;&nbsp;",uploadfail:"\u4e0a\u4f20\u5931\u8d25",uploadcomplete:"\u4e0a\u4f20\u5b8c\u6210&nbsp;&nbsp;",pause:"\u6682\u505c&nbsp;&nbsp;","continue":"\u5f85\u7eed\u4f20&nbsp;&nbsp;"},download:{downloadready:"\u51c6\u5907\u4e0b\u8f7d...&nbsp;&nbsp;",downloadgeturl:"\u51c6\u5907\u4e0b\u8f7d...&nbsp;&nbsp;",
downloadgeturlfail:"\u83b7\u53d6\u4e0b\u8f7d\u5730\u5740\u5931\u8d25",cancel:"\u5df2\u53d6\u6d88\u4e0b\u8f7d&nbsp;&nbsp;",downloadgeturlend:"\u4e0b\u8f7d\u4e2d...",downloadprogress:"\u4e0b\u8f7d\u4e2d:&nbsp;&nbsp;",downloadfail:"\u4e0b\u8f7d\u5931\u8d25&nbsp;&nbsp;",downloadcomplete:"\u4e0b\u8f7d\u5b8c\u6210&nbsp;&nbsp;",pause:"\u6682\u505c&nbsp;&nbsp;"},continueupload:{scanning:"\u626b\u63cf\u4e2d...&nbsp;&nbsp;",scanfail:"\u626b\u63cf\u5931\u8d25&nbsp;&nbsp;",scanend:"\u626b\u63cf\u5b8c\u6210...&nbsp;&nbsp;",
uploadgeturl:"\u51c6\u5907\u7eed\u4f20...&nbsp;&nbsp;",uploadgeturlend:"\u7eed\u4f20\u4e2d...&nbsp;&nbsp;",uploadgeturlfail:"\u7533\u8bf7\u7eed\u4f20\u5730\u5740\u5931\u8d25",uploadsecurityfail:"\u5b89\u5168\u626b\u63cf\u5931\u8d25",cancel:"\u7a7a\u95f4\u4e0d\u8db3,\u5df2\u53d6\u6d88\u7eed\u4f20",uploadprogress:"\u7eed\u4f20\u4e2d:&nbsp;&nbsp;",uploadfail:"\u7eed\u4f20\u5931\u8d25",uploadcomplete:"\u7eed\u4f20\u5b8c\u6210&nbsp;&nbsp;",pause:"\u6682\u505c&nbsp;&nbsp;","continue":"\u5f85\u7eed\u4f20&nbsp;&nbsp;"}},
a={upload:{scanning:"scan",scanfail:"err",scanend:"scan",uploadgeturl:"pre",uploadgeturlend:"pre",uploadgeturlfail:"err",uploadsecurityfail:"err",cancel:"err",uploadprogress:"progress",uploadfail:"err",uploadcomplete:"complete",pause:"pause","continue":"continue",remove:""},download:{downloadready:"pre",downloadgeturl:"pre",downloadgeturlfail:"err",cancel:"err",downloadgeturlend:"pre",downloadprogress:"progress",downloadfail:"err",downloadcomplete:"complete",pause:"pause"},continueupload:{scanning:"scan",
scanfail:"err",scanend:"scan",uploadgeturl:"pre",uploadgeturlend:"pre",uploadgeturlfail:"err",uploadsecurityfail:"err",cancel:"err",uploadprogress:"progress",uploadfail:"err",uploadcomplete:"complete",pause:"pause","continue":"continue",remove:""}},d={upload:"upload",download:"download",continueupload:"upload"},b="\u5b89\u5168,\u626b\u63cf\u5230\u5371\u9669\u6587\u4ef6,\u626b\u63cf\u5230\u672a\u77e5\u98ce\u9669,\u626b\u63cf\u5230\u5b89\u5168\u98ce\u9669,\u626b\u63cf\u5230\u5b89\u5168\u98ce\u9669,\u626b\u63cf\u5230\u5b89\u5168\u98ce\u9669,\u6587\u4ef6\u5305\u542b\u654f\u611f\u8bcd".split(","),
i={"download-downloadgeturlfail":"\u4e0b\u8f7d\u5931\u8d25,\u8bf7\u7a0d\u5019\u518d\u8bd5","download-cancel":"","download-downloadfail":"\u4e0b\u8f7d\u5931\u8d25","upload-scanfail":"\u626b\u63cf\u5931\u8d25,\u8bf7\u7a0d\u5019\u518d\u8bd5","upload-uploadgeturlfail":"\u4e0a\u4f20\u5931\u8d25","upload-uploadsecurityfail":"\u4e0a\u4f20\u5b89\u5168\u626b\u63cf\u5931\u8d25","upload-cancel":"\u7a7a\u95f4\u4e0d\u8db3,\u5df2\u53d6\u6d88\u4e0a\u4f20","upload-uploadfail":"\u4e0a\u4f20\u5931\u8d25,\u8bf7\u7a0d\u5019\u518d\u8bd5"};
return h});define("modules/cleanTask",["../util/util","./cleanTask.parser"],function(j,h){function f(a){if(!a.filename_esc)a.filename_esc=a.filename,a.filename=j.xssHtml(a.filename);a.speed_str="";a.wording="";a.csize_str="";a.updateFlag=true;var d=a.filename,b=a.filesize;a.speed_str=j.getFileSize(a.speed);a.speed_str===0?a.speed_str="":a.speed_str+="/S";if(a.filesize===void 0)a.filesize=a.completesize;a.filesize_str=j.getFileSize(b);a.csize_str=j.getFileSize(a.completesize);a.csize_str+="/";b=0;
a.completesize>0&&a.filesize>0&&(b=Math.round(a.completesize*100/a.filesize));a.c_percent=b;b=d.lastIndexOf(".");b>=0?(a.filename_name=d.substr(0,b),a.filename_suf=d.substr(b)):(a.filename_name=d,a.filename_suf="");a.file_icon=j.getFileIcon(a.filename_suf);h.parseTask(a);return[a]}function e(a){var d=[],b;for(b in a){var e=a[b];f(e);d.push(e)}return d}return function(){var a={};a.cleanItem=f;a.cleanMap=e;return a}()});define("util/toast2",[],function(){var j,h,f;function e(){var a=b;if(a)a.style.opacity=
0,a.style.display="none"}function a(a,c){var c=c||{},g=0;f&&clearTimeout(f);var l=c.parent||document.body,g=b?l!==d?2:0:1;switch(g){case 2:d.removeChild(b),d=b=void 0;case 1:b=document.createElement("div"),b.id="toast_box",b.className="toast_box",b.innerHTML="<div></div>",l.appendChild(b),d=l;case 0:if(!("autoHide"in c))c.autoHide=j;if(!("hasClose"in c))c.hasClose=h;var g=c,l=b,m=b.childNodes[0];l.style.left="0";var o=l.style.opacity="";g.hasClose&&(o='<ul class="close_btn" tabindex="0" aria-label="'+
a+',\u5173\u95ed" role="button"><li class="l"></li><li class="r"></li><li class="tri_masker"></li></ul>');m.className=g.show_fail_style?"fail":"succ";if(g.show_wait_style)m.className="wait";m.innerHTML=a+o;l.style.left="50%";l.style.marginLeft=-parseInt(getComputedStyle(l).width,10)/2-16+"px";l.style.marginTop=-parseInt(getComputedStyle(l).height,10)/2+"px";l.style.display="";g.autoHide&&(f=setTimeout(e,g.autoHide))}return b}var d,b;j=1E3;h=false;f=void 0;return{show:a,yes:function(b){a(b)},no:function(b,
c){c=c||{};c.show_fail_style=1;a(b,c)},wait:function(b,c){c=c||{};c.show_wait_style=1;c.autoHide=5E3;a(b,c)},hide:e}});define("modules/handler/cgi/queryThumb",["../../cleanData","../../cleanTask","../../../util/toast2"],function(){function j(b){a=b}function h(b,e){if(window.g_flag_thumb_enable){if(!b)var c=document.getElementById("file_list").getBoundingClientRect().top,b=document.elementFromPoint(10,c+27+10);if(b&&b.classList.contains("file")){var g=b,c=e,h=document.getElementById("file_list").querySelectorAll(".file"),
j=0;if(!c||c>d)c=d;for(var o=0;o<h.length;o++)if(h[o]==g){j=o;break}g=j-1;g<0&&(g=0);for(var j=a.model.getListDataMap(),k=[],o=g;o<h.length&&o<g+20;o++){var p=h[o],p=p.id.substr(5);if((p=j[p])&&p.type_str=="\u56fe\u7247"&&!p.thumbUrl&&!p.thumbUrlLoading)if(k.push(p),k.length>=c)break}if(k.length>0&&k.length<c)for(;o<h.length;o++)if(p=h[o],p=p.id.substr(5),p=j[p],p.type_str=="\u56fe\u7247"&&!p.thumbUrl&&!p.thumbUrlLoading&&(k.push(p),k.length>=c))break;k.length&&f(k)}}}function f(b){var i=d;if(window.g_flag_thumb_enable){var c=
a.cgi,g=b;b.length>i&&(g=b.splice(0,i));c.getThumb(g,e)}}function e(b,d){if(d&&d.ec===0&&d.address_list){for(var c=0;c<d.address_list.length;c++)b[c].thumbUrl=d.address_list[c].url;a.view.setThumb(b)}}var a,d=10;return function(){var a={};a.do_query_thumb=f;a.do_fetch_thumb=h;return{init:j,tasks:a}}()});define("modules/handler/cgi/getData",["../../cleanData","../../cleanTask","../../../util/toast2"],function(j,h,f){function e(a){g=a}function a(a){if(a&&a.ec==0)window.g_flag_cgiData_have=true;if(a&&
a.ec!=600&&window.g_time_cgi_start)i.report1("flag1=7809&flag2=1&flag3=57","26="+(new Date-window.g_time_cgi_start)),window.g_time_cgi_start=null;var e=g.info,h=g.cgi,j=document.getElementById("app");if(a.ec!==0){if(a.ec===-10002)f.no("\u6e38\u5ba2\u6682\u65e0\u6743\u9650\u67e5\u770b\u7fa4\u5171\u4eab",{autoHide:0}),j.style.display="none";c({type:"info",msg:"CGI filelist\u5931\u8d25 detail: uin["+e.uin+"]gin["+e.groupid+"]ec["+a.ec+"]"});c({type:"error",msg:"CGI filelist \u5931\u8d25 ec["+a.ec+"]",
report:"ERR_CGI_GETSHARELIST"});l.classList.remove("open");window.g_flag_cgiData_have||f.no("\u62c9\u53d6\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e<i class='reload' data-action='page_reload'>\u91cd\u8bd5</i>",{autoHide:0})}else if(a.ec==0&&a.role==0&&a.isPublic!=1)f.no("\u6e38\u5ba2\u65e0\u6743\u9650\u67e5\u770b\u975e\u516c\u5f00\u7fa4\u6587\u4ef6",{autoHide:0}),j.style.display="none";else{if(a.ec==0&&a.flist==void 0)a.flist=[],a.name_list=[],a.capacitytotal=0;i.push("main","cgiReturn");e=d(a);
e==0?b(a,4):e<3?b(a,2):e==3&&(b(a,3),h.getAllList(g.tasks.do_get_cgidata))}}function d(a){var b=g.local.cgiData,c;a&&a.flist&&a.flist.length<=250&&a.flist.sort(function(a,b){return b.ut-a.ut});if(b){for(var d in b)a[d]===void 0&&(a[d]=b[d]);if(a.n_all==a.flist.length)if(b.n_all==a.n_all&&b.flist.length==a.flist.length){if(b.n_all==0||b.n_all>0&&b.flist[0].fp==a.flist[0].fp)c=0}else c=-1;else if(b.n_all==a.n_all&&b.n_all==b.flist.length||b.n_all==0||b.n_all>0&&b.flist[0].ut==a.flist[0].ut){c=0;for(d=
a.flist.length;d<a.n_all;d++){var e=b.flist[d];e&&a.flist.push(e)}var i={};a.name_list?a.name_list.forEach(function(a){i[a.u]=a.n}):a.name_list=[];b.name_list&&b.name_list.forEach(function(b){i[b.u]||a.name_list.push(b)})}else c=3}else c=a.n_all>a.flist.length?3:-2;g.local.cgi.set(a);return c}function b(a,b){var c=document.getElementById("app"),d=g.model,e=g.view,i=g.capacity,s=g.info,t=a.role;if(a.isPublic===0&&t===1)f.no("\u6e38\u5ba2\u65e0\u6743\u9650\u67e5\u770b\u975e\u516c\u5f00\u7fa4\u6587\u4ef6",
{autoHide:0}),c.style.display="none";else{s=j.cleanArray(a,s);s.isVisitor?(c.classList.add("visitor"),g.isVisitor=true):c.classList.remove("visitor");for(var c=s.listData,t=s.boxData,v=s.imgData,z=0;z<t.length;z++)h.cleanItem(t[z]);l.classList.remove("open");d.setListData(c);a.n_all>a.flist.length?e.renderList(c,null,a.n_all):b!=5&&e.renderList(c);s.isVisitor||(b>=2&&(d.setContinueTask(t),e.renderBox(d.getBoxData(),true),m||(m=true,g.tasks.do_query_thumb(v))),a.capacitytotal!==void 0&&i.init(a))}}
var i=window.TRecord,c=window.g_log,g,l=document.getElementById("loader"),m=false;return function(){var c={};c.do_get_cgidata=a;c.do_get_data=b;return{init:e,tasks:c}}()});define("modules/handler/client/onMsg",["../../cleanTask"],function(j){function h(a){f=a}var f,e=top;if(typeof e.onClientEvent!=="function")return window.addEventListener("message",function(a){var d;try{typeof a.data==="string"&&(d=JSON.parse(a.data))}catch(b){console.warn("\u83b7\u53d6message\u4ee5\u540eparse\u51fa\u9519\u62c9!")}if(d&&
typeof d==="object"&&d.from==="Client")switch(a=d.data,typeof a==="string"&&(a=JSON.parse(d.data)||{}),d=a.cmd||"",d){case "OnFiletransporterEvent":a=a.param;typeof a!=="object"?console.error("onFiletransporterEvent param parse error"):(d=a.event,a=a.task,j.cleanItem(a),(d=f.tasks["do_msg_"+{newtask:"newtask",taskcomplete:"taskcomplete",taskpause:"taskpause",taskresume:"taskresume",startprogress:"taskprogress",taskabort:"taskabort"}[d]])&&d(a));break;case "OnGroupShareTabChangedEvent":break;default:console.warn("warn:\u9884\u671f\u5916\u7684message.cmd:"+
d)}}),e.PostMessage=e.onClientEvent=function(a){var d;if(a){if(typeof a==="string")try{d=JSON.parse(a)}catch(b){console.error("[Client|init()]msg is string, but parse to object catch e!")}typeof d!=="object"?console.error("[Client|init()]after parse, got no object!"):window.postMessage(a,"*")}else console.error("[Client] msg is not exist!")},{init:h,tasks:{}}});define("modules/handler/client/newTask",[],function(){function j(a){f=a}function h(a){var d=f.model,b=f.view;a.task_starttime=parseInt((new Date).getTime()/
1E3,10);var i=d.addNewTask(a);b.updateBox([i],d.getBoxData());d=document.getElementById("box_list");if(a.type!=="continueupload")d.scrollTop=0;a.type=="download"&&f.tasks.do_file_downloading(document.getElementById("list_"+a.filepath));g_report(e[a.type]);f.tasks.do_box_refresh()}var f,e={upload:386381,continueupload:386382,download:386383};return function(){var a={};a.do_msg_newtask=h;return{init:j,tasks:a}}()});define("modules/handler/client/taskProgress",[],function(){function j(e){f=e}function h(e){var a=
f.model,d=f.view,b=f.capacity;e.createtime=parseInt((new Date).getTime()/1E3,10);var i=a.updatePlistItem(e);d.updateBox([i],a.getBoxData());e.remotetype===1&&b.holdSpace(e.filesize);e.type=="download"&&f.tasks.do_file_downloading(document.getElementById("list_"+e.filepath))}var f;return function(){var e={};e.do_msg_taskprogress=h;return{init:j,tasks:e}}()});define("modules/task2File",["../util/util","./cleanData"],function(j,h){return function(f,e){var a={},d;for(d in f)a[d]=f[d];if(a){d=a.filepath.substr(1,
3);var b=parseInt((new Date).getTime()/1E3,10);a.filepath=a.filepath;a.fp=a.filepath.substr(4);if(f.localname)a._localpath=a.localname;a.uploaduin=e.uin;a.busid=d;a.ttl=864E3;a.createtime=b;a.updatetime=b;a.downloadtimes=0;a.uploadnick=e.nickName;a.uploadsize=a.filesize;h.cleanItem(a,e,true);return a}else console.error("task is null")}});define("modules/handler/client/taskComplete",["../../task2File"],function(j){function h(b){a=b}function f(b){e(d[b.type]);var i=a.model,c=a.view,g=a.info,f=a.client,
h=a.local,o=i.updatePlistItem(b);c.updateBox([o],i.getBoxData());f.clearClist();f=b.localpath;f.indexOf("OSRoot:\\")!=0&&(f="OSRoot:\\"+f);h.lp.add(b.filepath.substr(4),f);g=j(o,g);g.is_success=true;g.style_issucc="succ";h=i.getListDataMap();if(o=h[g.filepath])o._localpath=f;if(b.type.indexOf("upload")>=0)i=i.addListData(g),o=h[g.filepath],o._localpath=f,c.renderList(i),g.type_str=="\u56fe\u7247"&&a.tasks.do_query_thumb([g]),e("UPLOAD_SUCC");else if(b.type.indexOf("download")>=0){b=document.getElementById("list_"+
g.filepath);if(!b)i=i.addListData(g),o=h[g.filepath],o._localpath=f,c.renderList(i),b=document.getElementById("list_"+g.filepath);b?(b.classList.add("succ"),window.g_i_openfolder&&a.tasks.do_file_downloadsucc(b)):console.error("download \u6210\u529f\u6253\u52fe\u5f02\u5e38"+g.filepath);if(o)o.inDownload=false,o.dt++,o.downloadtimes++,a.view.updateRowDiv(b,o);e("DOWNLOAD_BTN_CLICK#SUCC")}}var e=window.g_report,a,d={upload:386384,continueupload:386385,download:386386};return function(){var a={};a.do_msg_taskcomplete=
f;return{init:h,tasks:a}}()});define("modules/handler/client/taskAbort",[],function(){function j(a){d=a}function h(i){var c=d.model,g=d.view,h=c.updatePlistItem(i);g.updateBox([h],c.getBoxData());c=b[i.type];g=c[i.status];if(!g)g=c._default,e({type:"error",msg:"\u5ba2\u6237\u7aef\u4efb\u52a1\u5931\u8d25_"+i.type+"_"+i.status});a(g);if(i.errorcode||i.securityattri)if(c=i.errorcode,g=f("\u4efb\u52a1\u5931\u8d25",i),e({type:"info",msg:i.type+"\u4efb\u52a1\u5931\u8d25"+g}),c===32221991){i=d.client;c=
f("\u4efb\u52a1\u5931\u8d25",h);h.retry_times?h.retry_times++:h.retry_times=1;h.retry_times>3?e({type:"info",msg:"\u4efb\u52a1\u91cd\u8bd5\u6b21\u6570\u8d85\u8fc73\u6b21"+c,report:"ERR_TASK_RETRY_REACH_MAX"}):(e({type:"info",msg:"\u4efb\u52a1\u91cd\u8bd5"+c,report:"ERR_TASK_RETRY"}),i.addContinueUploadTask(h.filepath,h.localpath,h.filename_esc||h.filename,h.remotetype));a("ERR_FTN_32221991");return}else c===12029&&a("ERR_FTN_12029");d.tasks.do_file_downloadback(document.getElementById("list_"+i.filepath))}
function f(a,b){var g=a,e=d.info;g+="gin["+e.groupId+"]";g+="uin["+e.uin+"]";g+="fn["+b.filename+"]";g+="fp["+b.filepath+"]";g+="st["+b.status+"]";g+="ec["+b.errorcode+"]";g+="sa["+b.securityattri+"]";g+="id["+b.id+"]";return g}var e=window.g_log,a=window.g_report,d,b={upload:{cancel:386303,remove:386305,scanfail:38306,uploadsecurityfail:386307,uploadgeturlfail:386308,uploadfail:386309,_default:386310},continueupload:{cancel:386319,remove:386320,scanfail:386321,uploadsecurityfail:386322,uploadgeturlfail:386323,
uploadfail:386324,_default:386325},download:{cancel:386328,remove:386329,downloadgeturlfail:386330,downloadfail:386331,_default:386332}};return function(){var a={};a.do_msg_taskabort=h;return{init:j,tasks:a}}()});define("modules/handler/client/taskPause",[],function(){function j(e){f=e}function h(e){var a=f.model,d=f.view,e=a.updatePlistItem(e);d.updateBox([e],a.getBoxData())}var f;return function(){var e={};e.do_msg_taskpause=h;return{init:j,tasks:e}}()});define("modules/handler/client/taskResume",
[],function(){function j(e){f=e}function h(e){var a=f.model,d=f.view,e=a.updatePlistItem(e);d.updateBox([e],a.getBoxData())}var f;return function(){var e={};e.do_msg_taskresume=h;return{init:j,tasks:e}}()});define("modules/handler/box/init",["../../cleanTask","../../task2File"],function(j,h){function f(d){a=d}function e(){var d=a.client,b=a.view,e=a.model,c=a.local,g=d.getPlist(),f=d.getClist(),g=j.cleanMap(g.map),f=j.cleanMap(f.map);d.clearClist();(d=c.clistData)||(d=[]);for(var m=0;m<f.length;m++){var o=
f[m];if(!(o.status.indexOf("complete")<0)){var k=h(o,a.info),p=k.localpath;p.indexOf("OSRoot:\\")!=0&&(p="OSRoot:\\"+p);k._localpath=p;k.fp=k.filepath.substr(4);a.local.lp.add(k.fp,p);d.unshift(o)}}c.clist.set(d);g.sort(function(a,b){return b.id-a.id});g&&g.length&&(e.setPlist(g),setTimeout(function(){a.tasks.do_box_open()},500));d&&d.length&&e.setClist(d);(e=e.getBoxData())&&b.renderBox(e,true)}var a;return function(){var a={};a.do_box_init=e;return{init:f,tasks:a}}()});define("modules/handler/box/pause",
[],function(){function j(a){e=a}function h(a){e.client.pauseTask(a.parentNode.parentNode.obj.id);f("PAUSE_BTN_CLICK")}var f=window.g_report,e;return function(){var a={};a.do_task_pause=h;return{init:j,tasks:a}}()});define("modules/handler/box/resume",[],function(){function j(a){e=a}function h(a){var d=e.client,b=e.tasks.do_box_open,a=a.parentNode.parentNode.obj.id;b();d=d.resumeTask(a);console.warn("\u6267\u884cresume\u7684\u8fd4\u56de\u7801=["+d+"]");f("RESUME_BTN_CLICK")}var f=window.g_report,e;
return function(){var a={};a.do_task_resume=h;return{init:j,tasks:a}}()});define("modules/handler/box/continue",[],function(){function j(a){e=a}function h(a){a=a.parentNode.parentNode.obj;e.client.addContinueUploadTask(a.filepath,a.localname,a.filename_esc||a.filename,a.remotetype);f("CONTINUEUPLOAD_BTN_CLICK")}var f=window.g_report,e;return function(){var a={};a.do_task_continue=h;return{init:j,tasks:a}}()});define("modules/handler/box/remove",[],function(){function j(a){e=a}function h(a){var d=
e.client,b=e.model,i=e.view,c=e.cgi,a=a.parentNode.parentNode,g=a.obj,h=g.type,j=g.filepath,o=true;g.id&&(d.removeTask(g.id),o==0?o=true:console.error("\u5220\u9664\u4efb\u52a1\u5931\u8d25"+JSON.stringify(g)));o&&(g.id?b.removePlistItem(g.id):b.removePlistItem(g.filepath),h&&h.indexOf("upload")>=0&&j&&c.deleteFile(j,function(a){if(a.ec==void 0)a.ec=a.code;a.ec!==0&&(console.warn("\u672a\u80fd\u6210\u529f\u5220\u9664\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6!"),g_log({type:"error",msg:"\u5220\u9664\u8fdc\u7a0b\u6587\u4ef6\u5931\u8d25fp["+
j+"]ec["+a.ec+"]",report:"ERR_CGI_DELETE"}))}),i.updateBox([],b.getBoxData()),d.clearClist(),g_remove_ease(a));f("CANCEL_BTN_CLICK")}var f=window.g_report,e;return function(){var a={};a.do_task_remove=h;return{init:j,tasks:a}}()});define("modules/handler/box/boxToggle",["../../cleanTask"],function(j){function h(a){c=a}function f(){document.getElementById("box");m?a():(e(),i("BOX_ENTRY_SHOWCLICK"))}function e(){var a=c.view,e=c.model;if(m)g&&clearTimeout(g),g=setTimeout(b,0);else{var d=document.getElementById("box");
document.getElementById("box_list");d.classList.add("open");a.renderBox(e.getBoxData());g&&clearTimeout(g);g=setTimeout(b,0);m=true}}function a(){m=false;var a=document.getElementById("box");document.getElementById("box_list");a.classList.remove("open");g&&(clearTimeout(g),g=null)}function d(){g||(g=setTimeout(b,l))}function b(){var a=c.view,e=c.model,d=c.client.getPlist(),i=false;if(d.empty&&d.status==="ok")g&&clearTimeout(g),g=null;else if(d.status==="busy")g=setTimeout(b,l);else{for(var f=/progress|ready|scan|geturl/ig,
d=j.cleanMap(d.map),h=0;h<d.length;h++){var m=d[h];m.type=="download"&&(m.state=="canceled"?c.tasks.do_file_downloadback(document.getElementById("list_"+m.filepath)):c.tasks.do_file_downloading(document.getElementById("list_"+m.filepath)));f.test(m.status)&&(i=true)}f=e.updatePlist(d);a.updateBox(f,e.getBoxData());i&&(g=setTimeout(b,l))}}var i=window.g_report,c,g,l=299,m=false;return function(){var c={};c.do_box_toggle=f;c.do_box_open=e;c.do_box_close=a;c.do_box_refresh=b;c.do_start_refresh=d;return{init:h,
tasks:c}}()});define("modules/handler/box/clearHistory",[],function(){function j(e){f=e}function h(){var e=f.local,a=f.client,d=f.model,b=f.view,i=d.clearClist();b.clearBox(i,d.getBoxData());a.clearClist();e.clist.clear()}var f;return function(){var e={};e.do_clear_history=h;return{init:j,tasks:e}}()});define("modules/handler/box/openFolder",[],function(){function j(a){i=a}function h(a){if(window.external&&window.external.isFileExist){var b=window.external.isFileExist(a);if(b=="false"||b===false)return client.alert("\u6b64\u6587\u4ef6\u5939\u4e0d\u5b58\u5728\uff0c\u53ef\u80fd\u88ab\u5220\u9664\u6216\u88ab\u79fb\u52a8\u5230\u5176\u4ed6\u4f4d\u7f6e"),
false}if(window.external&&window.external.openFolder&&window.external.openFolder(a)!="success")return client.alert("\u6b64\u6587\u4ef6\u5939\u4e0d\u5b58\u5728\uff0c\u53ef\u80fd\u88ab\u5220\u9664\u6216\u88ab\u79fb\u52a8\u5230\u5176\u4ed6\u4f4d\u7f6e"),false}function f(a){var g=i.model,a=a.parentNode.parentNode.parentNode,d=a.id.substr(5);if(g=g.getListDataMap()[d])(d=g._localpath)?(d.indexOf("OSRoot:\\")!=0&&(d="OSRoot:\\"+d),h(d,g)==false&&e(a,g)):e(a,g);b("open_folder_from_list")}function e(a,b){var d=
i.local;b._localpath=null;d.lp.remove(b.fp);a&&i.tasks.do_file_downloadback(a)}function a(a){var g=a.parentNode.parentNode,d=g.obj,f=d._localpath||d.localpath||d.localname;f&&f.indexOf("OSRoot:\\")!=0&&(f="OSRoot:\\"+f);if(h(f,d)==false){var j=g.querySelector(".filename"),g=g.querySelector(".go_folder");a.classList.add("disable");j.classList.add("disable");g.classList.add("disable");d.localpath_changed=true;i.local.clist.set(i.local.clistData);if((a=i.model.getListDataMap()[d.filepath])&&a._localpath==
f)(g=document.getElementById("list_"+a.filepath))&&e(g,a)}d&&d.type&&d.type.indexOf("upload")>=0?b("open_folder_upload"):d&&d.type&&d.type.indexOf("download")>=0&&b("open_folder_download")}function d(b){a(b)}var b=window.g_report,i;return function(){var b={};b.do_task_openFolder=a;b.do_task_openFolder2=d;b.do_open_folder3=f;return{init:j,tasks:b}}()});define("modules/handler/file/upload",[],function(){function j(a){e=a}function h(){e.client.addUploadTask();f("UPLOAD_BTN_CLICK")}var f=window.g_report,
e;return function(){var a={};a.do_file_upload=h;return{init:j,tasks:a}}()});define("modules/handler/file/delete",["../../../util/toast2"],function(j){function h(a){c=a}function f(a){for(var b=c.cgi,d=0;d<a.length;d++)b.deleteFile(a[d].filepath)}function e(){var g=c.model,e=c.cgi,f=c.client,i=c.lastActiveRow,h=c.tasks.do_hide_menu;h();if(i&&(g=g.getListDataMap()[i.id.substr(5)])){var h=g.filepath,j=g.remotetype,n=g.filesize;f.confirm("\u4f60\u786e\u5b9a\u8981\u5220\u9664\u6587\u4ef6 "+g.filename_esc+
" \u5417?")&&e.deleteFile(h,b(a,g.filepath,j,n,i))}d("DELETE_BTN_CLICK")}function a(a,b,e,f,h){var p=c.model,f=c.view,n=c.client,q=c.capacity;console.warn("do delete result:",a);if(h&&h.ec===void 0)h.ec=h.code;h.ec===0?(j.show("\u5220\u9664\u6210\u529f"),h=p.removeListData(a),f.removeListRow(a,h),b===1&&q.releaseSpace(e),c.local.cgi.remove(a.substr(4)),d("DELETE_BTN_CLICK#SUCC")):(n.alert("\u5220\u9664\u5931\u8d25"),i({type:"error",msg:"\u5220\u9664\u5931\u8d25fp["+a+"]ec["+h.ec+"]",report:"ERR_CGI_DELETE"}))}
var d=window.g_report,b=window.g_hitch,i=window.g_log,c;return function(){var a={};a.do_file_delete=e;a.do_deleteAll=f;return{init:h,tasks:a}}()});define("modules/handler/file/preview",["../../../util/toast2"],function(j){function h(a){i=a}function f(b){a(b);i.tasks.do_file_active(b);g_report("preview_click_filename")}function e(b){b=b.parentNode.parentNode;a(b);i.tasks.do_file_active(b);g_report("preview_click_img")}function a(a){var g=i.tasks.do_hide_menu,d=i.model,e=i.cgi;g();if(a&&(a=d.getListDataMap()[a.id.substr(5)]))a.filesize>
20971520?client.alert("\u56fe\u7247\u592a\u5927\u4e0d\u652f\u6301\u9884\u89c8\uff0c\u8bf7\u76f4\u63a5\u4e0b\u8f7d"):(a.usedtimes=a.usedtimes>=0?a.usedtimes+1:1,j.wait("\u6b63\u5728\u52a0\u8f7d\u9884\u89c8\u56fe\u2026"),window.onblur=function(){window.onblur=null;j.hide()},e.getThumb([a],b))}function d(){a(i.lastActiveRow);g_report("preview_click_menu")}function b(a,b){b.ec===0&&i.client.preview(b.address_list[0].url)}var i;return function(){var a={};a.do_file_preview=d;a.do_img_preview=e;a.do_preview_filename=
f;return{init:h,tasks:a}}()});define("modules/handler/file/rename",["../../../util/util","../../../util/toast2"],function(j,h){function f(b){k=b;n.onkeydown=a;n.onpaste=e}function e(a){var b="";a.clipboardData&&(b=a.clipboardData.getData("Text"));/[\\\/\*\:\"<>\|\?]/.test(b)?(q.innerHTML=r,setTimeout(function(){q.innerHTML=""},3E3),a.preventDefault()):q.innerHTML=""}function a(a){var c=a.keyCode,g=[56,186,222,188,190];[220,191].indexOf(c)>=0||a.shiftKey&&g.indexOf(c)>=0?(q.innerHTML=r,setTimeout(function(){q.innerHTML=
""},3E3),a.preventDefault()):c==13?b():c==65&&a.ctrlKey==true?o(n,0,n.value.length):q.innerHTML=""}function d(a){k.state_inRename=true;m(a);g_report("menu_file_rename")}function b(){var a=n.value;if(a.length==0||a.replace(/\s/g,"").length==0)q.innerHTML="\u5fc5\u987b\u952e\u5165\u6587\u4ef6\u540d",setTimeout(function(){q.innerHTML=""},3E3);else{var b=k.cgi,c=k.lastActiveRow,g=k.model.getListDataMap();g&&c&&c.id&&(c=g[c.id.substr(5)])&&b.renameFile(c,a+c.filename_suf,g_hitch(i,c,a));g_report("btn_rename_ok")}}
function i(a,b,g){if(g.ec===0){a.fn=j.xssHtml(b+a.filename_suf);a.filename=a.fn;a.filename_esc=b+a.filename_suf;a.filename_name=j.xssHtml(b);g=document.getElementById("list_"+a.filepath);c();h.yes("\u91cd\u547d\u540d\u6210\u529f");if(g){var g=g.childNodes[1].childNodes[0],d=a.filename_esc;a.type_str=="\u56fe\u7247"&&(d="\u9884\u89c8\u56fe\u7247 : "+d);g.setAttribute("title",d);g.childNodes[0].innerHTML=j.xssHtml(b)}k.local.cgi.update(a)}else(a=s[g.ec])?q.innerHTML=a:(c(),h.no(t))}function c(){var a=
k.lastOpenMenu;a&&a.classList.remove("open");k.lastOpenMenu=null}function g(){c()}function l(){c()}function m(){var a=k.model,b=k.lastActiveRow;q.innerHTML="";if(b)k.tasks.do_file_active(b),a=a.getListDataMap()[b.id.substr(5)].filename_esc,b=a.lastIndexOf("."),b>=0&&(a=a.substr(0,b)),p.classList.add("open"),n.value=a,setTimeout(function(){o(n,0,n.value.length);n.select();k.lastOpenMenu&&k.lastOpenMenu!=p&&k.lastOpenMenu.classList.remove("open");k.lastOpenMenu=p},10)}function o(a,b,c){if(a.createTextRange){var g=
a.createTextRange();g.collapse(true);g.moveStart("character",b);g.moveEnd("character",c);g.select()}else if(a.setSelectionRange)a.setSelectionRange(b,c);else if(a.selectionStart)a.selectionStart=b,a.selectionEnd=c;a.focus()}var k,p=document.getElementById("rename_panel"),n=document.getElementById("new_name"),q=document.getElementById("rename_err_text"),r='\u6587\u4ef6\u540d\u4e2d\u4e0d\u5141\u8bb8\u5305\u62ec \\ / : * ? " &lt; &gt; |',s={2:"\u7cfb\u7edf\u5185\u90e8\u9519\u8bef",3:"\u8f93\u5165\u53c2\u6570\u9519\u8bef",
11:"\u6587\u4ef6\u540d\u5305\u542b\u975e\u6cd5\u5b57\u7b26( / : * \uff1f\u201c < > |)",12:"\u6587\u4ef6\u540d\u957f\u5ea6\u9650\u5236(\u4e2d\u6587\u6216\u8005\u82f1\u6587\u957f\u5ea6\u90fd\u9650\u5236\u4e3a127)",13:"\u6587\u4ef6\u540d\u5305\u542b\u654f\u611f\u8bcd\u6c47",14:"\u767b\u5f55\u6001\u6821\u9a8c\u5931\u8d25",15:"\u6210\u5458\u5173\u7cfb\u6821\u9a8c\u5931\u8d25",16:"\u83b7\u53d6\u6587\u4ef6\u4fe1\u606f\u5931\u8d25",17:"ftn\u8fd4\u56de\u6587\u4ef6\u4e0d\u5b58\u5728",18:"\u5373\u901a\u5b89\u5168\u4e2d\u5fc3\u68c0\u6d4b\u5931\u8d25"},
s={12:"\u6587\u4ef6\u540d\u8fc7\u957f,\u8bf7\u91cd\u65b0\u4fee\u6539\u6587\u4ef6\u540d",13:"\u6587\u4ef6\u540d\u79f0\u4e2d\u5305\u542b\u654f\u611f\u8bcd\uff0c\u8bf7\u91cd\u65b0\u4fee\u6539\u6587\u4ef6\u540d",17:"\u6587\u4ef6\u5df2\u88ab\u5220\u9664,\u8bf7\u5237\u65b0\u9875\u9762"},t="\u7f51\u7edc\u5f02\u5e38\uff0c\u91cd\u547d\u540d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5",t="\u91cd\u547d\u540d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5";return function(){var a={};a.do_file_rename=d;a.do_rename_ok=
b;a.do_rename_cancel=l;a.do_rename_close=g;return{init:f,tasks:a}}()});define("modules/handler/file/download",[],function(){function j(a){c=a}function h(){var a=c.lastActiveRow,b=c.client,d=c.model.getListDataMap()[a.id.substr(5)];d?d.inDownload?setTimeout(function(){c.tasks.do_box_open()},10):b.addDownloadTask(d.filepath,d.filename_esc,d.filesize):console.error("model\u7684datamap\u91cc\u6ca1\u6709\u8be5\u6570\u636e"+a.id);c.tasks.do_hide_menu(true);i("SAVEAS_BTN_CLICK")}function f(a,b){var d=document.createElement("div");
d.innerHTML='<div class="img"></div>';var e=c.model.getListDataMap()[a.id.substr(5)];if(e)d.className="file_animate "+e.file_icon,e=b.getBoundingClientRect(),d.style.right=window.innerWidth-e.left+"px",d.style.top=e.top-20+"px",document.body.appendChild(d),setTimeout(function(){document.body.removeChild(d)},1500)}function e(a){if(a){var b=a.querySelector(".btn_left");if(b&&!b.classList.contains("downloading"))new Date-a.clickTime<1E3&&f(a,b),b.classList.remove("download"),b.classList.remove("chakan"),
b.classList.add("disable"),b.classList.add("downloading"),b.nextSibling.classList.add("disable"),b.innerHTML="&nbsp;\u4e0b\u8f7d\u4e2d",b.setAttribute("title","\u4e0b\u8f7d\u4e2d")}}function a(a){if(a){a.classList.add("succ");var b=a.querySelector(".btn_left");b&&setTimeout(function(){b.classList.remove("download");b.classList.remove("downloading");b.classList.remove("disable");b.nextSibling.classList.remove("disable");b.classList.add("chakan");b.innerHTML="\u67e5\u770b";b.setAttribute("title","\u67e5\u770b");
b.setAttribute("data-action","open_folder3")},800)}}function d(a){if(a&&(a.classList.remove("succ"),a=a.querySelector(".btn_left")))a.classList.remove("chakan"),a.classList.remove("downloading"),a.classList.remove("disable"),a.nextSibling.classList.remove("disable"),a.classList.add("download"),a.innerHTML="\u4e0b\u8f7d",a.setAttribute("title","\u4e0b\u8f7d"),a.setAttribute("data-action","file_download")}function b(a){var b=a.parentNode.parentNode.parentNode;c.tasks.do_file_active(b);var d=c.client,
e=c.model,b=a.parentNode.parentNode.parentNode;b.clickTime=new Date;(a=e.getListDataMap()[b.id.substr(5)])?a.inDownload?setTimeout(function(){c.tasks.do_box_open()},10):d.addDownloadTask(a.filepath,a.filename_esc,a.filesize,true):console.error("model\u7684datamap\u91cc\u6ca1\u6709\u8be5\u6570\u636e"+b.id);i("DOWNLOAD_BTN_CLICK")}var i=window.g_report,c;return function(){var c={};c.do_file_download=b;c.do_file_save=h;c.do_file_downloading=e;c.do_file_downloadsucc=a;c.do_file_downloadback=d;return{init:j,
tasks:c}}()});define("modules/handler/file/permanent",["../../../util/toast2"],function(j){function h(a){i=a}function f(){var b=i.lastActiveRow,c=i.cgi,f=i.model,h=i.tasks.do_hide_menu;h();if(b)f=f.getListDataMap()[b.id.substr(5)],h=f.filepath,c.permanent(h,d(e,h,f.filesize,b));a("TMP2PERMANENT_CLICK")}function e(a,d,e,f){var h=i.model,p=i.client,n=i.capacity,q=f.ec;q===0?(j.show("\u8f6c\u5b58\u6210\u529f"),e.classList.remove("temp"),p="/102"+f.fp,h.updateListData({filepath:a,fp:p},"permanent"),n.holdSpace(d),
e.id="list_"+p):((d=c[q])||(d="\u672a\u77e5\u9519\u8bef"),q===25?p.confirm("\u7a7a\u95f4\u5df2\u6ee1\uff0c\u65e0\u6cd5\u8f6c\u5b58\u4e3a\u6c38\u4e45\u6587\u4ef6\n\u662f\u5426\u8981\u6269\u5927\u5bb9\u91cf?")&&window.open("http://qgroup.qq.com/share/upgrade.html"):(p.alert("\u8f6c\u5b58\u5931\u8d25 "+d||""),b({type:"error",msg:"\u8f6c\u5b58\u5931\u8d25fp["+a+"]ec["+q+"]",report:"ERR_CGI_PERMANENT"})))}var a=window.g_report,d=window.g_hitch,b=window.g_log,i,c={1:"\u6ca1\u6709\u767b\u9646\u6216\u767b\u9646\u6001\u5931\u6548",
2:"\u7cfb\u7edf\u5185\u90e8\u9519\u8bef",7:"\u6ca1\u6709\u7fa4\u6743\u9650",21:"\u4e0d\u662f\u4e0a\u4f20\u8005\u6216\u7fa4\u4e3b\u4e0d\u80fd\u8f6c\u6c38\u4e45",22:"\u4e0d\u80fd\u8de8\u7fa4\u8f6c\u6c38\u4e45\u6587\u4ef6",23:"\u767b\u5f55\u6001\u6821\u9a8c\u5931\u8d25",24:"\u7fa4\u6210\u5458\u5173\u7cfb\u6821\u9a8c\u5931\u8d25",25:"\u5bb9\u91cf\u6ee1\uff0c\u53ef\u4ee5\u5347\u7ea7",26:"\u5bb9\u91cf\u6ee1\uff0c\u4e0d\u80fd\u518d\u5347\u7ea7",27:"\u8981\u8f6c\u5b58\u7684\u6587\u4ef6\u4e0d\u5b58\u5728",
28:"\u6c38\u4e45\u7a7a\u95f4\u5bb9\u91cf\u8d85\u9650"};return function(){var a={};a.do_file_permanent=f;return{init:h,tasks:a}}()});define("modules/handler/file/more",[],function(){function j(a){e=a}function h(a){var d=e.tasks.do_link_menu,b=document.getElementById("file_menu"),i=document.getElementById("file_list"),c=e.model,g;g=a.parentNode.parentNode.parentNode;var h=e.lastActiveRow!=g;h&&e.tasks.do_file_active(g);if(c=c.getListDataMap()[g.id.substr(5)]){if(h?d(a,true):d(a),b&&b.classList.contains("open")){a=
a.getBoundingClientRect();i=i.getBoundingClientRect().right-a.right;d=b.offsetHeight;a=a.bottom+1-14;a+d>window.innerHeight&&(a=a-d-25);b.style.right=i+"px";b.style.top=a+"px";c=[c.can_preview,true,true,c.can_rename,c.can_forever,true,c.can_delete];b=b.children;for(i=0;i<c.length;i++)c[i]?b[i].classList.remove("disable"):b[i].classList.add("disable");f("ITEM_MORE_BTN_SHOWCLICK")}}else console.error("\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7684\u6570\u636e"+g.id)}var f=window.g_report,e;return function(){var a=
{};a.do_file_more=h;return{init:j,tasks:a}}()});define("modules/handler/file/goUploader",[],function(){function j(a){e=a}function h(a){e.tasks.do_file_active(a.parentNode.parentNode.parentNode.parentNode);if(!e.isVisitor){var d=e.view;document.getElementById("file_list");var b=document.getElementById("sort_text"),i=document.querySelector("#sort>div[by='uploader']");if(!i||!i.classList.contains("selected")){var c=a.parentNode.querySelector(".selected"),a=a.getAttribute("upload_uin");d.renderList(null,
{sortBy:"uploader",uploader:a,target:a});a=document.querySelector("#sort>div[by='uploader']");(c=a.parentNode.querySelector(".selected"))&&c.classList.remove("selected");i.classList.add("selected");b.innerHTML=a.innerHTML;f("UPLOADER_LINK_CLICK")}}}var f=window.g_report,e;return function(){var a={};a.do_go_uploader=h;return{init:j,tasks:a}}()});define("modules/handler/file/sort",[],function(){function j(a){e=a}function h(a){var d=e.view,b=e.tasks;if(a&&a.classList.contains("selected"))b.do_hide_menu();
else{var i=document.getElementById("sort_text"),c=a.getAttribute("by"),g=a.parentNode.querySelector(".selected");g&&g!==a&&g.classList.remove("selected");a.classList.add("selected");i.innerHTML=a.innerHTML;d.renderList(null,{sortBy:c});b.do_hide_menu();f({time:"SORT_TIME_CLICK",type:"SORT_TYPE_CLICK",uploader:"SORT_AUTHOR_CLICK",download:"SORT_DOWNLOADTIME_CLICK",size:"SORT_FILESIZE_CLICK"}[c])}}var f=window.g_report,e;return function(){var a={};a.do_sort=h;return{init:j,tasks:a}}()});define("modules/handler/file/groupToggle",
[],function(){function j(d){a=d}function h(d){var b=a.tasks,d=d.getAttribute("tid");if(d=document.getElementById(d)){var e=d.getAttribute("data-action"),b=b["do_"+e];typeof b==="function"&&b(d);b=d.parentNode;e=b.getBoundingClientRect();d=d.getBoundingClientRect();d=b.scrollTop+d.top-e.top;d<0&&(d=0);b.scrollTop=d}}function f(a){var b=document.getElementById("file_list"),f=a.getBoundingClientRect().top,c=b.getBoundingClientRect().top;f<c&&a.scrollIntoView(true);var g=document.getElementById("group_top"),
f=document.getElementById("t"+a.id),c=a.nextSibling;c.className.indexOf("collapse")>=0?(c.classList.remove("collapse"),a.classList.remove("collapse"),f.classList.remove("collapse")):(c.classList.add("collapse"),a.classList.add("collapse"),f.classList.add("collapse"));setTimeout(function(){b.scrollHeight<=b.clientHeight?g.classList.add("notfull"):g.classList.remove("notfull")},300);e("LIST_GROUPHEAD_CLICK")}var e=window.g_report,a;return function(){var a={};a.do_group_toggle=f;a.do_link_to=h;return{init:j,
tasks:a}}()});define("modules/handler/file/listScroll",[],function(){function j(b){d=b;b=document.getElementById("file_list");b.onmousewheel=g_hitch(f,b,{scrollTop:0,step:10,direct:1,interval:26});b.onscroll=a;b.onmousemove=h}function h(a){a=a.target;if(!i){for(var e=0;e<5;e++)if(a.id)break;else a=a.parentNode;if(a&&a.classList.contains("file")){var e=d.model.getListDataMap(),a=a.id.substr(5),f=e[a];f&&f.type_str=="\u56fe\u7247"&&!f.thumbUrl&&!f.query_thumb_retry&&(b&&clearTimeout(b),b=setTimeout(function(){f.query_thumb_retry=
true;d.tasks.do_query_thumb([f])},c))}}}function f(a,b,c){var d=c.wheelDelta;b.direct=d<0?1:-1;var d=a.scrollTop+parseInt(d*-100/120,10),f=a.scrollHeight-a.clientHeight;d>f&&(d=f);d<0&&(d=0);b.scrollTop=d;g_hitch(e,a,b)();c.preventDefault()}function e(a,b){var c=a.scrollTop,d=b.scrollTop,f=b.step,i=b.direct;c!=d?(d-=c,d>f&&(d=f*i),d<-1*f&&(d=f*i),a.scrollTop=c+d,b.timer=window.requestAnimationFrame?window.requestAnimationFrame(g_hitch(e,a,b)):setTimeout(g_hitch(e,a,b),b.interval)):b.handle&&(window.cancelAnimationFrame?
window.cancelAnimationFrame(b.timer):clearTimeout(b.timer))}function a(){var a=document.getElementById("file_list"),b=document.getElementById("group_top"),e=document.getElementById("box"),f=d.tasks.do_hide_menu;d.lastOpenMenu!==e&&f(true);for(var f=53,f=a.getBoundingClientRect().top,h=a.querySelectorAll(".group_title"),a=b.childNodes,e=h.length-1;e>=0;e--)if(h[e].getBoundingClientRect().top-f<=0){var j=h[e+1],h=0;j&&(f=j.getBoundingClientRect().top-f,f<26&&(h=f-26));if(a[e])a[e].style.top=h+"px";
(b=b.querySelector(".shown"))&&b!==a[e]&&b.classList.remove("shown");a[e].classList.add("shown");break}i&&clearTimeout(i);i=setTimeout(function(){i=null;d.tasks.do_fetch_thumb()},c)}var d,b,i,c=50;return function(){var b={};b.do_list_scroll=a;return{init:j,tasks:b}}()});define("modules/handler/file/active",[],function(){function j(e){f=e}function h(e){f.tasks.do_hide_menu();f.lastActiveRow!=e&&f.lastActiveRow&&f.lastActiveRow.classList.remove("active");f.lastActiveRow=e;f.lastActiveRow.classList.add("active")}
var f;return function(){var e={};e.do_file_active=h;return{init:j,tasks:e}}()});define("modules/handler/body",["../../util/toast2"],function(j){function h(b){d=b;document.body.addEventListener("click",a);document.body.onselectstart=e}function f(){var a=d.cgi;j.hide();a.getList(d.tasks.do_get_cgidata)}function e(){return false}function a(a){var e=d.lastOpenMenu,c=d.lastOpenMenu2,f=d.tasks,h=d.client,j=d.info,o=f.do_box_close,k=document.getElementById("box"),p=a.target;if(p.id!="mask"){var n=p.getAttribute("data-action");
if(!n)p=p.parentNode,n=p.getAttribute("data-action");if(!n){if((p=p.parentNode)&&p.classList&&!p.classList.contains("file"))p=p.parentNode;p&&p.classList&&p.classList.contains("file")&&(n=p.getAttribute("data-action"))}if(n){if(!h.IsOnline()){h.alert("\u7f51\u7edc\u73af\u5883\u5f02\u5e38,\u8bf7\u7a0d\u540e\u518d\u8bd5");return}if(d.isVisitor&&!(n=="link_to"||n=="group_toggle"))return}if(n)if(p&&p.classList&&p.classList.contains("disable"))return;else f=f["do_"+n],typeof f==="function"&&f(p);if(n||
!d.state_inRename)if(n&&(n.indexOf("rename")>=0||n=="file_active"||n=="download"||n=="file_download"||n=="go_uploader"||n.indexOf("preview")>=0))o();else{n!=="box_toggle"&&n!=="file_upload"&&!k.contains(p)&&o();if(n!=="file_more")d.lastActiveRow&&d.lastActiveRow.classList.remove("active"),d.lastActiveRow=null;if(n!=="menu"&&n!=="link_menu"&&n!=="file_more"&&e&&!e.contains(p))e.classList.remove("open"),d.lastOpenMenu=null,c&&c.classList.remove("open"),d.lastOpenMenu2=null;e=p.name;n==="task_remove"&&
(a.preventDefault(),a.stopPropagation());e==="enlarge"&&g_report("UPGRADE_LINK_CLICK");e==="feedback"&&g_report("FEEDBACK_CLICK");if(e==="refresh")a=new Date,a.setTime(a.getTime()+6E4),document.cookie="refresh_"+j.uin+"_"+j.groupid+"=1; expires="+a.toGMTString()+"; path=/;"}}}var d;document.getElementById("rename_panel");return function(){var b={};b.do_body_click=a;b.do_page_reload=f;return{init:h,tasks:b}}()});define("modules/handler/menu",[],function(){function j(d){a=d}function h(d){var b=a.lastActiveRow,
e=a.lastOpenMenu,c=a.lastOpenMenu2;e&&e.classList.remove("open");c&&c.classList.remove("open");d!=true&&b&&b.classList.remove("active")}function f(d,b){var f=a.lastOpenMenu,c=a.lastOpenMenu2;document.getElementById("box");var g=d.getAttribute("menu"),h=document.getElementById(g);b!=true&&h.classList.contains("open")?(h.classList.remove("open"),d.classList.remove("open"),a.lastOpenMenu=null,a.lastOpenMenu2=null):(f!==h&&f&&f.classList.remove("open"),c!==d&&c&&c.classList.remove("open"),h.classList.add("open"),
d.classList.add("open"),a.lastOpenMenu=h,a.lastOpenMenu2=d,g==="sort"?e("SORT_ENTRY_SHOWCLICK"):g==="more"&&e("MORE_BTN_SHOWCLICK"))}var e=window.g_report,a;return function(){var a={};a.do_link_menu=f;a.do_hide_menu=h;return{init:j,tasks:a}}()});define("modules/app.handler","./handler/cgi/queryThumb,./handler/cgi/getData,./handler/client/onMsg,./handler/client/newTask,./handler/client/taskProgress,./handler/client/taskComplete,./handler/client/taskAbort,./handler/client/taskPause,./handler/client/taskResume,./handler/box/init,./handler/box/pause,./handler/box/resume,./handler/box/continue,./handler/box/remove,./handler/box/boxToggle,./handler/box/clearHistory,./handler/box/openFolder,./handler/file/upload,./handler/file/delete,./handler/file/preview,./handler/file/rename,./handler/file/download,./handler/file/permanent,./handler/file/more,./handler/file/goUploader,./handler/file/sort,./handler/file/groupToggle,./handler/file/listScroll,./handler/file/active,./handler/body,./handler/menu".split(","),
function(){var j=arguments,h={};h.dom_file_list=document.getElementById("file_list");h.tasks={};(function(f,e){for(var a=0;a<e.length;a++){var d=e[a],b;for(b in d.tasks)f[b]=d.tasks[b]}})(h.tasks,j);return{init:function(f,e,a,d,b,i,c){h.model=f;h.view=e;h.cgi=a;h.client=d;h.info=b;h.local=i;h.capacity=c;for(f=0;f<j.length;f++)j[f].init(h);window.g_time_cgi_start=new Date;f=h.tasks.do_get_cgidata;window.g_flag_cgi_enable&&a.getList(f);if(b.isVisitor)document.getElementById("app").classList.add("visitor");
else if(h.tasks.do_box_init(),window.g_flag_local_enable&&i.cgiData)(a=i.cgiData)&&a.ec===0&&h.tasks.do_get_data(a)},tasks:h.tasks}});define("modules/app","./app.model,./app.view,./cgi,./client,./getInfo,./local,./capacity,./app.handler,../util/toast2".split(","),function(j,h,f,e,a,d,b,i,c){var g=window.g_report;return{run:function(){var l=a(),m=document.getElementById("app");if(l.uin){f.init(l);d.init(l);j.init(l,d,e);i.init(j,h,f,e,l,d,b);g("TAB_FIRST_ENTER");g(386387);m=386389;if(swf=navigator.plugins["Shockwave Flash"]){var m=
386390,o=swf.description.match(/\d+/);o&&(m+=parseInt(o[0],10))}g(m);window.g_local?g("PROJ_VERSION_LOCAL"):g("PROJ_VERSION");l.fromRefresh&&g("REFRESH_BTN_CLICK")}else m.style.display="none",c.no("\u672a\u767b\u5f55\u7528\u6237\u4e0d\u5141\u8bb8\u8bbf\u95ee",{autoHide:0})}}});require.config({paths:{bower_components:"../bower_components"}});require(["./modules/app"],function(j){window.TRecord.push("main","mainStart");j.run()});define("index",function(){})})();
