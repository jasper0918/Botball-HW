(function(b,g){typeof define==="function"&&define.amd?define([],g):b.report=g(b.report)})(this,function(b){function g(){if(l)return l;else{var a=[],c=0;return l=function(){var d=c++%10;return a[d]||(a[d]=new Image)}}}b=b||{};typeof JSON!=="object"&&(JSON={});if(typeof JSON.stringify!=="function")JSON.stringify=function(){};var l=null,m=function(a,c,d,n,e){if(a&&c&&d){var b="http://cgi.connect.qq.com/report/tdw/report?",a={table:a,fields:encodeURIComponent(JSON.stringify(c)),datas:encodeURIComponent(JSON.stringify(d)),
pr_ip:n||"obj3",pr_t:e||"ts",t:+new Date};if(b){c=[];if(a)for(var f in a)a[f]&&c.push(f+"="+a[f]);b+=c.join("&");g()().src=b}}},o=Object.prototype.toString,j={},i=[],h=[];reportTable="";b.toreport=function(){var a=h.length;if(a>1)for(var c=0;c<a;c++)for(var d=0,b=i.length;d<b;d++)!h[c][d]&&h[c][d]!==0&&(h[c][d]="");m(reportTable,i,h);j.length=i.length=h.length=0;reportTable=""};b.tdw=function(a,c,d){if(!a)throw"params can not be null";reportTable=d||reportTable||"dc00141";var b;switch(o.call(a)){case "[object Array]":b=
a;break;case "[object Object]":if(c)b=[a];else{c=[];b=[];for(var e in a)e==="obj3"||e==="ts"||(c.push(e),b.push(a[e]));return m(reportTable,c,[b],a.obj3,a.ts)}}e=0;for(a=b.length;e<a;e++){var d=b[e],g=[];h.push(g);for(var f in d){var k;f in j?(k=j[f],i[k]=f):(i.push(f),j[f]=k=i.length-1);g[k]=d[f]||""}}c||this.toreport()};return b});
